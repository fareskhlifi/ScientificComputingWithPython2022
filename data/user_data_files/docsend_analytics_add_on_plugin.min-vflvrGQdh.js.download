define(["require","exports","tslib","react","metaserver/static/js/filepath/filepath","metaserver/static/js/file_store/utils","dig-components/icons/src","dig-components/icons","dig-components/tooltips","metaserver/static/js/core/i18n","metaserver/static/js/clean/analytics","metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/action_plugin_menu_item","metaserver/static/js/file_viewer/sdk_file_viewer/utils","dig-components/badges","metaserver/static/js/docsend_analytics_add_on/helpers/utils","metaserver/static/js/docsend_analytics_add_on/helpers/modals"],(function(e,t,s,i,o,n,a,l,r,c,d,f,u,_,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeAnalyticsAddOn=t.getOverflowItem=void 0,i=s.__importDefault(i);t.getOverflowItem=(e,t,s)=>{const o=(0,m.getDocsendAnalyticsAddOnConfig)(t,s);if(o.isSupportedFile(e.bytes,(0,n.getExtension)(e))&&(0,n.isBrowseFile)(e)&&(o.workflowMenu.logExposure||o.workflowMenu.showMenuItem))return i.default.createElement(w,{file:e,user:t,addOnConfig:o})};const w=({addOnConfig:e,file:t,user:s})=>{const u=(0,n.getFilename)(t),m=(0,o.file_extension)(u),{variantForLogging:w,workflowMenu:{logExposure:p}}=e;i.default.useEffect(()=>{p&&d.ProEventsLogger.log(`docsend_analytics_add_on_workflow_${w}`,{entryPoint:"workflow_menu",fileExt:m})},[w,p]);const v=i.default.useCallback(()=>{d.ProEventsLogger.log(`docsend_analytics_add_on_workflow_${w}_click`,{entryPoint:"workflow_menu",fileExt:m});const e=(0,o.parent_dir)(t.fq_path);(0,g.showDocsendModal)({fileId:t.file_id,fileName:u,filePath:e,user:s,stormcrowVariant:w,entryPoint:"workflow_menu"})},[t,s,w]);return e.workflowMenu.showMenuItem?i.default.createElement(r.Tooltip,{title:c.intl.formatMessage({id:"iZTVjV",defaultMessage:"Get viewer insights for the files you share using Dropbox"}),placement:"left"},i.default.createElement(f.ActionPluginMenuItem,{key:"analytics-add-on-action",withLeftAccessory:i.default.createElement(l.UIIcon,{src:a.AnalyticsLine}),withTitle:c.intl.formatMessage({id:"VsZZOc",defaultMessage:"View analytics"}),withRightAccessory:i.default.createElement(_.AccessoryBadge,null,c.intl.formatMessage({id:"QT7EnD",defaultMessage:"Beta"})),onAction:v,"data-testid":"analytics-button"})):null};t.makeAnalyticsAddOn=(e,s,i)=>({actionDefinitions:()=>{const o=e();return{categories:{workflows:[{overflowItem:(0,t.getOverflowItem)(o.file,s,i),id:u.DOCSEND_ANALYTICS_ADD_ON_ACTION_PLUGIN_ID}]}}}})}));
//# sourceMappingURL=docsend_analytics_add_on_plugin.min.js-vflONHXXs.map