define("typescript/component_libraries/files_components/src/files-table/files-table",["require","exports","tslib","react","dig-components/controls","dig-components/table","typescript/component_libraries/files_components/src/common/file","typescript/component_libraries/files_components/src/icons/file_icon","dig-components/combinations","@tanstack/react-table","dig-components/typography","dig-components/hooks","typescript/component_libraries/files_components/src/files-table/files-table-star","typescript/component_libraries/files_components/src/files-table/index.module.css","typescript/component_libraries/dig-experimental/src/focus_group/index","dig-components/buttons","typescript/component_libraries/files_components/src/files-table/files-table-row-actions","classnames"],(function(e,t,i,n,o,r,s,a,l,c,d,u,m,g,h,p,_,f){"use strict";function v(e,t){return`files-table-label-${e}-${t}`}Object.defineProperty(t,"__esModule",{value:!0}),t.FilesTable=t.FileNameCell=t.getLabelIDFromRowIndex=void 0,n=i.__importStar(n),g=i.__importDefault(g),f=i.__importDefault(f),t.getLabelIDFromRowIndex=v;const S=e=>t=>{if(t.preventDefault(),t.stopPropagation(),(0,s.isOpenable)(e)&&e.url){const i=1===t.button;e.performOpenAction(t.metaKey||t.ctrlKey||t.shiftKey,{href:e.url,middleClick:i})}};t.FileNameCell=({file:e,labelID:t,subTitle:i=""})=>{var o,r;const c=(0,s.isOpenable)(e)&&e.url?n.createElement("div",{className:"files-table-click-handler","data-testid":"file-link-div",onClick:S(e),onAuxClick:S(e),role:"link",onKeyPress:t=>{"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),e.performOpenAction(t.metaKey||t.ctrlKey||t.shiftKey))}},n.createElement(d.Link,{id:t,"data-testid":"filename-link",href:e.url,hasNoUnderline:!0,variant:"monochromatic"},e.title),n.createElement("div",null,null===(o=e.renderSubTitle)||void 0===o?void 0:o.call(e))):n.createElement("span",{id:t,"data-testid":"files-filename"},e.title,n.createElement("div",null,null===(r=e.renderSubTitle)||void 0===r?void 0:r.call(e)));return n.createElement(l.LabelGroup,{withLeftAccessory:n.createElement(a.FileIcon,{file:e}),withText:c,withSubtext:i})},t.FileNameCell.displayName="FileNameCell";const E=({row:e,setHoveredRow:t,setFocusedRow:i,rowLabel:o,isSelected:a=!1,multipleRowActions:l=!1,hasSharing:d=!1,isHoveredRow:u=!1,isChecked:m=!1})=>{const[h,v]=n.useState(),E=e=>!(!h||!0!==h[e]);let I=e.original?S(e.original):void 0;if((0,s.isCollection)(e.original)){const t=e.original.uniqueKey;I=()=>{h&&h[t]?v(Object.assign(Object.assign({},h),{[t]:!1})):v(Object.assign(Object.assign({},h),{[t]:!0}))}}const[T,R]=(0,s.isCollection)(e.original)?[e.original.showMoreLabel,e.original.hideMoreLabel]:"";let y=null;if((0,s.isCollection)(e.original)){let t=T;E(e.original.uniqueKey)&&(t=R),y=n.createElement(p.Button,{className:"show-hide-more",variant:"transparent",hasNoUnderline:!0,withDropdownIcon:!0,size:"small"},t)}const A=(0,s.isCollection)(e.original)&&E(e.original.uniqueKey)?e.original.renderCollection(e.original.attachmentIds):null,C=n.useMemo(()=>{var t,i;return null===(i=null===(t=e.original)||void 0===t?void 0:t.renderInlineActionMenu)||void 0===i?void 0:i.call(t)},[e.original]),b=(0,s.isCollection)(e.original)?n.createElement(n.Fragment,null,y,A):null,w={};return w[g.default.tableRow]=!0,w[g.default.selectedTableRow]=m,w["selected-table-row"]=m,n.createElement(n.Fragment,null,n.createElement(r.Table.Row,{isSelected:a,"data-testid":"files-table-row",className:(0,f.default)(w),onDoubleClick:e.original&&S(e.original),"aria-labelledby":o,onMouseDown:e=>{e.preventDefault()},onMouseEnter:()=>{t(e.id)},onMouseLeave:()=>{t(!1),i(!1)},onFocus:()=>{t(e.id),i(e.id)},onBlur:e=>{const n=e.relatedTarget||document.activeElement;e.currentTarget.contains(n)||(t(!1),i(!1))}},e.getVisibleCells().map(t=>{const i={};return i[g.default.filesTableSelectionCell]="select"===t.column.id,i[g.default.filenameCell]="filename"===t.column.id,i["files-table-file-collection-cell"]=(0,s.isCollection)(e.original),n.createElement(r.Table.Cell,{className:(0,f.default)(i),key:t.id,onClick:"filename"===t.column.id?I:void 0},(0,c.flexRender)(t.column.columnDef.cell,t.getContext()),"filename"===t.column.id?b:null)}),n.createElement(r.Table.Cell,{className:g.default.filesTableActions},u?C:void 0),e.original?n.createElement(_.RowActionBar,{file:e.original,multipleRowActions:l,hasSharing:d,isHoveredRow:u}):null))};E.displayName="FilesTableFileRow";t.FilesTable=({items:e,hasRowSelection:i=!1,hasSharing:a=!1,hasStarring:l=!1,viewExtensions:d=!1,viewHeaders:p=!1,multipleRowActions:_=!1,addSelectedRow:f,removeSelectedRow:S})=>{const[I]=n.useState(new Set),T=I.size,R=(0,u.useUniqueId)({prefix:""});let y=[{id:"filename",cell:e=>n.createElement("div",{className:g.default.fileDataContainer+" fileDataContainer"},e.row.original?n.createElement(t.FileNameCell,{file:e.row.original,labelID:v(e.row.index,R)}):null,(0,s.isStarrableFile)(e.row.original)&&l&&!(0,s.isCollection)(e.row.original)?n.createElement(m.StarIcon,{file:e.row.original,label:v(e.row.index,R)}):null),header:()=>n.createElement("span",null,"Name")}];d&&(y=[...y,{accessorFn:e=>{if(!(0,s.isCollection)(e))return e.extension},id:"extension",cell:e=>e.getValue()||"",header:()=>n.createElement("span",null,"Extension")}]);const A=n.useCallback(e=>{var t,i;if(!1===(null===(t=e.original)||void 0===t?void 0:t.isCheckable))return!1;const n=null===(i=e.original)||void 0===i?void 0:i.uniqueKey;return!(!n||!I.has(n))},[I]);i&&(y=[{id:"select",header:({table:e})=>n.createElement(o.Checkbox,Object.assign({},{checked:e.getIsAllRowsSelected(),isIndeterminate:e.getIsSomeRowsSelected(),onChange:e.getToggleAllRowsSelectedHandler()})),cell:({row:e})=>{var t,i;if(!1===(null===(t=e.original)||void 0===t?void 0:t.isCheckable))return null;const r=A(e),s=null===(i=e.original)||void 0===i?void 0:i.uniqueKey;return e.id!==D&&0===I.size?null:n.createElement(o.Checkbox,Object.assign({},{checked:r,onChange:()=>{var t,i;e.original&&s&&(r?(I.delete(s),null==S||S(null===(t=e.original)||void 0===t?void 0:t.uniqueKey)):(I.add(s),null==f||f(null===(i=e.original)||void 0===i?void 0:i.uniqueKey)))}}))}},...y]);const C=n.useMemo(()=>(0,h.createFocusGroup)({trackTabIndexOnFocus:!0,addTabIndextoChildrenOnFocus:!0}),[]);n.useEffect(()=>(C.activate(),()=>{C.deactivate()}),[C]);const b=n.useRef(null),w=g.default.tableRow;n.useEffect(()=>{var e;return b.current?C.setMembers(Array.from((null===(e=null==b?void 0:b.current)||void 0===e?void 0:e.querySelectorAll("."+w))||[])):C.setMembers([]),()=>{}},[C,w,e]);const P=e,[D,F]=n.useState({}),[L,N]=n.useState({}),[M,O]=n.useState(),j=(0,c.useReactTable)({data:P,columns:y,getCoreRowModel:(0,c.getCoreRowModel)()});return n.useEffect(()=>{const e=new Set;j.getRowModel().rows.forEach(t=>{var i,n;(null===(i=t.original)||void 0===i?void 0:i.uniqueKey)&&e.add(null===(n=t.original)||void 0===n?void 0:n.uniqueKey)}),I.forEach(t=>{e.has(t)||(I.delete(t),null==S||S(t))})},[A,j,S,I]),n.useEffect(()=>{const e=j.getRowModel().rows.map(e=>n.createElement(E,{row:e,key:e.id,setHoveredRow:F,setFocusedRow:N,rowLabel:v(e.index,R),isSelected:e.id===L,multipleRowActions:_,hasSharing:a,isHoveredRow:e.id===D,isChecked:A(e)}));O(e)},[L,a,D,R,j,_,O,e,T,A]),n.createElement(r.Table,{isSelectable:!0,className:g.default.filesTable,ref:b},p&&n.createElement(r.Table.Header,null,j.getHeaderGroups().map(e=>n.createElement(r.Table.Row,{key:e.id},e.headers.map(e=>n.createElement(r.Table.HeaderCell,{key:e.id},e.isPlaceholder?null:(0,c.flexRender)(e.column.columnDef.header,e.getContext())))))),n.createElement(r.Table.Body,null,M))},t.FilesTable.displayName="FilesTable"})),define("typescript/component_libraries/files_components/src/files-table/files-table-row-actions",["require","exports","tslib","react","dig-components/buttons","dig-components/tooltips","react-intl","typescript/component_libraries/files_components/src/common/file","dig-components/hooks","dig-components/buttons","dig-components/icons/src","dig-components/icons","dig-components/table","typescript/component_libraries/files_components/src/files-table/index.module.css"],(function(e,t,i,n,o,r,s,a,l,c,d,u,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RowActionBar=void 0,n=i.__importStar(n),g=i.__importDefault(g);t.RowActionBar=({file:e,multipleRowActions:t,hasSharing:i,isHoveredRow:h})=>{const p=n.useRef(null),_=(0,s.useIntl)(),f=(0,l.useUniqueId)({prefix:"files_table__action-item-"}),v=_.formatMessage({id:"At94iP",defaultMessage:"Share"}),S=_.formatMessage({id:"7aNEFN",defaultMessage:"Copy Link"}),E=i&&(0,a.isShareableFile)(e)&&(0,a.isCopylinkableFile)(e)&&h?n.createElement(o.Button,{variant:"opacity",withIconLeft:n.createElement(u.UIIcon,{src:d.LinkLine}),onClick:t=>{var i;t.stopPropagation(),null===(i=e.performCopyLinkAction)||void 0===i||i.call(e,p)},ref:p},S):null,I=i&&(0,a.isShareableFile)(e)&&h?t?n.createElement(r.Tooltip,{title:v,placement:"top",id:f},n.createElement(c.IconButton,{className:"files-table-share-button","data-testid":"file-share-button--icon",variant:"transparent",onClick:t=>{t.stopPropagation(),e.performShareAction()},onKeyPress:t=>{"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),e.performShareAction())},"aria-labelledby":f},n.createElement(u.UIIcon,{src:d.ShareArrowLine}))):n.createElement(o.Button,{className:"files-table-share-button","data-testid":"file-share-button--text",variant:"opacity",onClick:t=>{t.stopPropagation(),e.performShareAction()},onKeyPress:t=>{"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),e.performShareAction())},"aria-labelledby":f},v):null;return n.createElement(m.Table.Cell,{className:t?g.default.rowActionMultiple:g.default.rowActionSingle},E,I)},t.RowActionBar.displayName="RowActionBar"})),define("typescript/component_libraries/files_components/src/files-table/files-table-star",["require","exports","tslib","react","typescript/component_libraries/files_components/src/buttons/star_button"],(function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarIcon=void 0,n=i.__importStar(n);t.StarIcon=({file:e,label:t})=>{const i=r(e),a=s(e);return n.createElement(o.StarButton,{isStarred:!!e.isStarred,isDisabled:!e.isStarrable,tabIndex:0,onClick:i,onKeyPress:a,ariaLabelledBy:t})},t.StarIcon.displayName="StarIcon";const r=e=>n.useCallback(t=>{t.preventDefault(),t.stopPropagation(),e.performStarAction(!e.isStarred)},[e]),s=e=>n.useCallback(t=>{"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),e.performStarAction(!e.isStarred))},[e])})),define("typescript/component_libraries/files_components/src/files-table/index.module.css",["require","exports","css!typescript/component_libraries/files_components/src/files-table/index.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fileDataContainer=t.filesTableSelectionCell=t.filesTable=t.filenameCell=t.selectedTableRow=t.tableRow=t.rowActionMultiple=t.filesTableActions=t.rowActionSingle=void 0,t.rowActionSingle="_rowActionSingle_verj3_1",t.filesTableActions="_filesTableActions_verj3_5",t.rowActionMultiple="_rowActionMultiple_verj3_9",t.tableRow="_tableRow_verj3_17",t.selectedTableRow="_selectedTableRow_verj3_21",t.filenameCell="_filenameCell_verj3_31",t.filesTable="_filesTable_verj3_5",t.filesTableSelectionCell="_filesTableSelectionCell_verj3_50",t.fileDataContainer="_fileDataContainer_verj3_58";t.default={rowActionSingle:"_rowActionSingle_verj3_1",filesTableActions:"_filesTableActions_verj3_5",rowActionMultiple:"_rowActionMultiple_verj3_9",tableRow:"_tableRow_verj3_17",selectedTableRow:"_selectedTableRow_verj3_21",filenameCell:"_filenameCell_verj3_31",filesTable:"_filesTable_verj3_5",filesTableSelectionCell:"_filesTableSelectionCell_verj3_50",fileDataContainer:"_fileDataContainer_verj3_58"}})),define("metaserver/static/js/home/starred/starred_item_list",["require","exports","tslib","react","react-dom","metaserver/static/js/home/post_tti/api","metaserver/static/js/home/starred/constants","metaserver/static/js/home/starred/starred_empty_state","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/home/util/show_hide_link","metaserver/static/js/home/starred/starred_table","metaserver/static/js/home/starred/starred_files_table","metaserver/static/js/files_page/actionBar/lazy_files_page_action_bar","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/starred/redux/store","metaserver/static/js/starred/redux/slice","metaserver/static/js/home/starred/starred_uri_interface","metaserver/static/js/home/constants","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/home/store","metaserver/static/js/starred/id_type_pair"],(function(e,t,i,n,o,r,s,a,l,c,d,u,m,g,h,p,_,f,v,S,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredItemList=void 0,n=i.__importDefault(n),o=i.__importDefault(o);class I extends n.default.PureComponent{constructor(e){super(e),this.addSelectedRow=e=>{this.setState({selectedRows:[...this.state.selectedRows,e]})},this.removeSelectedRow=e=>{const t=[...this.state.selectedRows].filter(t=>{const i=(0,E.idTypePairToString)({type:t.idType,id:t.resourceId});return!(e===i)});this.setState({selectedRows:t})},this.toggleShowAll=()=>i.__awaiter(this,void 0,void 0,(function*(){const e=!this.state.showAll;if(l.homeActivityLogger.logClickShowAll("starred",e),this.setState({showAll:e}),e&&this.props.hasMore){const{loadAllStarredItems:e}=yield(0,r.waitForHomeTTI)();e()}const t=o.default.findDOMNode(this.refs.lastUnhiddenStar);if(t){const e=t.querySelector("a");e&&e.focus()}})),this._LazyFilesActionBar=(0,m.LazyFilesActionBar)(e=>this.setState({actionBarHeight:e})),this.state={showAll:e.showAll,actionBarHeight:0,selectedRows:[]}}render(){var e;const{itemModels:t,useFilesActionTable:i,useStarredActionBar:o,hasRowSelection:r}=this.props,{showAll:m,actionBarHeight:E}=this.state,T=Math.max(t.length-s.INITIAL_STARRED_ITEMS_LIMIT,0),R=T&&!m?t.slice(0,s.INITIAL_STARRED_ITEMS_LIMIT):t,y=o?{height:`calc(100% - ${E}px)`,overflow:"auto"}:{};let A=n.default.createElement(a.StarredEmptyState,null);R.length&&(A=i?n.default.createElement(u.StarredFilesTable,{items:R,addSelectedRow:this.addSelectedRow,removeSelectedRow:this.removeSelectedRow,hasRowSelection:r}):n.default.createElement(d.StarredTable,{items:R,withSelection:!1}));let C=[],b=[];this.state.selectedRows.forEach(e=>{if(b=[...b,e.resourceId],!e||!e.details)return;if(!("fqPath"in e.details))return;const t={file_id:e.details.fqPath,fq_path:e.details.fqPath,is_dir:(0,_.isFolder)(e)};C=[...C,t]});let w=!1,P=!1,D=!1,F=!1;"ON"===g.RECENTS_TABLE_REDESIGN&&(w=!0,P=!0,D=!0,F=!0);let L=this.state.selectedRows[0];this.state.selectedRows.length>1&&(L=void 0);const N=(0,h.getStoreForStarred)(),M={onNetworkRequest:()=>{l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.DELETE_STARRED_ITEM,C.length)},onSuccessResult:()=>{N.dispatch(p.StarredActions.deleteStarredItems({ids:b})),this.setState({selectedRows:[]}),l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.DELETE_STARRED_ITEM_SUCCEEDED,C.length)},onError:()=>{l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.DELETE_STARRED_ITEM_FAILED,C.length)},onRequestClose:()=>{}},O={onNetworkRequest:()=>{l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.MOVE_STARRED_ITEMS,C.length)},onSuccess:(e,t,i)=>{N.dispatch((0,p.getAllStarred)()),l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.MOVE_STARRED_ITEMS_SUCCEEDED,C.length)},onError:()=>{l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.MOVE_STARRED_ITEMS_FAILED,C.length)}},j={isPaper:!1,onShare:()=>{l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.CLICK_STAR_HEADER_SHARE,C.length)},origin:v.SHARE_ACTION_ORIGIN_TYPE.STARRED,url:null==L?void 0:L.url,isFolder:null!==(e=L&&(0,_.isFolder)(L))&&void 0!==e&&e},x=L?(e=>{var t;const i=e.details.fqPath;if(i&&e.title)return{currentName:null!==(t=e.title)&&void 0!==t?t:"",fq_path:null!=i?i:"",user:(0,S.getUser)()}})(L):void 0,H={onNetworkRequest:()=>{l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.RENAME_STARRED_ITEM,C.length)},onSuccess:()=>{N.dispatch((0,p.getAllStarred)()),l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.RENAME_STARRED_ITEM_SUCCEEDED,C.length)},onError:()=>{l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.RENAME_STARRED_ITEM_FAILED,C.length)}},V=!!x&&!!L,k=L?{href:L.url,source:"starred",isFswm:!1}:void 0,U={onAttempt:()=>{l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.DOWNLOAD_STARRED_ITEM,C.length)},onSuccess:()=>{l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.DOWNLOAD_STARRED_ITEM_SUCCEEDED,C.length)},onError:()=>{l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.DOWNLOAD_STARRED_ITEM_FAILED,C.length)}},q=!!k;return n.default.createElement("div",{className:"starred",id:I.displayName},o&&n.default.createElement(this._LazyFilesActionBar,{isEnabled:!0,uploadActionEnabled:!0,activeFiles:C,showGoToFolder:w,showDelete:P,deleteCallbacks:M,showMove:D,moveCallbacks:O,source:"starred",showShare:F&&!!L,shareArgs:j,expActionBarRedesignEnabled:!0,showRename:V,renameArgs:x,renameCallbacks:H,showDownload:q,downloadArgs:k,downloadCallbacks:U,showCopyLink:!!L,onCopyLink:()=>{l.homeActivityLogger.logSelectedFilesStarredEvent(f.LoggingTypes.STARRED_COPY_LINK,C.length)},createActionProps:{showSharedFolderCreate:!0,showAutomatedFolderCreate:!0,showCaptureCreate:!0,showPaperCreate:!0,showBinderCreate:!0,showGoogleCreate:!0}}),n.default.createElement("div",{className:"starred-container",style:y},A,!this.props.showAll&&T?n.default.createElement(c.ShowHideLink,{onClick:this.toggleShowAll,isExpanded:m,hiddenItemCount:T,canLoadMore:!1}):null))}}t.StarredItemList=I,I.displayName="StarredItemList"})),define("metaserver/static/js/home/starred/starred_resource_store",["require","exports","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","metaserver/static/js/home/starred/constants","metaserver/static/js/starred/constants","metaserver/static/js/home/starred/actions","metaserver/static/js/starred/store","metaserver/static/js/home/util/logging/availability_logger","metaserver/static/js/flux/flux_store","metaserver/static/js/home/post_tti/api"],(function(e,t,i,n,o,r,s,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStarredResourceStore=t.PrivateStarredResourceStoreClass=void 0;class u extends c.FluxStore{constructor(e){super(i.Dispatcher),this.orderedIds=[],this.itemsById={},this.loadingState=n.LoadingStates.LOADING,this.hasMore=!0,this.hasLoadedInitial=!1,this.hasLoadedAll=!1,this.isPaperUser=!0,e?s.StarredActions.handleEdisonStarredData(d.waitForHomeTTI,o.StarredResourceActionTypes.LOADING_INITIAL,e):(0,l.getHomeAvailabilityLogger)().handlePrefetch(n.HomePrefetchTypes.RETRIEVE_STARRED,e=>s.StarredActions.handleRetrieveStarredPayload(d.waitForHomeTTI,o.StarredResourceActionTypes.LOADING_INITIAL,e))}getStarredStore(){return a.StarredStore}clearPresentableItemsCache(){this.presentableItemsCache=null}getItems(){return this.presentableItemsCache||(this.presentableItemsCache=this.orderedIds.map(e=>this.itemsById[e]).filter(e=>{const t={id:e.resourceId,type:e.idType},i=this.getStarredStore().getLoadingState(t),n=this.getStarredStore().getIsStarred(t);return i===r.StarredLoadingState.LOADING||n})),this.presentableItemsCache}getItem(e){return this.itemsById[e]}getLoadingState(){return this.loadingState}getHasMore(){return this.hasMore}getHasLoadedInitial(){return this.hasLoadedInitial}getHasLoadedAll(){return this.hasLoadedAll}getIsPaperUser(){return this.isPaperUser}onItemsLoading(){this.loadingState=n.LoadingStates.LOADING}onItemsLoadSuccess(e,t){e.forEach(e=>{this.itemsById[e.resourceId]=e}),this.loadingState=n.LoadingStates.SUCCESS,this.orderedIds=e.map(e=>e.resourceId),this.hasMore=t,e.length&&this.clearPresentableItemsCache()}onItemsLoadFailure(e){this.loadingState=n.LoadingStates.FAILURE,e&&e===o.NOT_PAPER_USER_ERROR&&(this.isPaperUser=!1)}onItemsLoadComplete(e,t){e!==o.StarredLoadingTypes.INITIAL&&t||(this.hasLoadedInitial=!0),e!==o.StarredLoadingTypes.ALL&&t||(this.hasLoadedAll=!0)}onStatusChange(){(0,d.waitForHomeTTI)().then(({loadAllStarredItems:e})=>e()),this.clearPresentableItemsCache()}__onDispatch(e){const t=e.action;switch(t.type){case o.StarredResourceActionTypes.LOADING_INITIAL:case o.StarredResourceActionTypes.LOADING_ALL:this.onItemsLoading(),this.__emitChange();break;case o.StarredResourceActionTypes.LOAD_SUCCESS:this.onItemsLoadSuccess(t.items,t.hasMore),this.onItemsLoadComplete(t.loadingType,t.hasMore),this.__emitChange();break;case o.StarredResourceActionTypes.LOAD_FAILURE:this.onItemsLoadFailure(t.error),this.onItemsLoadComplete(t.loadingType,!0),this.__emitChange();break;case r.StarredActionTypes.LOADING:this.clearPresentableItemsCache(),this.__emitChange();break;case r.StarredActionTypes.SET_STATUS:this.onStatusChange(),this.__emitChange()}}}t.PrivateStarredResourceStoreClass=u;let m=null;t.getStarredResourceStore=function(e){return null===m&&(m=new u(e)),m}})),define("metaserver/static/js/home/starred/starred_view",["require","exports","tslib","react","react-redux","metaserver/static/js/files_page/data/store","metaserver/static/js/files_page/data/action_creators","metaserver/static/js/home/constants","metaserver/static/js/home/starred/starred_item_list","metaserver/static/js/home/starred/starred_layout","metaserver/static/js/home/store","metaserver/static/js/home/util/logging/timing_component","metaserver/static/js/starred/redux/store"],(function(e,t,i,n,o,r,s,a,l,c,d,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredView=t.StarViewWithFilesPage=void 0,n=i.__importDefault(n);class g extends n.default.PureComponent{constructor(e){super(e),this.state={showAll:!1}}render(){const{canRenderItems:e,isHiddenByUser:i,useFilesActionTable:o}=this.props;return n.default.createElement(t.StarViewWithFilesPage,null,n.default.createElement(n.default.Fragment,null,e?n.default.createElement(c.StarredLayout,Object.assign({isHiddenByUser:i,showHeader:!0,starredComponent:l.StarredItemList,useStarredActionBar:!1,useFilesActionTable:o},this.state)):null))}}g.displayName="StarredView";t.StarViewWithFilesPage=({children:e})=>{const t=n.default.useMemo(()=>{(0,m.getStoreForStarred)();const e=(0,r.getStoreForFilesPage)();return e.dispatch((0,s.appInit)({user:(0,d.getUser)()})),e},[]);return n.default.createElement(o.Provider,{store:t},e)},t.StarViewWithFilesPage.displayName="StarViewWithFilesPage",t.StarredView=(0,u.timingComponent)(g,a.HomeSections.STARRED)})),define("metaserver/static/js/home/starred/starred_layout",["require","exports","tslib","react","react-redux","metaserver/static/js/home/actions","metaserver/static/js/home/constants","metaserver/static/js/components/ui/section/section_header","metaserver/static/js/home/store","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/core/i18n","metaserver/static/js/starred/redux/selectors","metaserver/static/js/starred/redux/slice","metaserver/static/js/starred/redux/types","metaserver/static/js/home/util/logging/timing_logger","metaserver/static/js/home/starred/constants"],(function(e,t,i,n,o,r,s,a,l,c,d,u,m,g,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredLayout=t.STARRED_HEADER_TITLE=void 0,n=i.__importStar(n),t.STARRED_HEADER_TITLE=d.intl.formatMessage({id:"Nd85dl",defaultMessage:"Starred"});t.StarredLayout=({isHiddenByUser:e,starredComponent:i,showHeader:d,showAll:_,useStarredActionBar:f,useFilesActionTable:v})=>{const S=(0,n.useCallback)(()=>{const t=e;r.HomeActions.setSectionVisibility((0,l.getUserId)(),{".tag":"starred"},t),c.homeActivityLogger.logShowHideSection(s.HomeSections.STARRED,!t)},[e]),E=(0,o.useDispatch)();(0,n.useEffect)(()=>{E((0,m.getAllStarred)());const e=()=>{"visible"===document.visibilityState&&E((0,m.getAllStarred)())};return document.addEventListener("visibilitychange",e,!1),function(){document.removeEventListener("visibilitychange",e)}},[]);const I=(0,o.useSelector)(u.getStarredItems),T=(0,o.useSelector)(u.getHasMore),R=(0,o.useSelector)(u.getMetadataLoadingState);(0,n.useEffect)(()=>{if(R===g.StarredLoadingStateEnum.LOAD_SUCCESS){if(h.homeTimingLogger.logTTData(s.HomeSections.STARRED)){const e=I.length>p.INITIAL_STARRED_ITEMS_LIMIT;c.homeActivityLogger.logStarredShown(I.length,e,T),h.homeTimingLogger.logTTI(s.HomeSections.STARRED)}}},[T,I.length,R]);const y=i;return n.default.createElement("section",{className:"home-access-section"},d&&n.default.createElement(a.SectionHeader,{title:t.STARRED_HEADER_TITLE,ueName:"starred",isHidden:e,onToggleHidden:S,ariaControls:y.displayName}),!e&&n.default.createElement(y,{itemModels:I,hasMore:T,showAll:_,useStarredActionBar:f,useFilesActionTable:v}))},t.StarredLayout.displayName="StarredLayout"})),define("metaserver/static/js/home/starred/starred_empty_state",["require","exports","tslib","react","metaserver/static/js/components/ui/section/section_empty_text","metaserver/static/js/core/i18n"],(function(e,t,i,n,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredEmptyState=void 0,n=i.__importDefault(n),t.StarredEmptyState=function(){return n.default.createElement(o.SectionEmptyText,{message:r.intl.formatMessage({id:"bFX0L5",defaultMessage:"When you star items, they’ll show up here for easy access."}),learnMoreLink:"/help/desktop-web/star-doc-file-folder"})}})),define("metaserver/static/js/home/starred/starred_files_table",["require","exports","tslib","react","metaserver/static/js/home/starred/starred_to_ikea","typescript/component_libraries/files_components/src/files-table/files-table","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/starred/id_type_pair"],(function(e,t,i,n,o,r,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredFilesTable=void 0,n=i.__importStar(n);const l={hasSharing:!0,hasStarring:!0,viewExtensions:!1,viewHeaders:!1,multipleRowActions:"ON"===s.RECENTS_TABLE_REDESIGN};t.StarredFilesTable=({items:e,addSelectedRow:t,removeSelectedRow:i,hasRowSelection:s})=>{const c=n.useMemo(()=>e.map(o.starredToIkea),[e]);return n.createElement(r.FilesTable,Object.assign({items:c},l,{addSelectedRow:i=>{const n=(t=>e.filter(e=>t===(0,a.idTypePairToString)({type:e.idType,id:e.resourceId}))[0])(i);n&&(null==t||t(n))},removeSelectedRow:e=>{null==i||i(e)},hasRowSelection:null!=s&&s}))},t.StarredFilesTable.displayName="StarredFilesTable"})),define("metaserver/static/js/home/starred/models/starred_item",["require","exports","metaserver/static/js/home/constants"],(function(e,t,i){"use strict";function n(e,t){const n=i.DisplayTypeToResourceType[e];if(n===i.FILE_RESOURCE_TYPE){return{fqPath:t.fq_path}}if(n===i.FOLDER_RESOURCE_TYPE){const e=t;return{fqPath:e.fq_path,targetNsId:e.target_ns_id,isTeamMemberFolder:e.is_team_member_folder}}return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.starredItemModelToStarredStatus=t.edisonStarredDataToStarredStatus=t.detailsFromJson=t.starredItemFromJson=void 0,t.starredItemFromJson=function(e){return{title:e.title,resourceId:e.resource_id,idType:e.id_type,displayType:e.display_type,url:e.url,isMounted:e.is_mounted,perNodeMetadata:e.per_node_metadata,details:n(e.display_type,e.details),icon:e.icon}},t.detailsFromJson=n,t.edisonStarredDataToStarredStatus=function(e){return e.items.map(e=>({idTypePair:{id:e.resourceId,type:e.idType},starred:!0}))},t.starredItemModelToStarredStatus=function(e){return{id:e.resourceId,type:e.idType,is_starred:!0}}})),define("typescript/component_libraries/files_components/src/table/plugins/starring",["require","exports","tslib","react","react-redux","typescript/component_libraries/files_components/src/buttons/star_button","typescript/component_libraries/files_components/src/table/columns/file_name_column"],(function(e,t,i,n,o,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UseStarring=void 0,n=i.__importStar(n);t.UseStarring=({columns:e})=>{e.push(a)},t.UseStarring.pluginName="UseStarring";const a=e=>e.map(e=>{if(e.id!==s.FileNameColumn.id)return e;const t=e.Cell;return t&&"function"==typeof t?Object.assign(Object.assign({},e),{Cell:e=>{const i=e.row.original,o=l(i),a=c(i);return n.createElement(n.Fragment,null,t(e),n.createElement(r.StarButton,{isStarred:!!i.isStarred,isDisabled:!i.isStarrable,tabIndex:0,onClick:o,onKeyPress:a,ariaLabelledBy:(0,s.getLabelIDFromRowIndex)(e.row.index)}))}}):e}),l=e=>{const t=(0,o.useDispatch)();return n.useCallback(i=>{i.preventDefault(),i.stopPropagation(),e.performStarAction(!e.isStarred,t)},[e])},c=e=>{const t=(0,o.useDispatch)();return n.useCallback(i=>{"Enter"===i.key&&(i.preventDefault(),i.stopPropagation(),e.performStarAction(!e.isStarred,t))},[e])}})),define("metaserver/static/js/home/starred/starred_table",["require","exports","tslib","react","typescript/component_libraries/dig-experimental/src/managed_table/index","typescript/component_libraries/files_components/src/table/columns/file_name_column","typescript/component_libraries/files_components/src/table/plugins/starring","metaserver/static/js/components/ui/css","metaserver/static/js/home/starred/starred_to_ikea"],(function(e,t,i,n,o,r,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredTable=void 0,n=i.__importStar(n);const c=(0,o.createManagedTable)(s.UseStarring,o.useHoverActions,o.useLinkBehavior,o.useKeyboarding),d=e=>{var{data:t,columns:r}=e,a=i.__rest(e,["data","columns"]);const l=(0,o.useManagedTable)({columns:r,data:t},s.UseStarring,o.useHoverActions,o.useLinkBehavior,o.useKeyboarding,o.useFlexLayout,o.useRowSelect);return n.createElement(o.UnmanagedTable,Object.assign({instance:l},a))},u=[r.FileNameColumn],m=[o.rowSelectionColumn,r.FileNameColumn],g=({items:e,withSelection:t=!1})=>{const i=n.useMemo(()=>e.map(l.starredToIkea),[e]);return t?n.createElement(d,{isSelectable:!0,showHeader:!1,columns:m,data:i}):n.createElement(c,{isSelectable:!0,showHeader:!1,columns:u,data:i})};g.displayName="StarredTableNoCss",t.StarredTable=(0,a.requireCssWithComponent)(g,["/static/typescript/component_libraries/dig-experimental/src/index.web-vfl_m6TBk.css"])})),define("metaserver/static/js/home/starred/starred_to_ikea",["require","exports","tslib","react","classnames","dig-components/hooks","metaserver/static/js/home/constants","metaserver/static/js/starred/id_type_pair","metaserver/static/js/home/store","metaserver/static/js/core/i18n","dig-components/buttons","metaserver/static/js/home/post_tti/api","metaserver/static/js/clean/navigation","metaserver/static/js/filepath/filepath","metaserver/static/js/home/util/paper_utils","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/home/starred/starred_uri_interface","metaserver/static/js/edison/ui/router_utils","metaserver/static/js/clean/history_singleton","metaserver/static/js/starred/redux/slice","typescript/component_libraries/files_components/src/table/columns/file_name_column","metaserver/static/js/starred/redux/store","metaserver/static/js/files_page/actionBar/lazy_files_page_action_bar","metaserver/static/js/sharing/views/copy_link_mini_modal/copy_link_mini_modal","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/home/resource_id_types","metaserver/static/js/home/util/file_utils","metaserver/static/js/app_actions/app_actions_menu","metaserver/static/js/home/constants"],(function(e,t,i,n,o,r,s,a,l,c,d,u,m,g,h,p,_,f,v,S,E,I,T,R,y,A,C,b,w,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.starredToIkea=void 0,n=i.__importStar(n),o=i.__importDefault(o);t.starredToIkea=(e,t)=>{var i,o;const r=Object.assign(Object.assign({},e),{index:t}),s=null===(i=e.details)||void 0===i?void 0:i.fqPath,c=(0,T.getStoreForStarred)(),d=()=>{if(e&&e.idType===C.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID&&e.title&&s)return(0,b.getFileFromPartial)({file_id:e.resourceId,ext:"."+(0,g.file_extension)(e.title),ns_id:void 0,ns_path:void 0,fq_path:s})},u=(()=>{var t;return!!e.isMounted&&(null===(t=e.perNodeMetadata)||void 0===t?!0:!t.suppress_share)})();return{uniqueKey:(0,a.idTypePairToString)({type:e.idType,id:e.resourceId}),title:e.title,extension:(0,g.file_extension)(s||""),isFolder:(0,f.isFolder)(e),isStarred:!0,isStarrable:!0,isShareable:u,isCheckable:e.isMounted,url:(0,f.href_for_file)((0,l.getUser)(),e),performOpenAction:(e,t)=>M(r,e,t),performStarAction:e=>N(r,e),performShareAction:()=>F(r),icon:e.icon,ariaLabelledBy:(0,I.getLabelIDFromRowIndex)(t),renderHoverActions:()=>n.createElement(D,{item:r,index:t}),renderInlineActionMenu:"ON"===A.RECENTS_TABLE_REDESIGN?()=>{var t,i,o,a;const u={onNetworkRequest:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.DELETE_STARRED_ITEM,...O(r))},onSuccessResult:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.DELETE_STARRED_ITEM_SUCCEEDED,...O(r)),c.dispatch(E.StarredActions.deleteStarredItem({id:e.resourceId}))},onError:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.DELETE_STARRED_ITEM_FAILED,...O(r))},onRequestClose:()=>{}},m={href:e.url,source:"starred",isFswm:!1};let g=void 0;m&&(g={onAttempt:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.DOWNLOAD_STARRED_ITEM,...O(r))},onSuccess:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.DOWNLOAD_STARRED_ITEM_SUCCEEDED,...O(r))},onError:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.DOWNLOAD_STARRED_ITEM_FAILED,...O(r))}});const h=(()=>{var t;if(!s||!e.title)return;return{currentName:null!==(t=e.title)&&void 0!==t?t:"",fq_path:null!=s?s:"",user:(0,l.getUser)()}})(),p={onNetworkRequest:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.RENAME_STARRED_ITEM,...O(r))},onSuccess:e=>{c.dispatch((0,E.getAllStarred)()),_.homeActivityLogger.logStarredEvent(P.LoggingTypes.RENAME_STARRED_ITEM_SUCCEEDED,...O(r))},onError:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.RENAME_STARRED_ITEM_FAILED,...O(r))}},v=!!h,S={onNetworkRequest:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.MOVE_STARRED_ITEMS,...O(r))},onSuccess:(e,t,i)=>{c.dispatch((0,E.getAllStarred)()),_.homeActivityLogger.logStarredEvent(P.LoggingTypes.MOVE_STARRED_ITEMS_SUCCEEDED,...O(r))},onError:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.MOVE_STARRED_ITEMS_FAILED,...O(r))}},I=(0,R.LazyFilesActionBar)(),T=(()=>{const e=d();return e?n.createElement(w.UnconnectedExtensionsMenu,{className:"hacky-ext-menu",user:(0,l.getUser)(),file:e,telemetryContext:{surface:"home_starred"}}):null})();return n.createElement(n.Fragment,null,T,n.createElement(I,{isEnabled:!0,showGoToFolder:null!==(t=e.isMounted)&&void 0!==t&&t,onGoToFolder:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.GO_TO_FOLDER,...O(r))},uploadActionEnabled:!1,activeFiles:s?[{fq_path:s,is_dir:(0,f.isFolder)(e),file_id:s}]:void 0,showDelete:!0!==(null===(i=e.perNodeMetadata)||void 0===i?void 0:i.suppress_delete),showDownload:!(0,f.isFolder)(e)&&null!==(o=e.isMounted)&&void 0!==o&&o&&!(null===(a=e.icon)||void 0===a?void 0:a.includes("paper")),deleteCallbacks:u,downloadArgs:m,downloadCallbacks:g,showRename:v,renameArgs:h,renameCallbacks:p,onExtensionClick:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.STARRED_OPEN_IN,...O(r))},file:d(),showMove:!0,moveCallbacks:S,source:"starred",suppressTopLevel:!0}))}:void 0,performCopyLinkAction:"ON"===A.RECENTS_TABLE_REDESIGN&&!0!==(null===(o=e.perNodeMetadata)||void 0===o?void 0:o.suppress_shared_link)?e=>{const t={user:(0,l.getUser)(),setIsCreatingSharedLink:(e,t)=>{},anchorRef:e,onActionFlowComplete:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.STARRED_COPY_LINK,...O(r))},filePath:s};y.CopyLinkMiniModal.show(t)}:void 0}};const D=({item:e,index:t})=>{const i=(0,r.useUniqueId)({prefix:"starred__action-item-"});return n.createElement(d.Button,{id:i,onClick:()=>F(e),onKeyPress:t=>L(t,e),variant:"opacity","aria-labelledby":(0,o.default)(i,(0,I.getLabelIDFromRowIndex)(t))},c.intl.formatMessage({id:"At94iP",defaultMessage:"Share"}))};D.displayName="StarredHoverActions";const F=e=>{if(e.displayType===s.PAPER_DOCUMENT_RESOURCE_TYPE)return void(0,h.sharePaperDoc)(e.url,()=>j(e));j(e);const t=(0,f.isFolder)(e)?e.details.targetNsId:null,i=e.details.fqPath;(0,u.waitForHomeTTI)().then(n=>{n.asyncShowShareModal((0,l.getUser)(),{fqPath:i,isFolder:(0,f.isFolder)(e),targetNsId:t},{origin:p.SHARE_ACTION_ORIGIN_TYPE.STARRED})})},L=(e,t)=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),F(t))},N=(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=(0,T.getStoreForStarred)();yield i.dispatch((0,E.updateStarredStatus)({id:e.resourceId,idType:e.idType,newStatus:t,itemName:e.title,showSnackbar:!0}))})),M=(e,t,i)=>{if(s.DisplayTypeToResourceType[e.displayType]!==s.FILE_RESOURCE_TYPE||t){const{host:i,pathname:n}=new URL(e.url);!t&&window.location.host===i&&(0,v.shouldUseReactRouter)(n)?(x(e),(0,S.getBrowserHistory)().push(n)):(0,m.logAndNavigate)(e.url,()=>x(e),t?m.NavigationMethod.NEW_TAB:m.NavigationMethod.REDIRECT)}else(0,u.waitForHomeTTI)().then(t=>t.openInFileViewer({resourceId:(0,a.idTypePairToString)({type:e.idType,id:e.resourceId}),logViewFunction:()=>x(e),href:null==i?void 0:i.href,middleClick:null==i?void 0:i.middleClick}))},O=e=>[e.resourceId,s.DisplayTypeToResourceType[e.displayType],e.index],j=e=>_.homeActivityLogger.logClickStarOverflowShare(...O(e)),x=e=>_.homeActivityLogger.logOpenStarredItem(...O(e))})),define("metaserver/static/js/home/util/paper_utils",["require","exports","metaserver/static/js/clean/navigation"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharePaperDoc=void 0,t.sharePaperDoc=function(e,t){(0,i.logAndNavigate)(`${e}?openSharing=1`,t)}})),define("metaserver/static/js/home/starred/actions",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/starred/constants","metaserver/static/js/home/starred/models/starred_item","metaserver/static/js/starred/model","metaserver/static/js/home/starred/models/starred_item","metaserver/static/js/core/exception","metaserver/static/js/core/exception"],(function(e,t,i,n,o,r,s,a,l,c){"use strict";function d(e,t){return n.Dispatcher.dispatch({type:o.StarredResourceActionTypes.LOAD_FAILURE,error:t,loadingType:e}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.StarredActions=t.onRetrieveStarredError=void 0,c=i.__importStar(c),t.onRetrieveStarredError=d;class u{static handleRetrieveStarredPayload(e,t,i){if("success"!==i.status)throw d(t,i.status);{if(!i.items||void 0===i.has_more)throw(0,l.reportStack)("Home starred items request returned success without items or hasMore",{severity:l.SEVERITY.NONCRITICAL}),d(t,new Error("Invalid server response for Starred getItems"));const a=i.items.map(r.starredItemFromJson),c=(0,s.statusResultsToStarredStatuses)(a.map(r.starredItemModelToStarredStatus));n.Dispatcher.dispatch({type:o.StarredResourceActionTypes.LOAD_SUCCESS,hasMore:i.has_more,items:a,starredStatuses:c,loadingType:t}),e().then(({getStarredStatusMetadata:e})=>e(c))}}static handleEdisonStarredData(e,t,i){if(i.jsonData){let t;t=JSON.parse(i.jsonData),u.handleRetrieveStarredPayload(e,o.StarredLoadingTypes.ALL,t)}else if("success"===i.status){const r=(0,a.edisonStarredDataToStarredStatus)(i);n.Dispatcher.dispatch({type:o.StarredResourceActionTypes.LOAD_SUCCESS,hasMore:Boolean(i.hasMore),items:i.items,starredStatuses:r,loadingType:t}),e().then(({getStarredStatusMetadata:e})=>e(r))}else{const e=new Error("EdisonStarredPrefetchFailure");c.reportException({err:e,severity:c.SEVERITY.CRITICAL,exc_extra:{starredData:JSON.stringify(i)}}),n.Dispatcher.dispatch({type:o.StarredResourceActionTypes.LOAD_FAILURE,loadError:e,loadingType:t})}}}t.StarredActions=u})),define("metaserver/static/js/home/starred/starred_uri_interface",["require","exports","metaserver/static/js/home/constants","metaserver/static/js/clean/browse_uri_interface"],(function(e,t,i,n){"use strict";function o(e){return i.DisplayTypeToResourceType[e.displayType]===i.FOLDER_RESOURCE_TYPE}Object.defineProperty(t,"__esModule",{value:!0}),t.isFolder=t.href_for_file=void 0,t.href_for_file=function(e,t,i={}){var r;if(o(t))return t.url;const s=null===(r=t.details)||void 0===r?void 0:r.fqPath;return s?(0,n.preview_uri_for_fq_path)(e,s,i).toString():t.url},t.isFolder=o})),define("typescript/component_libraries/files_components/src/buttons/star_button",["require","exports","tslib","react","classnames","react-intl","dig-components/hooks","dig-components/tooltips","dig-components/buttons","dig-components/icons","dig-components/icons/src"],(function(e,t,i,n,o,r,s,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarButton=void 0,n=i.__importStar(n),o=i.__importDefault(o);t.StarButton=({isStarred:e,onClick:t,onKeyPress:i,isDisabled:m,tabIndex:g=-1,showTooltip:h=!0,ariaLabelledBy:p})=>{const _=(0,s.useUniqueId)({prefix:"star-button-"}),f=(0,r.useIntl)(),v=u(f,e,m);let S=n.createElement(l.IconButton,{variant:"transparent",role:"button","aria-pressed":e,"aria-label":v,onClick:t,onKeyPress:i,disabled:m,tabIndex:g,"data-testid":"star__toggle",id:_,"aria-labelledby":(0,o.default)(_,p)},n.createElement(c.UIIcon,{src:e?d.StarFill:d.StarLine}));return h&&(S=n.createElement(a.Tooltip,{title:v,placement:"top"},S)),S},t.StarButton.displayName="StarButton";const u=(e,t,i)=>i?t?e.formatMessage({id:"d/rfbV",defaultMessage:"Starred"}):void 0:t?e.formatMessage({id:"U3Qbdz",defaultMessage:"Remove from Starred"}):e.formatMessage({id:"QY29C7",defaultMessage:"Add to Starred"})})),define("metaserver/static/js/common/uuid",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUUID=void 0,t.generateUUID=function(e){const t=()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1),i=t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t();return e?e+i:i}})),define("typescript/component_libraries/files_components/src/common/file",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCopylinkableFile=t.isShareableFile=t.isStarrableFile=t.isOpenable=t.isCollection=void 0,t.isCollection=function(e){return!!e.attachmentIds},t.isOpenable=function(e){return!!e.performOpenAction},t.isStarrableFile=function(e){return!!e.performStarAction},t.isShareableFile=function(e){return e.isShareable},t.isCopylinkableFile=function(e){return void 0!==e.performCopyLinkAction}})),define("metaserver/static/js/home/actions_post_tti",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","metaserver/static/js/core/notify","metaserver/static/js/home/api_post_tti","metaserver/static/js/core/i18n"],(function(e,t,i,n,o,r,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSectionVisibilityHelper=t.setSectionVisibilityPostTTI=void 0;t.setSectionVisibilityPostTTI=(e,n,o)=>{(0,t.setSectionVisibilityHelper)(e,n,o,()=>i.__awaiter(void 0,void 0,void 0,(function*(){return s.setSectionVisibility})))};t.setSectionVisibilityHelper=(e,t,s,l)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=t[".tag"];n.Dispatcher.dispatch({type:o.HomeActionTypes.SET_SECTION_VISIBILITY,payload:{section:i,visible:s}});try{yield(yield l())(e,t,s)}catch(e){const t=s?a.intl.formatMessage({id:"D9XHqB",defaultMessage:"Unable to show section."}):a.intl.formatMessage({id:"W8LAoH",defaultMessage:"Unable to hide section."});throw r.Notify.error(t),n.Dispatcher.dispatch({type:o.HomeActionTypes.SET_SECTION_VISIBILITY,payload:{section:i,visible:!s}}),e}}))})),define("metaserver/static/js/home/actions",["require","exports","tslib","metaserver/static/js/modules/constants/env","metaserver/static/js/core/uri","metaserver/static/js/core/i18n","metaserver/static/js/core/notify","metaserver/static/js/home/post_tti/api","metaserver/static/js/home/actions_post_tti","metaserver/static/js/clean/viewer"],(function(e,t,i,n,o,r,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeActions=void 0;t.HomeActions=class{static setSectionVisibility(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){(0,l.setSectionVisibilityHelper)(e,t,n,()=>i.__awaiter(this,void 0,void 0,(function*(){const{setSectionVisibility:e}=yield(0,a.waitForHomeTTI)();return e})))}))}static createPaperDocInNewTab(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=r.intl.formatMessage({id:"PhUVTN",defaultMessage:"Could not create paper document."}),i=window.open("about:blank");try{const{createPaperDoc:r}=yield(0,a.waitForHomeTTI)(),l=yield r(e),d=c.Viewer.get_viewer(),u=d.get_user_by_id(e),m=d.is_paired?{role:u.role}:{};if(i&&!i.closed){const e=new o.URI({scheme:"https",authority:n.NOTES_WEBSERVER,path:"/doc/"+l.doc_id,query:m}).toString();i.location.replace(e)}else s.Notify.error(t)}catch(e){if(s.Notify.error(t),i&&!i.closed)return i.close()}}))}}})),define("metaserver/static/js/home/api_post_tti",["require","exports","metaserver/static/js/api_v2/user_client"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPaperDoc=t.setSectionVisibility=void 0;t.setSectionVisibility=(e,t,n)=>(new i.UserApiV2Client).ns("home").rpc("set_section_visibility",{section:t,visible:n},{subjectUserId:e});t.createPaperDoc=e=>(new i.UserApiV2Client).ns("paper").upload("docs/create",{import_format:{".tag":"plain_text"}},"",{subjectUserId:e})})),define("metaserver/static/js/home/recents/actions/error_actions",["require","exports","tslib","lodash","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/core/exception","metaserver/static/js/core/i18n","metaserver/static/js/core/notify"],(function(e,t,i,n,o,r,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorActions=t.ErrorActions=void 0,n=i.__importStar(n),s=i.__importStar(s);class c{constructor(e){this._flushQueues=()=>{this._rafId=null;const e=this._recentActivityQueue;this._recentActivityQueue=[],e.length&&this._dispatcher.dispatch({type:o.RAW_RECENT_ACTIVITY_PARSE_ERROR,errors:e});const t=this._relatedActivityQueue;this._relatedActivityQueue=[],t.length&&this._dispatcher.dispatch({type:o.RAW_RELATED_ACTIVITY_PARSE_ERROR,errors:t})},this._notify=n.throttle(()=>{const e=a.intl.formatMessage({id:"QANSaH",defaultMessage:"Sorry, we were unable to show some recent items. The team has been notified"});l.Notify.error(e)},500,{trailing:!1}),this._dispatcher=e,this._recentActivityQueue=[],this._relatedActivityQueue=[],this._rafId=null}recentActivityParseError(e,t){s.reportException({err:t}),this._notify(),this._enqueueError(this._recentActivityQueue,e,t)}relatedActivityParseError(e,t){s.reportException({err:t}),this._notify(),this._enqueueError(this._relatedActivityQueue,e,t)}_enqueueError(e,t,i){e.push({activityKey:t,error:i}),this._rafId||(this._rafId=window.requestAnimationFrame(this._flushQueues))}}t.ErrorActions=c,t.errorActions=new c(r.recentActivityDispatcher)})),define("metaserver/static/js/home/recents/actions/federated_recent_activity_actions",["require","exports","tslib","metaserver/static/js/core/i18n","metaserver/static/js/core/browser","metaserver/static/js/components/ui/modal","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/recent_activity_federated_model","metaserver/static/js/home/recents/stores/recent_activity_store","metaserver/static/js/core/exception","metaserver/static/js/core/notify","metaserver/static/js/home/recents/utils/events","metaserver/static/js/home/post_tti/api"],(function(e,t,i,n,o,r,s,a,l,c,d,u,m,g){"use strict";function h(e,t,i){e?o.open_tab(e):(0,d.reportStack)(`Cannot open tab to preform the action ${t}`,{severity:d.SEVERITY.NONCRITICAL,exc_extra:{paperRecentItem:i.paperRecentItem}})}function p(e,t,i){"cellView"in i?(0,m.logFederatedItemEvent)(e,i.cellView,t):(0,m.logCleanFederatedItemEvent)(e,i.itemNumber,i.subgroupPosition,t)}function _(e,t){a.recentActivityDispatcher.dispatch({type:e,activityKey:t})}Object.defineProperty(t,"__esModule",{value:!0}),t.promptAndArchiveItem=t.previewItem=t.shareItem=void 0,o=i.__importStar(o),t.shareItem=function(e,t){p(s.ActionType.PAPER_SHARE,e,t),h((0,l.getPaperShareUrl)(e),s.ActionType.PAPER_SHARE,e)},t.previewItem=function(e,t){p(s.ActionType.PAPER_OPEN,e,t),h(e.getUrl(),s.ActionType.PAPER_OPEN,e)},t.promptAndArchiveItem=function(e,t,o){const a=e.getActivityKey();if((0,c.getRecentActivityStore)().canArchiveActivityKey(a)){const a=e.getActivityKey();r.SimpleModal.show({title_text:n.intl.formatMessage({id:"bArtK/",defaultMessage:"Archive document?"}),body_html:n.intl.formatMessage({id:"S6cb1J",defaultMessage:"Do you want to archive this document?"}),confirm_text:n.intl.formatMessage({id:"JiHG/V",defaultMessage:"Archive"}),cancel_text:n.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),autoclose:!0,confirm_callback:()=>i.__awaiter(this,void 0,void 0,(function*(){p(s.ActionType.PAPER_ARCHIVE,e,o),_(s.ARCHIVE_PAPER_DOCUMENT_PENDING,a);try{(yield(yield(0,g.waitForHomeTTI)()).archivePaperResources(t,[e.paperRecentItem])).some(t=>(0,l.equalsPaperRecentItem)(e,t))?(_(s.ARCHIVE_PAPER_DOCUMENT_COMMIT,a),u.Notify.success(n.intl.formatMessage({id:"r3vKLt",defaultMessage:"The document was archived."}))):_(s.ARCHIVE_PAPER_DOCUMENT_ROLLBACK,a)}catch(e){_(s.ARCHIVE_PAPER_DOCUMENT_ROLLBACK,a)}}))})}}})),define("metaserver/static/js/home/recents/actions/recent_activity_actions",["require","exports","tslib","lodash","metaserver/static/js/clean/navigation","metaserver/static/js/pnm/utils","metaserver/static/js/home/post_tti/api","metaserver/static/js/home/recents/actions/federated_recent_activity_actions","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/stores/recent_activity_store","metaserver/static/js/plusplus/logging","metaserver/static/js/core/exception"],(function(e,t,i,n,o,r,s,a,l,c,d,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refreshRecentItems=t.openVersions=t.downloadFiles=t.openFile=t.hasCursor=t.loadNextPage=t.archiveRecentItem=t.deleteRecentItem=t.previewRecentItem=t.shareRecentItem=void 0,n=i.__importStar(n),t.shareRecentItem=function(e,t,n,o){return i.__awaiter(this,void 0,void 0,(function*(){e.federatedRecentItem?(0,a.shareItem)(e.federatedRecentItem,n):yield(yield(0,s.waitForHomeTTI)()).shareFile(t[0].id,n,o)}))},t.previewRecentItem=function(e,t,n,{isMetaClick:o,href:l,middleClick:c}){if((0,r.isSupportedLinkNodeClickAction)(e.perNodeMetadata))(0,s.waitForHomeTTI)().then(({handleLinkNodeAction:t})=>i.__awaiter(this,void 0,void 0,(function*(){t(e.perNodeMetadata,t=>{(0,u.logProductAnalytics)(e.viewingUserId,"web","select",t,"recents")})})));else if(e.federatedRecentItem)(0,a.previewItem)(e.federatedRecentItem,n);else if(1===e.attachmentIds.length)(0,s.waitForHomeTTI)().then(({previewFileSyncRecentItem:i})=>i(e,!!o,t,n,l,c));else{const{index:i,shouldUseEntityUri:n}=t;(0,m.reportStack)("To preview, file sync items must have 1 attachment id",{severity:m.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e,index:i,shouldUseEntityUri:n}})}},t.deleteRecentItem=function(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){(0,s.waitForHomeTTIWithProps)().then(({imports:o,props:a})=>{o.deleteRecentItem(e,t,n,a),(function(e){if(!(0,r.isPreSetupLinkNode)(e.perNodeMetadata))return;(0,s.waitForHomeTTI)().then(({getLinkNodeEventObject:t})=>i.__awaiter(this,void 0,void 0,(function*(){const i=t(e.perNodeMetadata);i&&(0,u.logProductAnalytics)(e.viewingUserId,"web","delete",i,"recents")})))})(e)})}))},t.archiveRecentItem=function(e,t){e.federatedRecentItem?(0,a.promptAndArchiveItem)(e.federatedRecentItem,e.viewingUserId,t):(0,m.reportStack)("Archiving is not supported",{severity:m.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e}})},t.loadNextPage=function(){const e=(0,d.getRecentActivityStore)().getFileSyncCursor();return e&&(0,s.waitForHomeTTI)().then(({loadRecentItems:t})=>t(e)),!!e},t.hasCursor=function(){return!!(0,d.getRecentActivityStore)().getFileSyncCursor()},t.openFile=function(e,t,o=n.noop){return i.__awaiter(this,void 0,void 0,(function*(){yield(yield(0,s.waitForHomeTTI)()).openFile(e,t),o()}))},t.downloadFiles=function(e,t){return i.__awaiter(this,void 0,void 0,(function*(){(yield(0,s.waitForHomeTTI)()).downloadFiles(e,t)}))},t.openVersions=function(e,t){return i.__awaiter(this,void 0,void 0,(function*(){(yield(0,s.waitForHomeTTI)()).openVersions(o.NavigationMethod.REDIRECT,e,t)}))},t.refreshRecentItems=function(){return i.__awaiter(this,void 0,void 0,(function*(){if((0,d.getRecentActivityStore)().didReceiveItemsFromAllStreams()){c.recentActivityDispatcher.dispatch({type:l.REFRESH_RECENT_ACTIVITIES});const{loadRecentItems:e,loadPaperRecentItems:t}=yield(0,s.waitForHomeTTI)();yield Promise.all([e(),t(!1)])}}))}})),define("metaserver/static/js/home/recents/components/pending_attachment_list_view",["require","exports","tslib","react"],(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PendingAttachmentListView=void 0,n=i.__importDefault(n);class o extends n.default.Component{render(){const{count:e}=this.props;return n.default.createElement("ul",{className:"recents-item__attachments"},new Array(Math.min(e,4)).fill(null).map((e,t)=>n.default.createElement("li",{className:"recents-item__attachment-item",key:t})))}}t.PendingAttachmentListView=o,o.displayName="PendingAttachmentListView"})),define("metaserver/static/js/home/recents/components/recent_activity_container",["require","exports","tslib","classnames","react","react-dom","dig-components/progress_indicators","metaserver/static/js/home/actions","metaserver/static/js/home/constants","metaserver/static/js/home/post_tti/api","metaserver/static/js/home/recents/actions/recent_activity_actions","metaserver/static/js/home/recents/components/recent_activity_item_container","metaserver/static/js/home/recents/stores/recent_activity_store","metaserver/static/js/components/ui/section/section_header","metaserver/static/js/home/store","metaserver/static/js/components/ui/section/section_empty_text","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/home/util/logging/timing_component","metaserver/static/js/home/util/logging/timing_logger","metaserver/static/js/home/util/show_hide_link","metaserver/static/js/core/i18n","spectrum/media_table_skeleton/index","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/home/util/conditional_api","metaserver/static/js/home/recents/components/recents_files_table","metaserver/static/js/starred/redux/slice","metaserver/static/js/starred/redux/store"],(function(e,t,i,n,o,r,s,a,l,c,d,u,m,g,h,p,_,f,v,S,E,I,T,R,y,A,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecentActivityContainerInSearchEmptyState=t.RecentActivityContainer=t.RecentActivityContainerInner=void 0,n=i.__importDefault(n),o=i.__importDefault(o),r=i.__importDefault(r);class b extends o.default.PureComponent{constructor(e){super(e),this.onShouldLoadMore=()=>{const e=(0,m.getRecentActivityStore)();if(!this.state.isPending&&this.state.showAll&&!e.didTruncateRecentItems()&&e.didReceiveItemsFromAllStreams()){const{items:t}=e.getRecentItems();t.length>this.state.items.length?this.setState({items:t}):(0,d.loadNextPage)()&&this.setState({isPending:!0})}},this.onChangeRecentsVisibility=()=>{const e=!this.props.isHiddenByUser;a.HomeActions.setSectionVisibility((0,h.getUserId)(),{".tag":"recents"},!e),_.homeActivityLogger.logShowHideSection(l.HomeSections.RECENTS,e)},this.handleVisibilityChange=()=>{"visible"===document.visibilityState&&((0,d.refreshRecentItems)(),this.fetchStarred())},this.onStoreUpdate=()=>{this.setState(this.getStateFromStore()),this.fetchStarred()},this.onShowAll=()=>{this.setState({showAll:!0});const e=r.default.findDOMNode(this.refs.lastUnhiddenActivity);if(e){const t=e.querySelector("a");t&&t.focus()}},this.removeStoreListeners=(0,m.getRecentActivityStore)(this.props.skipPrefetch).addListener(this.onStoreUpdate),this.state=Object.assign(Object.assign({},this.getStateFromStore()),{isUnityAvailable:!1,showAll:!!e.showAll})}componentDidMount(){this.props.isHiddenByUser&&v.homeTimingLogger.logSkippedSection(l.HomeSections.RECENTS),(0,c.waitForHomeTTI)().then(e=>i.__awaiter(this,void 0,void 0,(function*(){e.recentActivityContainerComponentDidMount(this.onShouldLoadMore),(yield e.getUnityFeatures())&&this.setState({isUnityAvailable:!0})}))),!this.state.items.length&&(0,m.getRecentActivityStore)().didReceiveItemsFromAllStreams()&&this.setState({isPending:!1}),(0,d.refreshRecentItems)(),this.fetchStarred(),document.addEventListener("visibilitychange",this.handleVisibilityChange,!1)}componentWillUnmount(){document.removeEventListener("visibilitychange",this.handleVisibilityChange),this.removeStoreListeners()}fetchStarred(){if("ON"===T.RECENTS_TABLE_REDESIGN){const e=(0,C.getStoreForStarred)();return e.dispatch((0,A.fetchMissingStarredStatuses)(this.state.items.filter(({resourceId:e,idType:t})=>e&&t).filter(e=>!w(e)).map(({resourceId:e,idType:t})=>({id:e,type:t})))),void this.state.items.filter(w).forEach(t=>{const{resource_id:i,isFavorite:n}=t.federatedRecentItem.paperRecentItem;e.dispatch(A.StarredActions.setStarredStatus({id:i,isStarred:n}))})}(0,R.waitForStarred)(({getStoreForStarred:e,fetchMissingStarredStatuses:t,StarredActions:i})=>{const n=e();n.dispatch(t(this.state.items.filter(({resourceId:e,idType:t})=>e&&t).filter(e=>!w(e)).map(({resourceId:e,idType:t})=>({id:e,type:t})))),this.state.items.filter(w).forEach(e=>{const{resource_id:t,isFavorite:o}=e.federatedRecentItem.paperRecentItem;n.dispatch(i.setStarredStatus({id:t,isStarred:o}))})})}getStateFromStore(){const e=(0,m.getRecentActivityStore)(),t=!e.didReceiveItemsFromAllStreams(),{items:i}=e.getRecentItems();if(!t&&!this.props.skipPrefetch){if(v.homeTimingLogger.logTTData(l.HomeSections.RECENTS)){const e=i.length;e&&_.homeActivityLogger.logRecentsShown(e,!(0,h.getHomeStore)().getSectionVisibility()[l.HomeSections.RECENTS])}}return{isPending:t,items:i}}renderLoadingView(){const{showSkeletonWhenLoading:e}=this.props;return o.default.createElement("div",{className:"recents-loading-view",key:"loading"},e?o.default.createElement(I.MediaTableSkeletonRow,null):o.default.createElement(s.Spinner,{size:"small","aria-valuetext":E.intl.formatMessage({id:"k2bVak",defaultMessage:"Loading your recent items"})}))}renderItems(){const{now:e,fullItemView:t,loggedComponentName:i,asyncRenderStar:n}=this.props,{items:r,showAll:s,isUnityAvailable:a}=this.state,l={isUnityAvailable:a,now:e,user:(0,h.getUser)()},c=t?10:5,d=s?r:r.slice(0,c);return"ON"===T.RECENTS_TABLE_REDESIGN?o.default.createElement(y.RecentsFilesTable,{renderingInfo:l,items:d,addSelectedRow:this.props.addSelectedRow,removeSelectedRow:this.props.removeSelectedRow,hasRowSelection:this.props.hasRowSelection,hasStarring:this.props.hasStarring}):o.default.createElement("ul",null,d.map((e,r)=>o.default.createElement(u.RecentActivityItemContainer,{key:e.id,recentItem:e,renderingInfo:l,fullItemView:t,ref:9===r?"lastUnhiddenActivity":void 0,loggedComponentName:i,asyncRenderStar:n})))}renderShowMoreLink(){const{items:e,showAll:t}=this.state,i=Math.max(e.length-10,0);return this.props.fullItemView?t||!(0,d.hasCursor)()&&i<=0?null:o.default.createElement(S.ShowHideLink,{key:"show_more",onClick:this.onShowAll,isExpanded:!1,hiddenItemCount:i,canLoadMore:!0}):null}renderContent(){const{isPending:e,items:t}=this.state;return t.length?[this.renderItems(),this.renderShowMoreLink(),e&&this.renderLoadingView()]:e?this.renderLoadingView():o.default.createElement(p.SectionEmptyText,{message:E.intl.formatMessage({id:"hFDfoh",defaultMessage:"Items you recently viewed show up here."}),learnMoreLink:"/help/desktop-web/recents-overview"})}render(){const{canRenderItems:e,isHiddenByUser:t,showHeader:i,className:r}=this.props;if(!e)return null;const{isPending:s,items:a}=this.state,l=(0,n.default)({"home-recents-section__container":!0,"recents-view":!0,"recents-view--is-pending":s&&0===a.length}),c=(0,n.default)("home-access-section home-recents-section",r);return o.default.createElement("section",{className:c},i?o.default.createElement(g.SectionHeader,{title:E.intl.formatMessage({id:"hApMtp",defaultMessage:"Recent"}),ueName:"recents",isHidden:t,onToggleHidden:this.onChangeRecentsVisibility,ariaControls:"RecentActivityContainerInner"}):null,o.default.createElement("div",{className:"home-access-section__content",id:"RecentActivityContainerInner"},!t&&o.default.createElement("div",{className:l},this.renderContent())))}}t.RecentActivityContainerInner=b,b.displayName="RecentActivityContainer";const w=e=>{var t;return void 0!==(null===(t=null==e?void 0:e.federatedRecentItem)||void 0===t?void 0:t.paperRecentItem)};t.RecentActivityContainer=(0,f.timingComponent)(b,l.HomeSections.RECENTS),t.RecentActivityContainerInSearchEmptyState=b})),define("metaserver/static/js/home/recents/components/recent_activity_item_actions_view",["require","exports","tslib","react","classnames","lodash","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","metaserver/static/js/core/i18n"],(function(e,t,i,n,o,r,s,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecentActivityItemActionsView=void 0,n=i.__importDefault(n),o=i.__importDefault(o);const u=e=>{e.stopPropagation(),e.preventDefault()},m=(e,t)=>{u(t),e(t)},g=e=>t=>t.permissions[e],h=[{name:"handleDownload",label:d.intl.formatMessage({id:"iFX+XI",defaultMessage:"Download"}),shouldRender:g("download")},{name:"handleComment",label:d.intl.formatMessage({id:"tJzlWE",defaultMessage:"Comment"}),shouldRender:g("comment")},{name:"handleDelete",label:d.intl.formatMessage({id:"NQS3dU",defaultMessage:"Delete all…"}),shouldRender:e=>e.permissions.delete&&e.attachmentCount>1},{name:"handleDelete",label:d.intl.formatMessage({id:"Ieup/u",defaultMessage:"Delete…"}),shouldRender:e=>e.permissions.delete&&e.attachmentCount<=1},{name:"handleArchive",label:d.intl.formatMessage({id:"CvAVX3",defaultMessage:"Archive"}),shouldRender:g("archive")},{name:"handleVersions",label:d.intl.formatMessage({id:"jId+M1",defaultMessage:"Version history"}),shouldRender:g("versions")},{name:"handleViewInFolder",label:d.intl.formatMessage({id:"3Dgw+C",defaultMessage:"View in folder"}),shouldRender:g("viewInFolder")}];t.RecentActivityItemActionsView=e=>{if(e.disableActions)return null;const t=h.filter(t=>t.shouldRender(e)),i=(0,r.uniqueId)("recents-item__unportaled-menu-button-");return t.length?n.default.createElement(c.Menu.Wrapper,{className:"recents-item__unportaled-menu",onSelection:m,isPortaled:!1},({getContentProps:m,getTriggerProps:g})=>n.default.createElement(n.default.Fragment,null,n.default.createElement(s.IconButton,Object.assign({id:i,variant:"transparent"},g({onClick:u}),{"aria-label":d.intl.formatMessage({id:"mnOOD/",defaultMessage:"More actions"}),"aria-labelledby":(0,o.default)(i,e.arialabelledby)}),n.default.createElement(a.UIIcon,{src:l.MoreHorizontalLine})),n.default.createElement(c.Menu.Content,Object.assign({},m({onClick:u}),{placement:"bottom-end"}),n.default.createElement(c.Menu.Segment,null,t.map(({name:t,label:i})=>{const s=(0,r.uniqueId)("recents-item__action-item-");return n.default.createElement(c.Menu.ActionItem,{id:s,key:t,value:e.handler[t],"aria-labelledby":(0,o.default)(s,e.arialabelledby)},i)}))))):null},t.RecentActivityItemActionsView.displayName="RecentActivityItemActionsView"})),define("metaserver/static/js/home/recents/components/recent_activity_item_container",["require","exports","tslib","lodash","react","metaserver/static/js/core/assert","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/actions/recent_activity_actions","metaserver/static/js/home/recents/components/recent_activity_item_view","metaserver/static/js/home/recents/utils/events","metaserver/static/js/home/recents/stores/attachment_store","metaserver/static/js/home/post_tti/api"],(function(e,t,i,n,o,r,s,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecentActivityItemContainer=void 0,n=i.__importStar(n),o=i.__importDefault(o);class m extends o.default.PureComponent{constructor(e){super(e),this.onAttachmentStoreChange=()=>{this.setState({attachments:(0,d.getAttachmentStore)().getByIds(this.getRecentItem().attachmentIds)})},this.handleArchive=()=>(0,a.archiveRecentItem)(this.getRecentItem(),this.getLogData()),this.handleComment=()=>{const e=this.getSingleAttachment("handleComment only supports a single attachment"),t=Math.max(0,this.state.attachments.indexOf(e));this.previewOrOpenFiles({index:t,isCommentAction:!0},{isMetaClick:!1,href:void 0,middleClick:!1})},this.handleDelete=()=>{(0,a.deleteRecentItem)(this.getRecentItem(),this.state.attachments,this.getLogData())},this.handleDownload=()=>{const e=this.getSingleAttachment("handleDownload only supports a single attachment");(0,a.downloadFiles)([e.id],this.getLogData())},this.handleHeaderClick=()=>{const{isCollapsed:e,attachments:t}=this.state,i=e?s.ActionType.UNCOLLAPSE:s.ActionType.COLLAPSE;(0,c.logEvent)(i,this,this.state.attachments,t.length),this.setState({isCollapsed:!e})},this.handleOpen=()=>{const e=this.getSingleAttachment("handleOpen only supports a single attachment");(0,a.openFile)(e.id,this.getLogData())},this.handlePathClick=e=>{const t=this.getAttachmentFqPaths(),{recentItem:i}=this.props,{attachmentIds:n,viewingUserId:o}=i;(0,u.waitForHomeTTI)().then(({logOpenPathUrl:i,openUrl:r})=>{i(o,t,n.length,this.getLogData()),r(e,s.ActionType.OPEN_PATH,n,this.getLogData())})},this.handleViewInFolder=()=>{const e=this.getAttachmentFqPaths(),{recentItem:t}=this.props,{attachmentIds:i,viewingUserId:o}=t;(0,u.waitForHomeTTI)().then(({logViewInFolder:r,openUrl:a})=>{r(o,e,i.length,this.getLogData()),a(n.last(t.paths).url,s.ActionType.VIEW_IN_FOLDER,i,this.getLogData())})},this.handlePreview=e=>{this.previewOrOpenFiles({},e)},this.handleShare=()=>{(0,a.shareRecentItem)(this.getRecentItem(),this.state.attachments,this.getLogData(),!1)},this.handleVersions=()=>{const e=this.getSingleAttachment("handleVersions only supports a single attachment");(0,a.openVersions)(e.id,this.getLogData())},this.removeStoreListeners=null,this.state={attachments:[],isCollapsed:!0}}getRecentItem(){return this.props.recentItem}getLogData(){return{totalCount:this.props.recentItem.attachmentIds.length,cellView:this,loggedComponentName:this.props.loggedComponentName}}getAttachmentFqPaths(){return n.compact(n.map(this.state.attachments,"fqPath"))}getSingleAttachment(e){return e&&(0,r.assert)(1===this.state.attachments.length,e),this.state.attachments[0]}previewOrOpenFiles(e,t){const{recentItem:i}=this.props;(0,a.previewRecentItem)(i,Object.assign({},e),this.getLogData(),t)}UNSAFE_componentWillMount(){this.removeStoreListeners=(0,d.getAttachmentStore)().addListener(this.onAttachmentStoreChange),this.onAttachmentStoreChange()}componentWillUnmount(){this.removeStoreListeners&&this.removeStoreListeners()}render(){return o.default.createElement(l.RecentActivityItemView,{recentItem:this.getRecentItem(),attachments:this.state.attachments,handler:this,isCollapsed:this.state.isCollapsed,renderingInfo:this.props.renderingInfo,showExpand:this.props.fullItemView,showStar:this.props.fullItemView,showLastAccess:this.props.fullItemView,showActions:this.props.fullItemView,asyncRenderStar:this.props.asyncRenderStar})}}t.RecentActivityItemContainer=m,m.displayName="RecentActivityItemContainer"})),define("metaserver/static/js/home/recents/components/recent_activity_item_view",["require","exports","tslib","classnames","lodash","react","react-redux","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/tooltips","dig-components/typography","metaserver/static/js/clean/browse_uri_interface","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/common/rendering","metaserver/static/js/datetime/datetime","metaserver/static/js/clean/em_string","metaserver/static/js/filepath/filepath","metaserver/static/js/display_types/constants","metaserver/static/js/home/recents/actions/recent_activity_action_permissions","metaserver/static/js/home/recents/components/pending_attachment_list_view","metaserver/static/js/home/recents/components/recent_activity_item_actions_view","metaserver/static/js/home/recents/models/utils","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_text_helper","metaserver/static/js/home/util/conditional_api","metaserver/static/js/home/util/post_tti_components","metaserver/static/js/home/util/resource_icon","metaserver/static/js/starred/constants","metaserver/static/js/common/uuid","metaserver/static/js/core/exception","metaserver/static/js/core/i18n"],(function(e,t,i,n,o,r,s,a,l,c,d,u,m,g,h,p,_,f,v,S,E,I,T,R,y,A,C,b,w,P,D,F){"use strict";function L(e){return(0===e.button||1===e.button)&&!(function(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.RecentActivityItemView=void 0,n=i.__importDefault(n),r=i.__importDefault(r),y=i.__importStar(y);class N extends r.default.Component{constructor(e){super(e),this.onShare=e=>{e.preventDefault(),e.stopPropagation(),this.props.handler.handleShare()},this.handleTitleClick=e=>{e.stopPropagation(),L(e)&&(e.preventDefault(),this.props.handler.handlePreview({isMetaClick:e.metaKey,href:e.currentTarget.href,middleClick:1===e.button}))},this.getRowClickHandler=e=>t=>{t.stopPropagation(),t.preventDefault(),this.isAggregation()?this.props.handler.handleHeaderClick():this.props.handler.handlePreview({isMetaClick:t.metaKey,href:e,middleClick:1===t.button})},this.handleParentClick=e=>{e.stopPropagation(),L(e)&&(e.preventDefault(),this.props.handler.handlePathClick(this.getParentPathComponent().url))},this.state={recentsItemID:(0,P.generateUUID)("recents-item-")}}shouldDisableActions(){const{federatedRecentItem:e}=this.props.recentItem;return e?!e.hasMenuActions():!this.hasLoadedAttachments()}isAggregation(){return this.props.recentItem.attachmentIds.length>1}shouldShowThumbnails(){const{recentItem:e}=this.props;return(0,T.isMountedRecentItem)(e)&&(0,T.shouldShowThumbnailsForRecentItem)(e)}getLoadedAttachmentsCount(){return this.props.attachments.filter(e=>e.isLoaded).length}canRenderAttachmentView(){const e=this.getLoadedAttachmentsCount();return e===this.props.recentItem.attachmentIds.length||e>=R.MAX_INITIAL_THUMBNAIL_ATTACHMENTS}hasLoadedAttachments(){return!(!this.props.attachments.length||!this.getLoadedAttachmentsCount())}getHeading(){const{attachments:e,recentItem:t}=this.props;if(e.length<2){const e=t.displayName||"";return _.Emstring.em_snippet(e,30)}{const i=t.attachmentIds.length,n=t.uniqueFilterTypes,o=[];for(const t of e)t.isLoaded&&t.displayName&&o.push(t.displayName);switch(n.length){case 1:switch(n[0]){case R.RECENT_EVENT_FILTER_TYPE.PHOTOS:return F.intl.formatMessage({id:"HxTR1s",defaultMessage:"{count, plural, one{{count} image} other{{count} images}}"},{count:i});case R.RECENT_EVENT_FILTER_TYPE.VIDEOS:return F.intl.formatMessage({id:"fmi87t",defaultMessage:"{count, plural, one{{count} video} other{{count} videos}}"},{count:i});case R.RECENT_EVENT_FILTER_TYPE.VISUAL_NOTES:return F.intl.formatMessage({id:"vZtJe2",defaultMessage:"{count, plural, one{{count} visual note} other{{count} visual notes}}"},{count:i})}break;case 2:if(n.indexOf(R.RECENT_EVENT_FILTER_TYPE.PHOTOS)>=0&&n.indexOf(R.RECENT_EVENT_FILTER_TYPE.VIDEOS)>=0)return F.intl.formatMessage({id:"E1nUJ4",defaultMessage:"{count} images and videos"},{count:i})}return o.length?y.snippetList(o,30,{totalCount:i}):F.intl.formatMessage({id:"IGlwYu",defaultMessage:"{count, plural, one{{count} file} other{{count} files}}"},{count:i})}}getParentPathComponent(){const{recentItem:e}=this.props,{type:t,paths:i}=e;if(!(0,T.isMountedRecentItem)(e))return t===R.RECENT_EVENT_TYPES.FILE_SHARED_ADD?{name:F.intl.formatMessage({id:"guiO/P",defaultMessage:"Your links"}),url:"/share/links"}:null;if(i.length){const e=(0,o.last)(i);if(e.url)return e}return null}renderStar(){const{attachments:e,recentItem:t,renderingInfo:i,asyncRenderStar:n}=this.props,{recentsItemID:o}=this.state,a=Boolean(e.length>0&&e[0].isDir);return n?r.default.createElement(O,{isDir:a,recentItem:t,recentsItemID:o,renderingInfo:i}):(0,A.waitForStarred)(e=>{const{Star:n,getIdTypePairFromRecentItem:l,getStoreForStarred:c}=e,d=l(t);return d?r.default.createElement(s.Provider,{store:c()},r.default.createElement(n,{id:d.id,idType:d.type,isDir:a,itemName:t.displayName||void 0,user:i.user,source:w.StarredSource.HOME_RECENTS,ariaLabelledBy:o})):null},!1)}componentDidMount(){this.shouldShowThumbnails()||this.isAggregation()&&(0,D.reportStack)("Tried to render non-photo aggregation but failed",{severity:D.SEVERITY.NONCRITICAL,exc_extra:{isMounted:this.props.recentItem.isMounted,hasSCL:!!this.props.recentItem.scl,attachment_lenth:this.props.attachments.length}})}render(){const{recentItem:e,attachments:t,handler:i,renderingInfo:s,isCollapsed:g,showExpand:h,showStar:_,showLastAccess:R,showActions:y}=this.props,{displayType:A,federatedRecentItem:w,fqPath:P,scl:D}=e,L=this.getParentPathComponent(),N=new Date(e.when),M=(0,S.getRecentActivityItemViewPermissions)(e,t),O=(0,T.isMountedRecentItem)(e),j=M.share&&(w?w.isShareable():this.hasLoadedAttachments()),x=this.isAggregation()?void 0:O?P?(0,m.preview_uri_for_fq_path)(s.user,P).toString():void 0:D,H=(0,n.default)({"recents-item":!0,"recents-item--loaded":this.hasLoadedAttachments()}),V=(0,o.uniqueId)("recents-item__action-share-");return r.default.createElement("li",{"data-item-id":e.id,"data-item-type":e.type,"data-item-date":e.when,className:H,onClick:this.getRowClickHandler(x),onAuxClick:this.getRowClickHandler(x)},r.default.createElement("div",{className:"recents-item-header"},h&&r.default.createElement("div",{className:"recents-item-header__chevron"},this.isAggregation()&&r.default.createElement(a.IconButton,{onClick:this.props.handler.handleHeaderClick,variant:"transparent",className:"recents-item-header__chevron-button","aria-label":g?F.intl.formatMessage({id:"5loFC4",defaultMessage:"Expand"}):F.intl.formatMessage({id:"cwEFpr",defaultMessage:"Collapse"})},r.default.createElement(l.UIIcon,{src:g?c.ChevronRightLine:c.ChevronDownLine,size:"small"}))),r.default.createElement("div",{className:"recents-item-header__icon"},r.default.createElement(b.HomeResourceIcon,{displayType:A||v.DisplayTypes.FILE,fileName:e.displayName||"",shortcutUrlForIcon:e.fqPath&&"web"===(0,f.file_extension)(e.fqPath)&&e.scl||void 0,icon:e.icon||void 0})),r.default.createElement("div",{className:`recents-item-header__content ${R?"":"recents-item-header-search_empty_state"}`},r.default.createElement("div",{className:"recents-item-header__title"},x?r.default.createElement(u.Link,{variant:"monochromatic",hasNoUnderline:!0,className:"recents-item-header__title-text",href:x,onClick:this.handleTitleClick,onAuxClick:this.handleTitleClick,id:this.state.recentsItemID},this.getHeading()):r.default.createElement(u.Text,{className:"recents-item-header__title-text"},this.getHeading()),_&&this.renderStar()),r.default.createElement(u.Text,{size:R?"small":void 0,color:"faint",className:"recents-item-header__subtitle"},R?`${(0,T.getActionTypeLocalizedString)(e)} `:"",R&&r.default.createElement(d.Tooltip,{placement:"top",title:(0,p.format_date)(N,"MMM d, yyyy "+p.localized_time_format)},r.default.createElement("span",null,(0,p.agoFromDate)(N,s.now,!1))),L?R?" · ":" • ":"",L&&r.default.createElement(u.Link,{href:L.url,onClick:this.handleParentClick,variant:"monochromatic",hasNoUnderline:!0},L.name))),y&&r.default.createElement("div",{className:"recents-item__actions"},j&&r.default.createElement("div",{className:"recents-item__action recents-item__action--hover-only recents-item__action--standard-breakpoint-only"},r.default.createElement(a.Button,{id:V,onClick:this.onShare,variant:"opacity","aria-labelledby":(0,n.default)(V,this.state.recentsItemID)},F.intl.formatMessage({id:"2ZK3bH",defaultMessage:"Share"}))),r.default.createElement(C.PostTTIRecentsActivityFileActions,{recentItem:this.props.recentItem,attachments:this.props.attachments,arialabelledby:this.state.recentsItemID}),r.default.createElement(I.RecentActivityItemActionsView,{handler:i,isMountedItem:O,permissions:M,attachmentCount:e.attachmentIds.length,disableActions:this.shouldDisableActions(),renderingInfo:s,arialabelledby:this.state.recentsItemID}))),this.shouldShowThumbnails()&&!this.props.isCollapsed&&(this.canRenderAttachmentView()?r.default.createElement(C.PostTTIRecentActivityImageAttachments,{attachments:t}):r.default.createElement(E.PendingAttachmentListView,{count:e.attachmentIds.length})))}}t.RecentActivityItemView=N,N.displayName="RecentActivityItemView";const M=r.default.lazy(()=>i.__awaiter(void 0,void 0,void 0,(function*(){yield(0,g.waitForTTI)();const t=yield new Promise((t,i)=>{e(["metaserver/static/js/home/starred/conditional_interface"],t,i)}).then(i.__importStar);return{default:e=>{const{Star:i,getIdTypePairFromRecentItem:n,getStoreForStarred:o}=t,a=n(e.recentItem);return a?r.default.createElement(s.Provider,{store:o()},r.default.createElement(i,{id:a.id,idType:a.type,isDir:e.isDir,itemName:e.recentItem.displayName||void 0,user:e.renderingInfo.user,source:w.StarredSource.HOME_RECENTS,ariaLabelledBy:e.recentsItemID})):null}}}))),O=e=>r.default.createElement(h.LazySuspense,{fallback:null},r.default.createElement(M,Object.assign({},e)))})),define("metaserver/static/js/home/recents/models/attachment",["require","exports","metaserver/static/js/core/exception"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPartialAttachmentsFromRecentActivity=t.convertFileActivityToAttachmentItem=void 0,t.convertFileActivityToAttachmentItem=function(e){const t=e.preview_jsinfo||null;let n=null,o=null;if(t&&(t.thumbnail_url_tmpl&&(n=t.thumbnail_url_tmpl),t.thumbnail_dimensions)){const[e,i]=t.thumbnail_dimensions;o={height:i,width:e}}const r=e.comment||{},s=r.commenter_dict||{};return r.raw_comment_text&&(0,i.reportStack)("Received a comment attachment",{severity:i.SEVERITY.NONCRITICAL,exc_extra:{activity:e}}),{id:e.activity_key,isLoaded:!0,viewingUserId:e.viewing_user.id,displayName:e.name||null,displayType:e.activity_data&&e.activity_data.home_display_type||null,previewInfo:e.preview_jsinfo||null,fqPath:e.fq_path||null,nsPath:e.ns_path||null,nsId:e.ns_id||null,thumbnailUrl:n||null,thumbnailDimensions:o||null,canOpen:!1,inRootCollection:!1,isReadOnly:!!e.is_read_only,isDir:!!e.is_dir,isCloudDoc:!!e.is_cloud_doc,isVersionable:!!e.is_versionable,perNodeMetadata:e.per_node_metadata||null,commentRawText:r.raw_comment_text||null,commenterId:s.id||null,commenterDisplayName:s.display_name||null,commenterPhotoUrl:s.photo_circle_url||null}},t.createPartialAttachmentsFromRecentActivity=function(e){return(e.related_activity_keys||[]).map(t=>({id:t,viewingUserId:e.viewing_user.id,displayName:null,displayType:null,isLoaded:!1,canOpen:!1,inRootCollection:!1,isReadOnly:!1,isDir:!1,isCloudDoc:!1,isVersionable:!1,perNodeMetadata:null,previewInfo:null,fqPath:null,nsPath:null,nsId:null,thumbnailUrl:null,thumbnailDimensions:null,commentRawText:null,commenterId:null,commenterDisplayName:null,commenterPhotoUrl:null}))}})),define("metaserver/static/js/home/recents/models/federated_recent_item",["require","exports","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_federated_model"],(function(e,t,i,n){"use strict";function o(e){switch(e.action||i.PaperRecentItemAction.OPENED){case i.PaperRecentItemAction.CREATED:return i.RECENT_EVENT_TYPES.PAPER_ADD;case i.PaperRecentItemAction.EDITED:return i.RECENT_EVENT_TYPES.PAPER_EDIT;default:return i.RECENT_EVENT_TYPES.PAPER_VIEW}}Object.defineProperty(t,"__esModule",{value:!0}),t.createRecentItemFromPaperRecentItem=void 0,t.createRecentItemFromPaperRecentItem=function(e,t,r){const s=new n.FederatedRecentItem(e),a=s.getActivityKey();return{federatedRecentItem:s,id:a,idType:e.id_type,resourceId:e.resource_id,type:o(e),icon:s.getIcon(),displayType:e.display_type,when:e.time,viewingUserId:t.id,displayName:e.name,accountDisplayName:t.display_name,contextDisplayName:s.getFolderPath()||t.display_name,attachmentIds:[a],paths:e.path,order:r,uniqueFilterTypes:[i.RECENT_EVENT_FILTER_TYPE.DOCUMENTS]}}})),define("metaserver/static/js/home/recents/models/recent_item",["require","exports","tslib","lodash","metaserver/static/js/home/recents/actions/error_actions","metaserver/static/js/home/recents/models/utils"],(function(e,t,i,n,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertRecentActivityToRecentItem=void 0,n=i.__importStar(n);let s=0;const a=n.memoize(e=>s+=1);t.convertRecentActivityToRecentItem=function(e){try{const t=e.skeleton_data;return{id:e.activity_key,type:e.recent_event_type||null,icon:e.icon||t&&t.icon||null,displayType:e.activity_data&&e.activity_data.home_display_type||null,when:e.when_milli||null,viewingUserId:e.viewing_user.id,displayName:t&&t.display_name||null,accountDisplayName:t&&t.account_display_name||null,contextDisplayName:t&&t.context_display_name||null,uniqueFilterTypes:t?n.uniq(n.values(t.filter_types_by_key)):[],attachmentIds:e.related_activity_keys||[],paths:(0,r.getPathsByFqPath)(t&&t.context_display_path||"",e.viewing_user.id,!0),order:a(e.activity_key),idType:e.id_type,resourceId:e.resource_id,scl:e.scl,isMounted:e.is_mounted,perNodeMetadata:e.per_node_metadata}}catch(t){return n.defer(()=>o.errorActions.recentActivityParseError(e.activity_key,t)),null}}})),define("metaserver/static/js/home/recents/models/utils",["require","exports","tslib","lodash","metaserver/static/js/clean/browse_uri_interface","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/clean/viewer"],(function(e,t,i,n,o,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActionTypeLocalizedString=t.getRecentItemActionType=t.getExtension=t.compareRecentItems=t.getPathsByFqPath=t.isMountedRecentItem=t.extractAttachmentIds=t.shouldShowThumbnailsForRecentItem=t.shouldShowThumbnailsForSkeletonData=void 0,n=i.__importStar(n);const{PHOTOS:a,VIDEOS:l,VISUAL_NOTES:c}=r.RECENT_EVENT_FILTER_TYPE,d=[a,l,c];function u(e,t){return!!(e>1&&t.every(e=>d.indexOf(e)>=0))}function m(e){switch(e.type){case r.RECENT_EVENT_TYPES.FILE_PRIVATE_VIEW:case r.RECENT_EVENT_TYPES.FILE_SHARED_VIEW:case r.RECENT_EVENT_TYPES.PAPER_VIEW:return r.RecentItemActionType.OPENED;case r.RECENT_EVENT_TYPES.FILE_EDIT:case r.RECENT_EVENT_TYPES.PAPER_EDIT:return r.RecentItemActionType.EDITED;default:return r.RecentItemActionType.ADDED}}t.shouldShowThumbnailsForSkeletonData=function(e){const t=n.values(e.filter_types_by_key);return u(t.length,n.uniq(t))},t.shouldShowThumbnailsForRecentItem=function(e){return u(e.attachmentIds.length,e.uniqueFilterTypes)},t.extractAttachmentIds=function(e){return n.map(e,"id")},t.isMountedRecentItem=function(e){return!1!==e.isMounted},t.getPathsByFqPath=function(e,t,i=!1){const r=s.Viewer.get_viewer().get_user_by_id(t);"/"===e&&(e="");const a=[],l=e.split("/");for(i||l.pop();l.length;){let e=n.last(l),t=l.join("/");1===l.length&&""===e&&(e=s.Viewer.get_root_name(r),t="");const i=(0,o.browse_uri_for_fq_path)(r,t).toString();a.push({name:e||"",url:i}),l.pop()}return a.reverse()},t.compareRecentItems=function(e,t){return t.when-e.when||e.order-t.order||t.type-e.type},t.getExtension=function(e){const t=e.split(".");return t.length<2?"":"."+t.slice(-1)[0].replace(/\n$/,"").toLowerCase()},t.getRecentItemActionType=m;const g={[r.RecentItemActionType.OPENED]:r.I18N.OPENED,[r.RecentItemActionType.EDITED]:r.I18N.EDITED,[r.RecentItemActionType.ADDED]:r.I18N.ADDED};t.getActionTypeLocalizedString=function(e){return g[m(e)]}})),define("metaserver/static/js/home/recents/recent_activity_client_utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPaperRecentItem=t.isSFJRecentItem=t.getPayload=void 0,t.getPayload=function(e){if("ok"===e.status)return e.payload;throw new Error(`Payload not okay: ${JSON.stringify(e)}`)};t.isSFJRecentItem=e=>void 0!==e.activity_key;t.isPaperRecentItem=e=>void 0!==e.time})),define("metaserver/static/js/home/recents/recent_activity_constants",["require","exports","tslib","metaserver/static/js/modules/constants/python","metaserver/static/js/core/i18n"],(function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnsureAttachmentsPurpose=t.ActionScope=t.ActionType=t.I18N=t.RecentItemActionType=t.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS=t.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_POST_TTI=t.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_PRE_TTI=t.PaperRecentItemTypes=t.PaperRecentItemAction=t.SHOW_MORE_THUMBNAIL_ROW_INCREMENT=t.MAX_INITIAL_THUMBNAIL_ATTACHMENTS=t.SHOW_MORE_DOC_ATTACHMENT_INCREMENT=t.MAX_INITIAL_DOC_ATTACHMENTS=t.REMOVE_PENDING_ACTIVITY_KEYS=t.ADD_PENDING_ACTIVITY_KEYS=t.REFRESH_RECENT_ACTIVITIES=t.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY=t.RECEIVE_RAW_RECENT_ACTIVITIES=t.RECEIVE_PAPER_RECENT_ITEMS=t.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO=t.RECEIVE_CAN_OPEN_INFO=t.RAW_RELATED_ACTIVITY_PARSE_ERROR=t.RAW_RECENT_ACTIVITY_PARSE_ERROR=t.RENAME_FILE=t.DELETE_FILES_ROLLBACK=t.DELETE_FILES_PENDING=t.DELETE_FILES_COMMIT=t.ARCHIVE_PAPER_DOCUMENT_ROLLBACK=t.ARCHIVE_PAPER_DOCUMENT_PENDING=t.ARCHIVE_PAPER_DOCUMENT_COMMIT=t.RECENT_EVENT_FILTER_TYPE=t.RECENT_EVENT_TYPES=void 0,n=i.__importStar(n),t.RECENT_EVENT_TYPES=n.RECENT_EVENT_TYPES,t.RECENT_EVENT_FILTER_TYPE=n.RECENT_EVENT_FILTER_TYPE,t.ARCHIVE_PAPER_DOCUMENT_COMMIT="ARCHIVE_PAPER_DOCUMENT_COMMIT",t.ARCHIVE_PAPER_DOCUMENT_PENDING="ARCHIVE_PAPER_DOCUMENT_PENDING",t.ARCHIVE_PAPER_DOCUMENT_ROLLBACK="ARCHIVE_PAPER_DOCUMENT_ROLLBACK",t.DELETE_FILES_COMMIT="DELETE_FILES_COMMIT",t.DELETE_FILES_PENDING="DELETE_FILES_PENDING",t.DELETE_FILES_ROLLBACK="DELETE_FILES_ROLLBACK",t.RENAME_FILE="RENAME_FILE",t.RAW_RECENT_ACTIVITY_PARSE_ERROR="RAW_RECENT_ACTIVITY_PARSE_ERROR",t.RAW_RELATED_ACTIVITY_PARSE_ERROR="RAW_RELATED_ACTIVITY_PARSE_ERROR",t.RECEIVE_CAN_OPEN_INFO="RECEIVE_CAN_OPEN_INFO",t.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO="RECEIVE_FILE_IN_ROOT_COLLECTION_INFO",t.RECEIVE_PAPER_RECENT_ITEMS="RECEIVE_PAPER_RECENT_ITEMS",t.RECEIVE_RAW_RECENT_ACTIVITIES="RECEIVE_RAW_RECENT_ACTIVITIES",t.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY="RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY",t.REFRESH_RECENT_ACTIVITIES="REFRESH_RECENT_ACTIVITIES",t.ADD_PENDING_ACTIVITY_KEYS="ADD_PENDING_ACTIVITY_KEYS",t.REMOVE_PENDING_ACTIVITY_KEYS="REMOVE_PENDING_ACTIVITY_KEYS",t.MAX_INITIAL_DOC_ATTACHMENTS=3,t.SHOW_MORE_DOC_ATTACHMENT_INCREMENT=10,t.MAX_INITIAL_THUMBNAIL_ATTACHMENTS=8,t.SHOW_MORE_THUMBNAIL_ROW_INCREMENT=4,(function(e){e.CREATED="CREATE",e.OPENED="VIEW",e.EDITED="EDIT"})(t.PaperRecentItemAction||(t.PaperRecentItemAction={})),t.PaperRecentItemTypes={DOCUMENT:"DOCUMENT",FOLDER:"FOLDER",PROJECT:"PROJECT"},t.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_PRE_TTI=10,t.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_POST_TTI=100,t.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS=1,(function(e){e.OPENED="OPENED",e.EDITED="EDITED",e.ADDED="ADDED"})(t.RecentItemActionType||(t.RecentItemActionType={})),t.I18N={OPENED:o.intl.formatMessage({id:"xPH1sd",defaultMessage:"Opened"}),EDITED:o.intl.formatMessage({id:"l46MMy",defaultMessage:"Edited"}),ADDED:o.intl.formatMessage({id:"toc0wl",defaultMessage:"Added"})},(function(e){e.COMMENT="comment",e.COPY_LINK="copy_link",e.DELETE="delete",e.DOWNLOAD="download",e.HIDE="hide",e.OPEN="open",e.OPEN_DIR="open_dir",e.OPEN_PATH="open_path",e.OPEN_EXTENSION="open_extension",e.PAPER_ARCHIVE="paper_archive",e.PAPER_OPEN="paper_open",e.PAPER_SHARE="paper_share",e.REPORT_JUNK="report_junk",e.SHARE="share",e.ADD_STAR="add_star",e.REMOVE_STAR="remove_star",e.SHARE_COLLECTION="share_collection",e.UNITY_OPEN="unity_open",e.VERSIONS="versions",e.VIEW_FILE="view",e.VIEW_SHARED_LINK="view_shared_link",e.VIEW_IN_FOLDER="view_in_folder",e.COLLAPSE="collapse",e.UNCOLLAPSE="uncollapse"})(t.ActionType||(t.ActionType={})),(function(e){e.SINGLE="single",e.SUBSET="subset",e.AGGREGATION="aggregation",e.SELECTED="selected"})(t.ActionScope||(t.ActionScope={})),(function(e){e.RECENTS_JSON_CONTINUATION="handleAndLogRecentsJson",e.SHARE_FILE="shareFile",e.PREVIEW_RECENT_ITEM="previewRecentItem",e.OPEN_FILE="openFile",e.DOWNLOAD_FILES="downloadFiles",e.OPEN_VERSIONS="openVersions",e.PROMPT_AND_DELETE_ATTACHMENTS="promptAndDeleteAttachments",e.LOAD_REMAINING_ATTACHMENTS="loadRemainingAttachments"})(t.EnsureAttachmentsPurpose||(t.EnsureAttachmentsPurpose={}))})),define("metaserver/static/js/home/recents/recent_activity_dispatcher",["require","exports","flux"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recentActivityDispatcher=void 0,t.recentActivityDispatcher=new i.Dispatcher})),define("metaserver/static/js/home/recents/recent_activity_federated_model",["require","exports","metaserver/static/js/home/recents/recent_activity_constants"],(function(e,t,i){"use strict";function n(e){return e.paperRecentItem.type===i.PaperRecentItemTypes.DOCUMENT}function o(e){return n(e)&&e.paperRecentItem.shareUrl||""}Object.defineProperty(t,"__esModule",{value:!0}),t.FederatedRecentItem=t.equalsPaperRecentItem=t.getPaperShareUrl=t.isPaperProject=t.isPaperDocument=void 0,t.isPaperDocument=n,t.isPaperProject=function(e){return e.paperRecentItem.type===i.PaperRecentItemTypes.PROJECT},t.getPaperShareUrl=o,t.equalsPaperRecentItem=function(e,t){return e.paperRecentItem.id===t.id&&e.paperRecentItem.type===t.type};t.FederatedRecentItem=class{constructor(e){this.paperRecentItem=e}isShareable(){return n(this)&&Boolean(o(this))}isArchiveable(){return n(this)&&Boolean(this.paperRecentItem.isEditable)}hasMenuActions(){return this.isArchiveable()}getIdTypePair(){return{id:this.paperRecentItem.resource_id,type:this.paperRecentItem.id_type}}getStarredStatus(){return{starred:this.paperRecentItem.isFavorite,idTypePair:this.getIdTypePair()}}getIcon(){switch(this.paperRecentItem.display_type){case"PAPER_DOCUMENT":return"paper_doc";case"PAPER_FOLDER":return"folder";case"PAPER_PUBLIC_FOLDER":return"folder_team";case"PAPER_PROJECT":return"paper_project";default:return"file"}}getDisplayType(){return this.paperRecentItem.display_type}getIsDir(){return!1}getFolderPath(){return[""].concat(this.paperRecentItem.path.map(e=>e.name)).join("/")}getFqPath(){return`${this.getFolderPath()}/${this.paperRecentItem.name}`}getActivityKey(){return`paper_id_${this.paperRecentItem.id}`}getUrl(){return this.paperRecentItem.url}}})),define("metaserver/static/js/home/recents/recent_activity_logger_utils",["require","exports","tslib","metaserver/static/js/clean/web_timing_logger"],(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onLogFirstAction=t.canLogFirstAction=t.reset=t.getRecentsLoggingData=void 0,n=i.__importStar(n);let o=!1,r=!1;t.getRecentsLoggingData=function(){if(!r){const e=n.start_time();if(e)return r=!0,{isFullPage:!0,startTime:e}}return{isFullPage:!1,startTime:Date.now()}},t.reset=function(){r=!1,o=!1},t.canLogFirstAction=function(){return!o},t.onLogFirstAction=function(){o=!0}})),define("metaserver/static/js/home/recents/recent_activity_stream",["require","exports","tslib","lodash","metaserver/static/js/home/recents/models/utils"],(function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMergedRecentItems=t.RecentActivityStream=void 0,n=i.__importStar(n);class r{constructor(e,t){this.sortedRecentItems=e,this.hasMore=t,this.activityKeyToRecentItem={},e.forEach(e=>{this.activityKeyToRecentItem[e.id]=e}),this.oldestTimeForOtherStream=this.getOldestItemTimeForOtherStreams()}getOldestItemTimeForOtherStreams(){return this.hasMore&&this.sortedRecentItems.length&&this.sortedRecentItems[this.sortedRecentItems.length-1].when||0}getRecentItems(){return this.sortedRecentItems.slice()}getRecentItemByActivityKey(e){return this.activityKeyToRecentItem[e]||null}getStreamWithoutActivityKey(e){return new r(this.sortedRecentItems.filter(t=>t.id!==e),this.hasMore)}getItemsAfter(e){if(this.oldestTimeForOtherStream<e){const t=[];for(const i of this.sortedRecentItems){if(i.when<e)break;t.push(i)}return t}return this.sortedRecentItems}}t.RecentActivityStream=r,t.getMergedRecentItems=function(e){const t=e.filter(Boolean),i=n.max(t.map(e=>e.oldestTimeForOtherStream));return[].concat(...t.map(e=>e.getItemsAfter(i))).sort(o.compareRecentItems)}})),define("metaserver/static/js/home/recents/recent_activity_text_helper",["require","exports","metaserver/static/js/clean/em_string","metaserver/static/js/core/i18n"],(function(e,t,i,n){"use strict";function o(e,t){return n.intl.formatMessage({id:"650lWu",defaultMessage:"{count, plural, one{{name} and {count} other} other{{name} and {count} others}}"},{count:t,name:e})}Object.defineProperty(t,"__esModule",{value:!0}),t.snippetList=void 0,t.snippetList=function(e,t,r={}){const s=Math.max(Math.floor(r.totalCount||0),e.length);if(1===s)return i.Emstring.em_snippet(e[0],t);{const r=e[0],a=s-1;let l=o(r,a);if(new i.Emstring(l).length>t){const e=Math.floor(t-new i.Emstring(o("",a)).length)-1;l=e<3?n.intl.formatMessage({id:"aNHFm3",defaultMessage:"{count, plural, one{{count} other} other{{count} others}}"},{count:s}):o(i.Emstring.em_snippet(r,e),a)}let c="",d=1;for(;d<e.length&&(d+=1,c=e.slice(0,d).join(", "),d<s&&(c=o(c,s-d)),new i.Emstring(c).length<t);)l=c;return l}}})),define("metaserver/static/js/home/recents/store_utils",["require","exports","tslib","metaserver/static/js/home/store","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/recent_activity_logger_utils","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/models/utils","metaserver/static/js/home/recents/recent_activity_client_utils"],(function(e,t,i,n,o,r,s,a,l){"use strict";function c(e,t){return i.__awaiter(this,void 0,void 0,(function*(){try{return yield t()}catch(t){throw e().then(({logRequestFailed:e})=>e((0,n.getUserId)(),t)),t}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.handleRetrievePaperRecentsPromise=t.logErrorAndRethrowAsync=t.handleAndLogRecentsJsonPromise=void 0,t.handleAndLogRecentsJsonPromise=function(e,t,d=!0){try{const u=(0,r.getRecentsLoggingData)(),{recent_activities:m,cursor:g,encrypted:h,use_assistant_service:p}=(0,l.getPayload)(t),_=(0,n.getUserId)(),f=[],v=[];return m.forEach(e=>{(0,l.isPaperRecentItem)(e)?f.push(e):(0,l.isSFJRecentItem)(e)&&v.push(e)}),p&&o.recentActivityDispatcher.dispatch({type:s.RECEIVE_PAPER_RECENT_ITEMS,items:f,hasMore:!1,userId:_}),o.recentActivityDispatcher.dispatch({type:s.RECEIVE_RAW_RECENT_ACTIVITIES,rawRecentActivities:v,cursor:g||"",encrypted:h||"",userId:_}),c(e,()=>i.__awaiter(this,void 0,void 0,(function*(){let t=[];v.forEach(e=>{if(e.skeleton_data&&e.related_activity_keys){const i=(0,a.shouldShowThumbnailsForSkeletonData)(e.skeleton_data)?s.MAX_INITIAL_THUMBNAIL_ATTACHMENTS:s.MAX_INITIAL_DOC_ATTACHMENTS;t=t.concat(...e.related_activity_keys.slice(0,i))}});const{ensureAttachments:i}=yield e();yield i(t,s.EnsureAttachmentsPurpose.RECENTS_JSON_CONTINUATION);let n=!1,o=0;v.forEach(({skeleton_data:e})=>{e&&(o+=e.num_related_activities||0,(e.num_related_activities||0)>1&&(n=!0))}),e().then(({logRecentsLoaded:e})=>e(_,u,{is_paginated:!d,contains_aggregation:n,item_count:m.length}))})))}catch(t){throw e().then(({logRequestFailed:e})=>e((0,n.getUserId)(),t)),t}},t.logErrorAndRethrowAsync=c,t.handleRetrievePaperRecentsPromise=function(e,t,i=!0){const r=(0,n.getUserId)(),a=(0,l.getPayload)(t);if(!a.use_assistant_service){const t=i&&a.has_more;o.recentActivityDispatcher.dispatch({type:s.RECEIVE_PAPER_RECENT_ITEMS,items:a.items,hasMore:t,userId:r}),t&&e().then(({loadPaperRecentItems:e})=>e(!1))}}})),define("metaserver/static/js/home/recents/stores/attachment_store",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","lodash","metaserver/static/js/home/resource/store","metaserver/static/js/flux/flux_store","metaserver/static/js/home/recents/actions/error_actions","metaserver/static/js/home/recents/stores/flux_utils","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/models/attachment","metaserver/static/js/core/assert"],(function(e,t,i,n,o,r,s,a,l,c,d,u,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAttachmentStore=t.AttachmentStore=void 0,r=i.__importStar(r);class h extends a.FluxStore{constructor(e,t={}){super(e),this.onCommit=e=>{delete this.transactionHistory[e.transactionId]},this._onDeleteFilesPending=e=>{const t=[];for(const i of e.attachmentIds)i in this.attachmentIdToAttachment&&(t.push(this.attachmentIdToAttachment[i]),delete this.attachmentIdToAttachment[i]);this.transactionHistory[e.transactionId]={deletedAttachments:t},(0,c.emitChangeIfNeeded)(this,!!t.length)},this._onDeleteFilesRollback=e=>{const t=this.transactionHistory[e.transactionId];(0,g.assert)(!!t,`Unable to find data for transaction with id: ${e.transactionId}`),t.deletedAttachments.forEach(e=>this.attachmentIdToAttachment[e.id]=e),(0,c.emitChangeIfNeeded)(this,!!t.deletedAttachments.length)},this.pendingActivityKeys=[],this.attachmentIdToEncryptedToken={},this.attachmentIdToAttachment={},(t.attachments||[]).forEach(e=>{this.attachmentIdToAttachment[e.id]=e,t.encryptedToken&&(this.attachmentIdToEncryptedToken[e.id]=t.encryptedToken)}),this.transactionHistory={}}areSomeActivityKeysPending(e){return!!r.intersection(this.pendingActivityKeys,e).length}getById(e){return this.attachmentIdToAttachment[e]||null}getByIds(e){return r.values(r.pick(this.attachmentIdToAttachment,e))}getByFqPath(e){return this.getAll().find(t=>t.fqPath===e)||null}getAll(){return r.values(this.attachmentIdToAttachment)}getAllById(){return this.attachmentIdToAttachment}groupIdsByEncryptedToken(e){return r.groupBy(e.filter(e=>e in this.attachmentIdToEncryptedToken),e=>this.attachmentIdToEncryptedToken[e])}__onDispatch(e){switch(e.type){case d.ADD_PENDING_ACTIVITY_KEYS:this.onAddPendingActivityKeys(e);break;case d.REMOVE_PENDING_ACTIVITY_KEYS:this.onRemovePendingActivityKeys(e);break;case d.DELETE_FILES_COMMIT:this.onCommit(e);break;case d.DELETE_FILES_PENDING:this._onDeleteFilesPending(e);break;case d.DELETE_FILES_ROLLBACK:this._onDeleteFilesRollback(e);break;case d.RECEIVE_RAW_RECENT_ACTIVITIES:this.onReceiveRawRecentActivities(e);break;case d.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY:this.onReceiveRawRelatedActivitiesByKey(e);break;case d.RECEIVE_CAN_OPEN_INFO:this.onReceiveCanOpenInfo(e);break;case d.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO:this._onReceiveFileInRootCollectionInfo(e)}}mutateAttachmentInNsIdPath(e,t){if(e&&e.indexOf(":")>=0){const[i,n]=e.split(":"),o=this.getAll().find(e=>e.nsId===Number(i)&&e.nsPath===n)||null;if(o){const e=(0,c.getMutatedOrOriginal)(o,t);if(e!==o)return this.attachmentIdToAttachment[o.id]=e,!0}}return!1}updatePendingActivityKeys(e,t){const i=this.pendingActivityKeys.length;if(t){const t=this.pendingActivityKeys.concat(...e);this.pendingActivityKeys=r.uniq(t)}else this.pendingActivityKeys=r.without(this.pendingActivityKeys,...e);(0,c.emitChangeIfNeeded)(this,i!==this.pendingActivityKeys.length)}onAddPendingActivityKeys(e){this.updatePendingActivityKeys(e.activityKeys,!0)}onRemovePendingActivityKeys(e){this.updatePendingActivityKeys(e.activityKeys,!1)}onReceiveRawRecentActivities(e){const t=e.rawRecentActivities.map(m.createPartialAttachmentsFromRecentActivity),i=[].concat(...t).filter(e=>{const t=this.getById(e.id);return!t||!t.isLoaded});i.forEach(t=>{this.attachmentIdToAttachment[t.id]=t,this.attachmentIdToEncryptedToken[t.id]=e.encrypted}),(0,c.emitChangeIfNeeded)(this,!!i.length)}onReceiveRawRelatedActivitiesByKey(e){if(e.rawRelatedActivitiesByKey){const t=Object.keys(e.rawRelatedActivitiesByKey);this.updatePendingActivityKeys(t,!1);const i={};(0,c.iterateAndEmitChangesIfNeeded)(this,e.rawRelatedActivitiesByKey,(e,t)=>{try{const t=(0,m.convertFileActivityToAttachmentItem)(e);return t.previewInfo&&!t.previewInfo.is_dir&&(i[t.id]=t.previewInfo),this.attachmentIdToAttachment[t.id]=t,!0}catch(e){return r.defer(()=>l.errorActions.relatedActivityParseError(t,e)),!1}}),setTimeout(()=>{(0,s.getHomeResourceStore)(),n.Dispatcher.dispatch({type:o.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE,resourceIdToFile:i})})}}onReceiveCanOpenInfo(e){(0,c.iterateAndEmitChangesIfNeeded)(this,e.canOpenInfo,(e,t)=>this.mutateAttachmentInNsIdPath(t,{canOpen:e.is_locally_available}))}_onReceiveFileInRootCollectionInfo(e){(0,c.iterateAndEmitChangesIfNeeded)(this,e.fileInRootCollectionInfo,(e,t)=>this.mutateAttachmentInNsIdPath(t,{inRootCollection:e}))}}t.AttachmentStore=h;let p=null;t.getAttachmentStore=function(){return null===p&&(p=new h(u.recentActivityDispatcher)),p}})),define("metaserver/static/js/home/recents/stores/flux_utils",["require","exports"],(function(e,t){"use strict";function i(e,t){t&&e.__emitChange()}Object.defineProperty(t,"__esModule",{value:!0}),t.getMutatedOrOriginal=t.emitChangeIfNeeded=t.iterateAndEmitChangesIfNeeded=void 0,t.iterateAndEmitChangesIfNeeded=function(e,t,n){let o=!1;Object.keys(t).forEach(e=>{n(t[e],e)&&(o=!0)}),i(e,o)},t.emitChangeIfNeeded=i,t.getMutatedOrOriginal=function(e,t){for(const i in t)if(t[i]!==e[i])return Object.assign(Object.assign({},e),t);return e}})),define("metaserver/static/js/home/recents/stores/recent_activity_store",["require","exports","tslib","lodash","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/models/federated_recent_item","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/models/recent_item","metaserver/static/js/home/recents/models/utils","metaserver/static/js/home/recents/stores/flux_utils","metaserver/static/js/home/recents/stores/attachment_store","metaserver/static/js/home/store","metaserver/static/js/core/assert","metaserver/static/js/home/recents/recent_activity_stream","metaserver/static/js/home/post_tti/api","metaserver/static/js/clean/viewer","metaserver/static/js/home/constants","metaserver/static/js/home/util/logging/availability_logger","metaserver/static/js/home/recents/store_utils","metaserver/static/js/flux/flux_store","metaserver/static/js/modules/constants/web_experience_constants"],(function(e,t,i,n,o,r,s,a,l,c,d,u,m,g,h,p,_,f,v,S,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRecentActivityStore=t.RecentActivityStore=void 0,n=i.__importStar(n);class I extends S.FluxStore{constructor(e,t=[],i){super(e),this.renameItem=(e,t,i)=>{var n,o;const r=this.fileSyncRecentItemIdToRecentItem[e],s=null===(n=r.scl)||void 0===n?void 0:n.replace(null!==(o=r.fqPath)&&void 0!==o?o:"",null!=i?i:"");this.updateFileSyncItem(r,{displayName:t,fqPath:i,scl:s})},this.removeFileSyncItem=e=>{this.fileSyncRecentItemIdToRecentItem.hasOwnProperty(e.id)&&(delete this.fileSyncRecentItemIdToRecentItem[e.id],this.needsToRefreshFileSyncCache=!0)},this.addFileSyncItem=e=>{e!==this.fileSyncRecentItemIdToRecentItem[e.id]&&(this.fileSyncRecentItemIdToRecentItem[e.id]=e,this.needsToRefreshFileSyncCache=!0)},this.fileSyncRecentItemIdToRecentItem={},this.fileSyncCursor=null,this.fileSyncTransactionIdToRestoreData={},this.didReceiveRawRecentActivities=!!t.length,t.forEach(this.addFileSyncItem),this.fileSyncCache={items:t},this.needsToRefreshFileSyncCache=!1;const n=(0,u.getHomeStore)().getSectionLoadingPreference(_.ConditionalSections.PAPER_RECENTS)===_.ConditionalSectionLoadingPreference.POST_TTI;this.paperStream=n?new g.RecentActivityStream([],!1):null,this.didRecievePaperItems=n,this.paperActivityKeyToPendingArchiving={},this.cachedFederatedRecentItems=[],this.cachedFederatedTruncatedRecentItems=[],this.federatedRecentItemsCountMax=o.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_PRE_TTI,this.cachedProcessedRecentItems=null,(0,h.waitForHomeTTI)().then(()=>{this.federatedRecentItemsCountMax=o.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_POST_TTI,this.didTruncateRecentItems()&&(this.cacheTruncatedFederatedRecentItems(),this.cachedProcessedRecentItems=null)}),(0,d.getAttachmentStore)(),i||(0,f.getHomeAvailabilityLogger)().handlePrefetch(_.HomePrefetchTypes.RECENTS_JSON,e=>(0,v.handleAndLogRecentsJsonPromise)(h.waitForHomeTTI,e))}getSortedFileSyncRecentItems(){return this.fileSyncCache.sortedItems||(this.fileSyncCache.sortedItems=this.fileSyncCache.items.slice().sort(l.compareRecentItems)),this.fileSyncCache.sortedItems}__onDispatch(e){this.fileSyncHandler(e)||this.paperHandler(e)}fileSyncHandler(e){switch(e.type){case o.DELETE_FILES_COMMIT:this.onDeleteCommit(e);break;case o.DELETE_FILES_PENDING:this.onDeleteFilesPending(e);break;case o.DELETE_FILES_ROLLBACK:this.onDeleteFilesRollback(e);break;case o.RENAME_FILE:this.onRenameFile(e);break;case o.RECEIVE_RAW_RECENT_ACTIVITIES:this.onReceiveRawRecentActivities(e);break;case o.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY:this.onReceiveRawRelatedActivitiesByKey(e);break;case o.RAW_RELATED_ACTIVITY_PARSE_ERROR:this.onRawRelatedActivityParseError(e);break;case o.REFRESH_RECENT_ACTIVITIES:this.onRefreshRecentActivities();break;default:return!1}return this.updateFileSyncCache(!0),!0}paperHandler(e){switch(e.type){case o.RECEIVE_PAPER_RECENT_ITEMS:this.onReceivePaperRecentItems(e.items,e.hasMore,e.userId);break;case o.ARCHIVE_PAPER_DOCUMENT_PENDING:this.onArchivePaperDocumentPending(e.activityKey);break;case o.ARCHIVE_PAPER_DOCUMENT_COMMIT:this.onArchivePaperDocumentCommit(e.activityKey);break;case o.ARCHIVE_PAPER_DOCUMENT_ROLLBACK:this.onArchivePaperDocumentRollback(e.activityKey);break;default:return}this.__emitChange()}updateFileSyncCache(e){this.needsToRefreshFileSyncCache?(this.fileSyncCache={items:n.values(this.fileSyncRecentItemIdToRecentItem)},this.clearFederatedCache(),this.needsToRefreshFileSyncCache=!1,(0,c.emitChangeIfNeeded)(this,e)):(0,c.emitChangeIfNeeded)(this,!this.cachedProcessedRecentItems)}onDeleteCommit(e){delete this.fileSyncTransactionIdToRestoreData[e.transactionId]}onReceiveRawRecentActivities(e){(0,c.emitChangeIfNeeded)(this,!this.didReceiveRawRecentActivities&&!e.rawRecentActivities.length),this.didReceiveRawRecentActivities=!0;const t=!this.fileSyncCache.items.length,i=[],r={};if(e.rawRecentActivities.forEach(s=>{if(!s.viewing_user||s.viewing_user.id!==e.userId)return;const l=(0,a.convertRecentActivityToRecentItem)(s);if(l&&(l.uniqueFilterTypes.indexOf(o.RECENT_EVENT_FILTER_TYPE.JUNK)<0||l.uniqueFilterTypes.indexOf(o.RECENT_EVENT_FILTER_TYPE.ALL)>=0))if(i.push(s),t)this.fileSyncRecentItemIdToRecentItem[l.id]=l;else if(!r[l.id]){r[l.id]=l;const e=this.fileSyncCache.items.find(e=>e.id!==l.id&&e.contextDisplayName===l.contextDisplayName);if(e){n.intersection(e.attachmentIds,l.attachmentIds).length>0&&(this.removeFileSyncItem(e),this.updateFileSyncCache(!1))}const t=this.fileSyncRecentItemIdToRecentItem[l.id];this.updateFileSyncItem(l,{fqPath:t&&t.fqPath||void 0,paths:t&&t.paths||l.paths})}}),!t)for(const e in this.fileSyncRecentItemIdToRecentItem)if(!r[e]){const t=this.fileSyncCache.items.find(t=>t.id===e);t&&this.removeFileSyncItem(t)}if(this.updateFileSyncCache(!1),!t){const e={};this.getSortedFileSyncRecentItems().forEach(t=>{if(t.attachmentIds.length>0){const i=Object.keys(e).length;t.attachmentIds.forEach(t=>e[t]=!0),i===Object.keys(e).length&&this.removeFileSyncItem(t)}})}this.fileSyncCursor=e.cursor,this.needsToRefreshFileSyncCache=!0}onReceiveRawRelatedActivitiesByKey(e){this.waitForAttachmentStoreDispatcher();const t=Object.keys(e.rawRelatedActivitiesByKey||{});t.length&&this.clearFederatedCache(),this.getFileSyncRecentItemsByAttachmentIds(t).forEach(({id:e})=>{const t=this.fileSyncRecentItemIdToRecentItem[e];if(!t)return;const i=t.attachmentIds;if(!i||!i.length)return;const n=(0,d.getAttachmentStore)().getById(i[0]);if(!n||!n.isLoaded)return;let o=n.fqPath||"";i.slice(1).forEach(e=>{const t=(0,d.getAttachmentStore)().getById(e);if(!t.isLoaded)return;const i=t.fqPath||"";i.split("/").length<o.split("/").length&&(o=i)});const r=o.split("/"),s=r[r.length-2];this.updateFileSyncItem(t,{fqPath:o,paths:(0,l.getPathsByFqPath)(o,t.viewingUserId),contextDisplayName:s||t.contextDisplayName}),n.displayType||(n.displayType=t.displayType)})}onRawRelatedActivityParseError(e){this.getFileSyncRecentItemsByAttachmentIds(n.map(e.errors,"activityKey")).forEach(this.removeFileSyncItem)}onRenameFile(e){this.waitForAttachmentStoreDispatcher(),this.renameItem(e.itemID,e.newName,e.fqPath)}onDeleteFilesPending(e){this.waitForAttachmentStoreDispatcher();const t=this.deleteAttachments(e.attachmentIds);t&&(this.fileSyncTransactionIdToRestoreData[e.transactionId]=t)}onDeleteFilesRollback(e){this.waitForAttachmentStoreDispatcher();const t=this.fileSyncTransactionIdToRestoreData[e.transactionId];(0,m.assert)(!!t,`Unable to find data for transaction with id: ${e.transactionId}`),delete this.fileSyncTransactionIdToRestoreData[e.transactionId],this.rollbackDelete(t)}onRefreshRecentActivities(){this.getUnprocessedRecentItems(),this.didReceiveRawRecentActivities=!1,this.didRecievePaperItems=!1}deleteAttachments(e){let t=null;if("ON"===E.RECENTS_TABLE_REDESIGN&&e.length){this.getFileSyncRecentItemsByAttachmentIds(e).forEach(t=>{const i=n.difference(t.attachmentIds,e);this.updateFileSyncItem(t,{attachmentIds:i}),0===i.length&&this.removeFileSyncItem(t)})}if(e.length){const i=this.getFileSyncRecentItemsByAttachmentIds([e[0]])[0];if(i){const o=n.difference(i.attachmentIds,e);this.updateFileSyncItem(i,{attachmentIds:o}),t={deletedAttachmentIds:e,item:i},0===o.length&&this.removeFileSyncItem(i)}}return t}rollbackDelete(e){let t,i=this.fileSyncRecentItemIdToRecentItem[e.item.id];i?t=i.attachmentIds:(i=e.item,t=[]),this.updateFileSyncItem(i,{attachmentIds:n.uniq(t.concat(...e.deletedAttachmentIds))})}getCachedAttachmentIdToIdToFileSyncItem(){return this.fileSyncCache.attachmentIdToIdToItem||(this.fileSyncCache.attachmentIdToIdToItem={},this.fileSyncCache.items.forEach(e=>e.attachmentIds.forEach(t=>{this.fileSyncCache.attachmentIdToIdToItem[t]?this.fileSyncCache.attachmentIdToIdToItem[t][e.id]=e:this.fileSyncCache.attachmentIdToIdToItem[t]={[e.id]:e}}))),this.fileSyncCache.attachmentIdToIdToItem}getFileSyncRecentItemsByAttachmentIds(e){const t=this.getCachedAttachmentIdToIdToFileSyncItem(),i={};return e.forEach(e=>{t.hasOwnProperty(e)&&n.values(t[e]).forEach(e=>i[e.id]=e)}),n.values(i)}waitForAttachmentStoreDispatcher(){this.getDispatcher().waitFor([(0,d.getAttachmentStore)().getDispatchToken()])}updateFileSyncItem(e,t){this.addFileSyncItem((0,c.getMutatedOrOriginal)(e,t))}onArchivePaperDocumentPending(e){this.paperActivityKeyToPendingArchiving[e]=!0}onArchivePaperDocumentCommit(e){this.deletePendingArchive(e),this.paperStream=this.paperStream.getStreamWithoutActivityKey(e),this.clearFederatedCache()}onArchivePaperDocumentRollback(e){this.deletePendingArchive(e)}deletePendingArchive(e){this.paperActivityKeyToPendingArchiving[e]&&delete this.paperActivityKeyToPendingArchiving[e]}onReceivePaperRecentItems(e,t,i){this.didRecievePaperItems=!0;const n=p.Viewer.get_viewer().get_user_by_id(i),o=e.map((e,t)=>(0,r.createRecentItemFromPaperRecentItem)(e,n,t));this.paperStream=new g.RecentActivityStream(o,t),(0,h.waitForHomeTTI)().then(t=>t.setStarredStatusOfPaperRecentItems(e)),this.clearFederatedCache()}clearFederatedCache(){this.cachedFederatedRecentItems&&this.didReceiveItemsFromAllStreams()&&(this.__emitChange(),this.cachedFederatedRecentItems=null,this.cachedFederatedTruncatedRecentItems=null,this.cachedProcessedRecentItems=null)}cacheTruncatedFederatedRecentItems(){this.cachedFederatedRecentItems?this.cachedFederatedTruncatedRecentItems=this.cachedFederatedRecentItems.slice(0,this.federatedRecentItemsCountMax):this.getUnprocessedRecentItems()}getUnprocessedRecentItems(){if(null===this.cachedFederatedRecentItems){const e=[this.paperStream,new g.RecentActivityStream(this.getSortedFileSyncRecentItems(),!!this.fileSyncCursor)];this.cachedFederatedRecentItems=(0,g.getMergedRecentItems)(e),this.cacheTruncatedFederatedRecentItems()}return this.cachedFederatedTruncatedRecentItems}getFileSyncCursor(){return this.fileSyncCursor}canArchiveActivityKey(e){if(this.paperStream&&!this.paperActivityKeyToPendingArchiving[e]){const t=this.paperStream.getRecentItemByActivityKey(e);return!(!t||!t.federatedRecentItem.isArchiveable())}return!1}didReceiveItemsFromAllStreams(){return this.didRecievePaperItems&&this.didReceiveRawRecentActivities}getRecentItems(){return null===this.cachedProcessedRecentItems&&(this.cachedProcessedRecentItems=this.getUnprocessedRecentItems()),{items:this.cachedProcessedRecentItems}}didTruncateRecentItems(){return!!(this.cachedFederatedRecentItems&&this.cachedFederatedTruncatedRecentItems&&this.cachedFederatedTruncatedRecentItems.length<this.cachedFederatedRecentItems.length)}}t.RecentActivityStore=I;let T=null;t.getRecentActivityStore=function(e=!1){return null===T&&(T=new I(s.recentActivityDispatcher,[],e)),T}})),define("metaserver/static/js/home/recents/utils/events",["require","exports","tslib","lodash","react-dom","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/home/resource_id_types"],(function(e,t,i,n,o,r,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logFederatedItemEvent=t.logCleanFederatedItemEvent=t.logCleanerEvent=t.logEvent=void 0,n=i.__importStar(n),o=i.__importStar(o);const l=(e,t)=>1===e?r.ActionScope.SINGLE:t.length===e?r.ActionScope.AGGREGATION:r.ActionScope.SUBSET,c=e=>e?Array.prototype.indexOf.call(e.parentNode.childNodes,e):0,d=(e,t,i,n)=>{if(e===r.ActionScope.AGGREGATION||t===r.ActionType.COLLAPSE||t===r.ActionType.UNCOLLAPSE)return{};const o=i[n];if(!o)return{};for(const e of["PAPER","EXTERNAL"])if(o.displayType&&o.displayType.indexOf(e)>=0)return{idType:void 0,resourceId:void 0};return{idType:a.HOME_RESOURCE_ID_TYPE.FQ_PATH,resourceId:o.fqPath,displayType:o.displayType,isDir:o.isDir}},u=(e,t,i,n)=>e===r.ActionScope.AGGREGATION?i.props.recentItem?0:t+1:e===r.ActionScope.SUBSET?n.classList.contains("recents-item")?0:1:0,m=e=>n.filter(e,e=>!!e.fqPath),g=e=>n.map(e,e=>e.fqPath),h=(e,t)=>{const i=e[t];return i&&i.previewInfo?i.previewInfo.icon:""};t.logEvent=function(e,t,i,n,r,a){const p=((e,t,i,n,r)=>{const s=m(i),a=g(s),p=o.findDOMNode(t),_=l(n,a),f=h(i,r||0);return{actionTaken:e,scope:_,itemNumber:c(p),fileDetails:d(_,e,s,r||0),sprite:f,subgroupPosition:u(_,r||0,t,p)}})(e,t,i,n,r);return s.homeActivityLogger.logRecentsAction(p.actionTaken,p.scope,p.itemNumber,p.sprite,p.fileDetails.displayType||"",!!p.fileDetails.isDir,p.subgroupPosition,p.fileDetails.idType,p.fileDetails.resourceId,a)};t.logCleanerEvent=function(e,t,i,n,o,r,a){const c=((e,t,i,n)=>{const o=m(t),r=g(o),s=l(i,r),a=h(t,n||0);return{actionTaken:e,scope:s,fileDetails:d(s,e,o,n||0),sprite:a}})(e,n,o,r);return s.homeActivityLogger.logRecentsAction(c.actionTaken,c.scope,t,c.sprite,c.fileDetails.displayType||"",!!c.fileDetails.isDir,i,c.fileDetails.idType,c.fileDetails.resourceId,a)},t.logCleanFederatedItemEvent=function(e,t,i,n){const o=n.getIdTypePair();return s.homeActivityLogger.logRecentsAction(e,r.ActionScope.SINGLE,t,n.getIcon(),n.getDisplayType(),n.getIsDir(),i,o.type,o.id)},t.logFederatedItemEvent=function(e,t,i){const n=o.findDOMNode(t),a=i.getIdTypePair();return s.homeActivityLogger.logRecentsAction(e,r.ActionScope.SINGLE,c(n),i.getIcon(),i.getDisplayType(),i.getIsDir(),u(r.ActionScope.SINGLE,0,t,n),a.type,a.id)}})),define("metaserver/static/js/home/resource/store",["require","exports","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","metaserver/static/js/starred/constants","metaserver/static/js/starred/id_type_pair","metaserver/static/js/flux/flux_store"],(function(e,t,i,n,o,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHomeResourceStore=t.HomeResourceStore=void 0;class a extends s.FluxStore{constructor(){super(i.Dispatcher),this.pendingPreviewResourceId=null,this.resourceIdToFile={},this.fileToPreview=null,this.resourceIdToEquivalentResourceId={}}getFileToPreview(){return this.fileToPreview}emitIfPendingFileExists(){if(null!==this.pendingPreviewResourceId){const e=this.resourceIdToEquivalentResourceId[this.pendingPreviewResourceId]||this.pendingPreviewResourceId;this.fileToPreview=this.resourceIdToFile[this.pendingPreviewResourceId]||this.resourceIdToFile[e]||null,null!==this.fileToPreview&&(this.pendingPreviewResourceId=null,this.__emitChange())}}onRequestPreview(e){this.pendingPreviewResourceId=e,this.emitIfPendingFileExists()}onReceivedResourceIdToFile(e){this.resourceIdToFile=Object.assign(Object.assign({},this.resourceIdToFile),e),this.emitIfPendingFileExists()}onStarredSetStatus(e){e.forEach(e=>{if(e.canonicalIdTypePair){const t=(0,r.idTypePairToString)(e.idTypePair),i=(0,r.idTypePairToString)(e.canonicalIdTypePair);t!==i&&(this.resourceIdToEquivalentResourceId[i]=t,this.resourceIdToEquivalentResourceId[t]=i)}}),this.emitIfPendingFileExists()}__onDispatch(e){const t=e.action;switch(t.type){case n.HomeResourceStoreActionTypes.REQUEST_PREVIEW:this.onRequestPreview(t.resourceId);break;case n.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE:this.onReceivedResourceIdToFile(t.resourceIdToFile);break;case o.StarredActionTypes.SET_STATUS:this.onStarredSetStatus(t.starredStatuses)}}}t.HomeResourceStore=a;let l=null;t.getHomeResourceStore=function(){return null===l&&(l=new a),l}})),define("metaserver/static/js/home/store",["require","exports","tslib","lodash","metaserver/static/js/flux/dispatcher","metaserver/static/js/flux/flux_store","metaserver/static/js/photos/thumb_loading/generic_thumb_store","metaserver/static/js/home/constants","metaserver/static/js/home/util/logging/availability_logger_common","metaserver/static/js/clean/viewer","metaserver/static/js/core/assert","metaserver/static/js/core/exception","metaserver/static/js/clean/active_user"],(function(e,t,i,n,o,r,s,a,l,c,d,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBlockingSection=t.isHomeSection=t.getRole=t.getUserId=t.getUser=t.getHomeStore=t.PrivateHomeStoreClass=void 0,n=i.__importStar(n);class g extends r.FluxStore{constructor(){super(o.Dispatcher),this.handledPrefetches=[],this.activeTabId=a.HomeTabId.STARRED,this.canRenderItems=()=>!!this.pendingPreTTIPrefetches&&!this.pendingPreTTIPrefetches.length,this.thumbStore=new s.GenericThumbStore,this.sectionToDidLoadSynchronously={},this.sectionToPendingCallbacks={},this.preTTIProps=a.DEFAULT_PRE_TTI_PROPS}getRole(){var e;return this.role||(null===(e=this.getUser())||void 0===e?void 0:e.role)}getUser(){return this.user||(0,m.getActiveUser)()}getThumbStore(){return this.thumbStore}getSectionVisibility(){return this.sectionVisibility}getPreTTIProps(){return this.preTTIProps}getPostTTIPropsPromise(){return this.postTTIPropsPromise}getActiveTabId(){return this.activeTabId}getActiveVariants(){return this.preTTIProps.activeVariants}getActiveVariant(e){const t=this.getActiveVariants();return t&&t[e]}getPageType(e){switch(e){case"/recents":case"/edison_test/recents":return"RECENTS";case"/starred":return"STARRED";default:return"HOME"}}executeWhenSectionIsReady(e,t,i){const n=this.getSectionLoadingPreference(e);return n===a.ConditionalSectionLoadingPreference.DO_NOT_LOAD?null:n===a.ConditionalSectionLoadingPreference.IMMEDIATE||this.getSectionLoadingMode(e)!==a.ConditionalSectionLoadingMode.UNKNOWN?i(!0):(t&&(this.sectionToPendingCallbacks[e]?this.sectionToPendingCallbacks[e].push(i):this.sectionToPendingCallbacks[e]=[i]),null)}getSectionLoadingPreference(e){if(this.sectionToExtendedConditionalData){const t=this.sectionToExtendedConditionalData[e];return t?t.isPostTti?a.ConditionalSectionLoadingPreference.POST_TTI:a.ConditionalSectionLoadingPreference.IMMEDIATE:a.ConditionalSectionLoadingPreference.DO_NOT_LOAD}return a.ConditionalSectionLoadingPreference.UNKNOWN}getSectionLoadingMode(e){return this.sectionToExtendedConditionalData&&this.sectionToExtendedConditionalData[e]?this.sectionToExtendedConditionalData[e].loadingMode:a.ConditionalSectionLoadingMode.UNKNOWN}getIsFileViewerOpen(){return this.isFileViewerOpen}canRenderAllHomeSections(){return this.sectionToExtendedConditionalData?n.values(this.sectionToExtendedConditionalData).every(e=>!e.isBlocking||(!!e.isPostTti||e.loadingMode!==a.ConditionalSectionLoadingMode.UNKNOWN)):(this.role||(0,u.reportStack)("Called canRenderAllHomeSections before initialization",{severity:u.SEVERITY.NONCRITICAL}),!0)}setSectionVisibility({section:e,visible:t}){this.sectionVisibility[e]!==t&&(this.sectionVisibility=Object.assign(Object.assign({},this.sectionVisibility),{[e]:t}))}setSectionLoadingMode(e,t){const i=this.getExtendedConditionalData(e);i&&(this.sectionToExtendedConditionalData[e]=Object.assign(Object.assign({},i),{loadingMode:t}))}getExtendedConditionalData(e){return this.sectionToExtendedConditionalData&&this.sectionToExtendedConditionalData[e]}onPrefetchReceivedData({homePrefetchType:e}){this.handledPrefetches.push(e),this.pendingPreTTIPrefetches&&(this.pendingPreTTIPrefetches=n.without(this.pendingPreTTIPrefetches,e),this.pendingPreTTIPrefetches.length||this.__emitChange())}onInitializeStore({role:e,sectionVisibility:t,preTTIProps:i,sectionToConditionalData:o}){this.role=e,this.sectionVisibility=t,this.user=c.Viewer.get_viewer().get_user_by_role(e),(0,d.assert)(!!this.user,`Could not find user for role ${e}`),this.preTTIProps=i||this.preTTIProps,this.pendingPreTTIPrefetches=n.without([a.HomePrefetchTypes.RECENTS_JSON].concat(n.compact(n.map(l.HOME_PREFETCH_TYPE_TO_INFO,({section:e},t)=>{if(o){const i=o[e];if(i&&!i.isPostTti)return t}return null}))),...this.handledPrefetches),this.sectionToExtendedConditionalData=n.mapValues(o,(e,t)=>Object.assign(Object.assign({},e),{loadingMode:a.ConditionalSectionLoadingMode.UNKNOWN,isBlocking:S(t)})),Object.keys(this.sectionToDidLoadSynchronously).forEach(e=>{(0,this.sectionToDidLoadSynchronously[e])(this.getSectionLoadingPreference(e))&&this.setSectionLoadingMode(e,a.ConditionalSectionLoadingMode.SYNCHRONOUS)}),this.sectionToDidLoadSynchronously={}}onDeclareConditionalSection({section:e,didInitializeSynchronously:t}){this.sectionToExtendedConditionalData?(0,u.reportStack)("declared conditional section too late",{severity:u.SEVERITY.CRITICAL,exc_extra:{section:e}}):this.sectionToDidLoadSynchronously[e]?(0,u.reportStack)("Re-declared a conditional section",{severity:u.SEVERITY.CRITICAL,exc_extra:{section:e}}):this.sectionToDidLoadSynchronously[e]=t}onLoadedAsyncConditionalSection({section:e}){const t=this.getExtendedConditionalData(e);t&&this.setSectionLoadingMode(e,t.isPostTti?a.ConditionalSectionLoadingMode.POST_TTI:a.ConditionalSectionLoadingMode.ASYNCHRONOUS_PRE_TTI),(this.sectionToPendingCallbacks[e]||[]).forEach(e=>e(!1)),this.sectionToPendingCallbacks[e]=[]}onSetTabId({activeTabId:e}){this.activeTabId=e}onSetPostTTIPropsPromise({postTTIPropsPromise:e}){this.postTTIPropsPromise=e}__onDispatch(e){const t=e.action;switch(t.type){case a.HomeActionTypes.INITIALIZE_STORE:this.onInitializeStore(t.payload),this.__emitChange();break;case a.HomeActionTypes.SET_TAB_ID:this.onSetTabId(t.payload),this.__emitChange();break;case a.HomeActionTypes.SET_POST_TTI_PROPS_PROMISE:this.onSetPostTTIPropsPromise(t.payload),this.__emitChange();break;case a.HomeActionTypes.HOME_PREFETCH_RECEIVED_DATA:this.onPrefetchReceivedData(t.payload);break;case a.HomeActionTypes.SET_SECTION_VISIBILITY:this.setSectionVisibility(t.payload),this.__emitChange();break;case a.HomeActionTypes.DECLARE_CONDITIONAL_SECTION:this.onDeclareConditionalSection(t.payload),this.__emitChange();break;case a.HomeActionTypes.LOADED_ASYNC_CONDITIONAL_SECTION:this.onLoadedAsyncConditionalSection(t.payload),this.__emitChange();break;case a.HomeActionTypes.OPEN_FILE_VIEWER:this.isFileViewerOpen=!0,this.__emitChange();break;case a.HomeActionTypes.CLOSE_FILE_VIEWER:this.isFileViewerOpen=!1,this.__emitChange()}}}t.PrivateHomeStoreClass=g;let h=null;function p(){return null===h&&(h=new g),h}function _(){return p().getUser()}t.getHomeStore=p,t.getUser=_,t.getUserId=function(){return _().id},t.getRole=function(){return _().role};const f=(function(e){const t={};for(const i in e)e.hasOwnProperty(i)&&(t[e[i]]=i);return t})(a.HomeSections);function v(e){return!!f[e]}function S(e){return v(e)}t.isHomeSection=v,t.isBlockingSection=S}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return __setModuleDefault(t,e),t};define("metaserver/static/js/home/util/conditional_api",["require","exports","metaserver/static/js/home/store","metaserver/static/js/home/constants"],(function(e,t,i,n){"use strict";function o(e,n=!0,o,r,s){return t.sectionToConditionalInterface[o]?e(t.sectionToConditionalInterface[o]):(0,i.getHomeStore)().executeWhenSectionIsReady(o,n,i=>{if(i&&!t.sectionToConditionalInterface[o])try{t.sectionToConditionalInterface[o]=r()}catch(e){}return t.sectionToConditionalInterface[o]&&Object.keys(t.sectionToConditionalInterface[o]).length>0?e(t.sectionToConditionalInterface[o]):(n&&s().then(i=>{t.sectionToConditionalInterface[o]=i,e(i)}),null)})}Object.defineProperty(t,"__esModule",{value:!0}),t.waitForStarred=t.waitForSection=t.sectionToConditionalInterface=void 0,t.sectionToConditionalInterface={},t.waitForSection=o,t.waitForStarred=function(t,i=!0){return o(t,i,n.HomeSections.STARRED,()=>e("metaserver/static/js/home/starred/conditional_interface"),()=>new Promise((t,i)=>{e(["metaserver/static/js/home/starred/conditional_interface"],t,i)}).then(__importStar))}})),define("metaserver/static/js/home/util/logging/timing_component",["require","exports","tslib","react","metaserver/static/js/home/util/logging/timing_logger"],(function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timingComponent=void 0,n=i.__importDefault(n),t.timingComponent=function(e,t){return class extends n.default.PureComponent{logTTIIfCanRenderItems(){return this.props.canRenderItems&&o.homeTimingLogger.logTTI(t)}componentDidMount(){this.logTTIIfCanRenderItems();const e=this.refs.wrapped,t=e.componentDidUpdate;e.componentDidUpdate=()=>{this.logTTIIfCanRenderItems(),t&&t.call(e)}}render(){return n.default.createElement(e,Object.assign({ref:"wrapped"},this.props))}}}})),define("metaserver/static/js/home/util/post_tti_components",["require","exports","tslib","react","metaserver/static/js/home/post_tti/api","metaserver/static/js/home/recents/components/pending_attachment_list_view"],(function(e,t,i,n,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PostTTIStarredItemFileActions=t.PostTTIRecentsActivityFileActions=t.PostTTIRecentActivityImageAttachments=void 0,n=i.__importStar(n),t.PostTTIRecentActivityImageAttachments=(0,o.PostHomeTTIComponent)({displayName:"PostTTIRecentActivityImageAttachments",preTTIRenderer:({attachments:e})=>n.createElement(r.PendingAttachmentListView,{count:e.length}),getPostTTIRenderer:({AttachmentListView:e,Dimensions:t})=>({attachments:i})=>n.createElement(t,{className:"recents-item__attachments"},({width:t})=>n.createElement(e,{attachments:i,width:t}))}),t.PostTTIRecentsActivityFileActions=(0,o.PostHomeTTIComponent)({displayName:"PostTTIRecentsActivityFileActions",getPostTTIRenderer:({RecentActivityFileActionPost:e})=>({recentItem:t,attachments:i,arialabelledby:o})=>n.createElement(e,{recentItem:t,attachments:i,arialabelledby:o})}),t.PostTTIStarredItemFileActions=(0,o.PostHomeTTIComponent)({displayName:"PostTTIStarredItemFileActions",getPostTTIRenderer:({StarredItemFileActionPost:e})=>({starredItem:t,user:i})=>n.createElement(e,{starredItem:t,user:i})})})),define("metaserver/static/js/starred/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredSource=t.IdTypes=t.StarredActionTypes=t.StarredLoadingState=void 0,t.StarredLoadingState={LOADING:"LOADING",LOAD_SUCCESS:"LOAD_SUCCESS",LOAD_FAILED:"LOAD_FAILED"},t.StarredActionTypes={LOADING:"STARRED_LOADING",SET_STATUS:"STARRED_SET_STATUS",LOAD_FAILURE:"STARRED_LOAD_FAILURE"},t.IdTypes={ENCODED_FILE_OBJ_ID:"ENCODED_FILE_OBJ_ID",EXTERNAL_RESOURCE_ID:"EXTERNAL_RESOURCE_ID",PAPER_ID_PATH:"PAPER_ID_PATH",FQ_PATH:"FQ_PATH"},(function(e){e.HOME_STARRED="HOME_STARRED",e.HOME_RECENTS="HOME_RECENTS",e.BROWSE="BROWSE",e.FILE_VIEWER="FILE_VIEWER",e.SUGGESTED_STARS="SUGGESTED_STARS",e.HOME_TASKS="HOME_TASKS"})(t.StarredSource||(t.StarredSource={}))})),define("metaserver/static/js/home/api",["require","exports","tslib","metaserver/static/js/deprecated_ajax/ajax_jquery","lodash","metaserver/static/js/core/exception","metaserver/static/js/clean/web_timing_logger"],(function(e,t,i,n,o,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logHomeActivity=t.makeRequest=t.now=void 0,o=i.__importStar(o);t.now=()=>Date.now();let a=0,l=0,c=(0,t.now)();t.makeRequest=function(e,{delayRequest:o,isBackground:s,shouldAssertResponse:d}={}){a++;const u=new Promise((d,u)=>i.__awaiter(this,void 0,void 0,(function*(){const m=yield(function(e){return i.__awaiter(this,void 0,void 0,(function*(){const i=c;if(c=(0,t.now)(),e||c-i<40){l++;const e=10+~~(90*Math.random());return yield new Promise(t=>setTimeout(t,e)),l--,e}return 0}))})(!!o),g=(0,t.now)();(s?n.SilentBackgroundRequest:n.WebRequest)(Object.assign({dataType:"json",success:d,error:(i,n,c)=>{if("abort"===n)return;const d=e&&e.url||"no url",h=c?`: '${c}'`:"",p=`makeRequest to '${d}' failed - ${n}${h}`;(0,r.reportStack)(p,{severity:r.SEVERITY.NONCRITICAL,exc_extra:{errorThrown:c,textStatus:n,requestParams:e,delayRequest:o,isBackground:s,requestDelay:m,openRequests:a,delayedRequests:l,requestDuration:(0,t.now)()-g,status:i.status,"exclog.exc_group":`homeapi:${n}:${c}:${d}`}}),u()}},e))})));return u.finally(()=>a--),u};let d={};const u=o.throttle(()=>{o.size(d)>1&&(0,r.reportStack)("Multiple role activities",{severity:r.SEVERITY.NONCRITICAL,exc_extra:d}),Object.keys(d).forEach(e=>{const i=d[e];(0,t.makeRequest)({url:"/home_feed/log_activities",type:"POST",data:{role:e,activities_json:JSON.stringify(o.map(i,"json")),send_ts:(0,t.now)(),page_start_ts:window.performance&&window.performance.timing?window.performance.timing.navigationStart||window.performance.timing.fetchStart:void 0}},{isBackground:!0,delayRequest:!0,shouldAssertResponse:!0}).then(()=>i.forEach(e=>e.resolve()),()=>i.forEach(e=>e.reject()))}),d={}},1e3,{leading:!0,trailing:!0});t.logHomeActivity=function({role:e,eventName:n,extra:r}){return new Promise((a,l)=>i.__awaiter(this,void 0,void 0,(function*(){d[e]=d[e]||[],d[e].push({json:{event_name:n,event_time:(0,t.now)(),extra:o.mapValues(r||{},e=>String(e))},resolve:a,reject:l}),yield(0,s.waitForTTI)(),u()})))}})),define("metaserver/static/js/home/post_tti/api",["require","exports","tslib","react","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/async/loadable","metaserver/static/js/common/rendering"],(function(e,t,i,n,o,r,s){"use strict";function a(){return i.__awaiter(this,void 0,void 0,(function*(){return yield(0,o.waitForTTI)(),yield new Promise((t,i)=>{e(["metaserver/static/js/home/post_tti/interface"],t,i)}).then(i.__importStar)}))}function l(){return i.__awaiter(this,void 0,void 0,(function*(){const e=yield a();return{imports:e,props:window.RUNNING_IN_EDISON?yield e.getPostTTIPropsInEdison():yield e.getPostTTIProps()}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.LazyFileUploader=t.PostHomeTTIComponentWithProps=t.waitForHomeTTIWithProps=t.PostHomeTTIComponent=t.waitForHomeTTI=void 0,n=i.__importDefault(n),t.waitForHomeTTI=a,t.PostHomeTTIComponent=function(e){const{getPostTTIRenderer:t,preTTIRenderer:n,displayName:o}=e;return(0,r.Loadable)({displayName:`PostHomeTTIComponent(${o})`,loader:()=>i.__awaiter(this,void 0,void 0,(function*(){return t(yield a())})),loading:n})},t.waitForHomeTTIWithProps=l;class c extends n.default.PureComponent{render(){return null}}c.displayName="NullComponent",t.PostHomeTTIComponentWithProps=function(e){const{getPostTTIRenderer:t,preTTIRenderer:o,displayName:s}=e;return(0,r.Loadable)({displayName:`PostHomeTTIComponentWithProps(${s})`,loader:()=>i.__awaiter(this,void 0,void 0,(function*(){const e=yield l();return(yield t(e))||(()=>n.default.createElement(c,null))})),loading:o})};const d=n.default.lazy(()=>i.__awaiter(void 0,void 0,void 0,(function*(){const{FileUploader:t}=yield new Promise((t,i)=>{e(["metaserver/static/js/home/roots/file_uploader"],t,i)}).then(i.__importStar);return{default:t}})));t.LazyFileUploader=e=>n.default.createElement(s.LazySuspense,null,n.default.createElement(d,Object.assign({},e)))})),define("metaserver/static/js/home/util/conditional",["require","exports","tslib","react","metaserver/static/js/async/loadable","metaserver/static/js/home/post_tti/api","metaserver/static/js/home/store","metaserver/static/js/home/constants","metaserver/static/js/home/util/logging/timing_logger","metaserver/static/js/core/exception","metaserver/static/js/flux/dispatcher"],(function(e,t,i,n,o,r,s,a,l,c,d){"use strict";function u(e){return e?(e.initPrefetch(),e.componentClass):null}Object.defineProperty(t,"__esModule",{value:!0}),t.homeConditionalSection=t.IS_PROD=void 0,n=i.__importDefault(n),t.IS_PROD=!0,t.homeConditionalSection=function(e){const{section:m,syncLoader:g,asyncLoader:h,loading:p}=e;let _=null,f=a.ConditionalSectionLoadingPreference.UNKNOWN;return(0,s.getHomeStore)(),d.Dispatcher.dispatch({type:a.HomeActionTypes.DECLARE_CONDITIONAL_SECTION,payload:{section:m,didInitializeSynchronously:e=>{if(f=e,e===a.ConditionalSectionLoadingPreference.UNKNOWN)return!1;if(e===a.ConditionalSectionLoadingPreference.DO_NOT_LOAD)return(0,s.isHomeSection)(m)&&l.homeTimingLogger.logSkippedSection(m),!1;const t=e===a.ConditionalSectionLoadingPreference.POST_TTI;if(t)(0,s.isHomeSection)(m)&&l.homeTimingLogger.logSkippedSection(m);else{try{_=u(g())}catch(e){}if(_)return!0}const c=!t&&(0,s.isBlockingSection)(m),v=()=>i.__awaiter(this,void 0,void 0,(function*(){t&&(yield(0,r.waitForHomeTTI)());const e=u(yield h());return c&&(_=e),d.Dispatcher.dispatch({type:a.HomeActionTypes.LOADED_ASYNC_CONDITIONAL_SECTION,payload:{section:m}}),e}));if(c)v();else{const e=p;_=(0,o.Loadable)({loader:v,loading:e?t=>t.canRenderItems?"function"==typeof e?n.default.createElement(e,Object.assign({},t)):e:null:void 0})}return!1}}}),e=>((f===a.ConditionalSectionLoadingPreference.UNKNOWN||!_&&f===a.ConditionalSectionLoadingPreference.IMMEDIATE&&(0,s.isBlockingSection)(m)&&t.IS_PROD)&&(0,c.reportStack)("Premature render",{severity:c.SEVERITY.CRITICAL,exc_extra:{section:m,loadingPreference:f,isBlockingSection:(0,s.isBlockingSection)(m)}}),_?n.default.createElement(_,Object.assign({},e)):null)}})),define("metaserver/static/js/home/util/logging/activity_logger",["require","exports","metaserver/static/js/home/api","metaserver/static/js/home/store","metaserver/static/js/home/constants"],(function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.homeActivityLogger=t.HomeActivityLogger=void 0;class r{logClickShowAll(e,t){return(0,i.logHomeActivity)({eventName:o.LoggingTypes.CLICK_SHOW_ALL,role:(0,n.getHomeStore)().getRole(),extra:{component_name:e,should_show_all:t,home_page_type:(0,n.getHomeStore)().getPageType(location.pathname)}})}logHomePageShown(){return(0,i.logHomeActivity)({eventName:o.LoggingTypes.HOME_PAGE_SHOWN,role:(0,n.getHomeStore)().getRole(),extra:{url:s(),home_page_type:(0,n.getHomeStore)().getPageType(location.pathname)}})}logStarredShown(e,t,r){return(0,i.logHomeActivity)({eventName:o.LoggingTypes.STARRED_SHOWN,role:(0,n.getHomeStore)().getRole(),extra:{num_items:e,is_hidden:!1,has_hidden_rows:t,has_more:r,url:s(),home_page_type:(0,n.getHomeStore)().getPageType(location.pathname)}})}logRecentsShown(e,t){return(0,i.logHomeActivity)({eventName:o.LoggingTypes.RECENTS_SHOWN,role:(0,n.getHomeStore)().getRole(),extra:{num_items:e,is_hidden:t,url:s(),home_page_type:(0,n.getHomeStore)().getPageType(location.pathname)}})}logShowHideSection(e,t){return(0,i.logHomeActivity)({eventName:t?o.LoggingTypes.HIDE_SECTION:o.LoggingTypes.UNHIDE_SECTION,role:(0,n.getHomeStore)().getRole(),extra:{section_name:e,home_page_type:(0,n.getHomeStore)().getPageType(location.pathname)}})}logRecentsAction(e,t,r,s,a,l,c,d,u,m){const g={action_taken:e,scope:t,display_type:a,is_dir:l,item_number:r,sprite:s,subgroup_position:c,home_page_type:(0,n.getHomeStore)().getPageType(location.pathname),component_name:m};return d&&u&&(g.id_type=d,g.resource_id=u),(0,i.logHomeActivity)({eventName:o.LoggingTypes.RECENTS_ITEM_ACTION,role:(0,n.getHomeStore)().getRole(),extra:g})}logSelectedFilesStarredEvent(e,t){return(0,i.logHomeActivity)({eventName:e,role:(0,n.getHomeStore)().getRole(),extra:{num_selected_items:t,home_page_type:(0,n.getHomeStore)().getPageType(location.pathname),source:"HOME_FILES_TABLE_STARRED_TOP"}})}logStarredEvent(e,t,o,r){return(0,i.logHomeActivity)({eventName:e,role:(0,n.getHomeStore)().getRole(),extra:{resource_id:t,resource_type:o,position:r,home_page_type:(0,n.getHomeStore)().getPageType(location.pathname),source:"HOME_FILES_TABLE_STARRED"}})}logOpenStarredItem(e,t,r){return(0,i.logHomeActivity)({eventName:o.LoggingTypes.OPEN_STARRED_ITEM,role:(0,n.getHomeStore)().getRole(),extra:{resource_id:e,resource_type:t,position:r,home_page_type:(0,n.getHomeStore)().getPageType(location.pathname)}})}logUndoUnstarItem(e,t,r){return(0,i.logHomeActivity)({eventName:o.LoggingTypes.UNDO_UNSTAR_ITEM,role:(0,n.getHomeStore)().getRole(),extra:{resource_id:e,resource_type:t,position:r,home_page_type:(0,n.getHomeStore)().getPageType(location.pathname)}})}logClickStarOverflowShare(e,t,r){return(0,i.logHomeActivity)({eventName:o.LoggingTypes.CLICK_STAR_OVERFLOW_SHARE,role:(0,n.getHomeStore)().getRole(),extra:{resource_id:e,resource_type:t,position:r,home_page_type:(0,n.getHomeStore)().getPageType(location.pathname)}})}logClickRightMenu(e,t){return(0,i.logHomeActivity)({eventName:e,role:(0,n.getHomeStore)().getRole(),extra:Object.assign({home_page_type:(0,n.getHomeStore)().getPageType(location.pathname),click_origin:"right_menu"},t)})}logClickFilesActionBar(e,t){return(0,i.logHomeActivity)({eventName:e,role:(0,n.getHomeStore)().getRole(),extra:Object.assign({home_page_type:(0,n.getHomeStore)().getPageType(location.pathname),click_origin:"files_action_bar"},t)})}logCreateNewFile(e){return(0,i.logHomeActivity)({eventName:e,role:(0,n.getHomeStore)().getRole(),extra:{home_page_type:(0,n.getHomeStore)().getPageType(location.pathname)}})}}function s(){return-1!==location.host.indexOf("dropbox.com")?location.pathname:"unknown"}t.HomeActivityLogger=r,t.homeActivityLogger=new r})),define("metaserver/static/js/home/util/logging/availability_logger_common",["require","exports","metaserver/static/js/home/constants"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withHomePrefix=t.isPendingPrefetch=t.HOME_PREFETCH_TYPE_TO_INFO=void 0;const n=[i.ConditionalSectionLoadingPreference.IMMEDIATE,i.ConditionalSectionLoadingPreference.POST_TTI];t.HOME_PREFETCH_TYPE_TO_INFO={[i.HomePrefetchTypes.RETRIEVE_STARRED]:{fragment:"retrieve_starred",handle:"__REGISTER_RETRIEVE_STARRED_PRELOAD_HANDLER",section:i.HomeSections.STARRED,conditionalSection:i.HomeSections.STARRED},[i.HomePrefetchTypes.RECENTS_JSON]:{fragment:"recents/json",handle:"__REGISTER_RECENTS_PRELOAD_HANDLER",section:i.HomeSections.RECENTS,conditionalSection:i.HomeSections.RECENTS},[i.HomePrefetchTypes.RETRIEVE_PAPER_RECENTS]:{fragment:"retrieve_paper_recents",handle:"__REGISTER_PAPER_RECENTS_PRELOAD_HANDLER",section:i.HomeSections.RECENTS,conditionalSection:i.ConditionalSections.PAPER_RECENTS},[i.HomePrefetchTypes.GET_SUGGESTED]:{fragment:"get_suggested",handle:"__REGISTER_SUGGEST_GRID_PRELOAD_HANDLER",section:i.HomeSections.SUGGEST,conditionalSection:i.HomeSections.SUGGEST,isOptional:!0}},t.isPendingPrefetch=function(e,{success:t,info:i}){return void 0===t&&(!i.isOptional||n.indexOf(e.getSectionLoadingPreference(i.conditionalSection))>=0)},t.withHomePrefix=function(e){return`home_${e}`}})),define("metaserver/static/js/home/util/logging/availability_logger",["require","exports","tslib","lodash","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/home/store","metaserver/static/js/core/exception","metaserver/static/js/home/util/prefetch_handler","metaserver/static/js/home/util/logging/availability_logger_common","metaserver/static/js/home/post_tti/api"],(function(e,t,i,n,o,r,s,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHomeAvailabilityLogger=t.HomeAvailabilityLogger=void 0,n=i.__importStar(n);class m{constructor(){this.didLog=!1,this.sectionToTTData={},this.sectionToTTI={},this.sectionToIsSkipped={},this.typeToExecutionData=n.mapValues(d.HOME_PREFETCH_TYPE_TO_INFO,e=>({info:e,homeTiming:{}}))}logPrefetch(e,t){const i=this.typeToExecutionData[e];if(void 0===i.success){const n={type:r.HomeActionTypes.HOME_PREFETCH_RECEIVED_DATA,payload:{homePrefetchType:e}};i.homeTiming.asynchronous?o.Dispatcher.dispatch(n):(0,a.getHomeStore)().__onDispatch({action:n}),i.success=t,this.pendingPrefetchesCount&&this.pendingPrefetchesCount--,this.logIfPossible()}}logIfPossible(){!this.didLog&&void 0!==this.pendingPrefetchesCount&&this.pendingPrefetchesCount<=0&&((0,u.waitForHomeTTI)().then(({logHomeAvailability:e})=>e({typeToExecutionData:this.typeToExecutionData,sectionToTTData:this.sectionToTTData,sectionToTTI:this.sectionToTTI,sectionToIsSkipped:this.sectionToIsSkipped})),this.didLog=!0)}logTTData(e){this.sectionToTTData.hasOwnProperty(e)||(this.sectionToTTData[e]=(0,s.time_since_start)(),this.logIfPossible())}logTTI(e,t,i){if(!this.sectionToTTI.hasOwnProperty(e)&&(this.sectionToTTI[e]=(0,s.time_since_start)(),this.sectionToIsSkipped[e]=Number(t),i)){this.pendingPrefetchesCount=0;const e=(0,a.getHomeStore)();n.map(this.typeToExecutionData,t=>{(0,d.isPendingPrefetch)(e,t)&&this.pendingPrefetchesCount++}),this.logIfPossible()}}handlePrefetch(e,t){const{handle:i,conditionalSection:n}=d.HOME_PREFETCH_TYPE_TO_INFO[e],o=()=>this.handlePrefetchImpl(e,i,t);(0,a.getHomeStore)().getSectionLoadingPreference(n)===r.ConditionalSectionLoadingPreference.POST_TTI?(0,u.waitForHomeTTI)().then(o):o()}handlePrefetchImpl(e,t,i){const o=(0,c.getPrefetchHandler)(t),r=this.typeToExecutionData[e],{homeTiming:a,didInvoke:d}=r,u=t=>{(0,l.reportStack)(`prefetch for ${e} failed`,{severity:l.SEVERITY.CRITICAL,exc_extra:{error:t,type:e},silent:!0}),this.logPrefetch(e,!1)};if(o){if(!d){r.didInvoke=!0,a.register_prefetch_callback=(0,s.time_since_start)();const t=t=>{try{a.json_parse_start=(0,s.time_since_start)();const o=JSON.parse(t);a.json_parse_end=(0,s.time_since_start)(),a.json_string_size=16*t.length,n.isEqual(o,{})?u("payload is {}"):(this.logPrefetch(e,!0),a.payload_processing_start=(0,s.time_since_start)(),i(o),a.payload_processing_end=(0,s.time_since_start)())}catch(e){u(e)}};a.asynchronous=(0,c.handlePrefetch)(o,t,u)?0:1}}else u("no prefetch handler")}}t.HomeAvailabilityLogger=m;let g=null;t.getHomeAvailabilityLogger=function(){return g=g||new m,g}})),define("metaserver/static/js/home/util/logging/timing_logger",["require","exports","tslib","metaserver/static/js/clean/js_client_stopwatch","lodash","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/home/util/logging/timing_state","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/core/exception","metaserver/static/js/home/util/logging/availability_logger","metaserver/static/js/home/util/logging/availability_logger_common"],(function(e,t,i,n,o,r,s,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.homeTimingLogger=t._HomeTimingLogger=void 0,o=i.__importStar(o),r=i.__importStar(r);const u=o.once(a.homeActivityLogger.logHomePageShown);class m{constructor(){this.timingStates=new s.HomeTimingStates,this.activate=o.once(()=>n.JSStopwatch.create_stopwatch_if_not_exist("home_access_tti"))}validateActivated(e,t){return!!n.JSStopwatch.stopwatch_exists("home_access_tti")||((0,l.reportStack)(`Did not activate when ${e} before logging ${t}`,{severity:l.SEVERITY.NONCRITICAL}),!1)}logTTData(e){if(this.validateActivated(e,s.HomeTimingState.TTDATA)){if(this.timingStates.progressState(e,s.HomeTimingState.TTDATA))return this.timingStates.haveAllSectionsReachedState(s.HomeTimingState.TTDATA)&&r.log_js_modules_fetched_data_required_for_tti(),(0,c.getHomeAvailabilityLogger)().logTTData(e),!0}return!1}logSkippedSection(e){this.activate(),this.logTTData(e),this.logTTI(e,!0)}logTTI(e,t=!1){if(this.validateActivated(e,s.HomeTimingState.TTI)){if(this.timingStates.progressState(e,s.HomeTimingState.TTI)){u(),n.JSStopwatch.recordTrace((0,d.withHomePrefix)(e),{stopwatchName:"home_access_tti"});const i=this.timingStates.haveAllSectionsReachedState(s.HomeTimingState.TTI);return i&&(r.mark_time_to_interactive(),n.JSStopwatch.flush_current_data()),(0,c.getHomeAvailabilityLogger)().logTTI(e,t,i),!0}}return!1}}t._HomeTimingLogger=m,t.homeTimingLogger=new m})),define("metaserver/static/js/home/util/logging/timing_state",["require","exports","tslib","lodash","metaserver/static/js/home/constants"],(function(e,t,i,n,o){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTimingStates=t.HomeTimingState=void 0,n=i.__importStar(n),(function(e){e[e.INIT=0]="INIT",e[e.TTDATA=1]="TTDATA",e[e.TTI=2]="TTI"})(r=t.HomeTimingState||(t.HomeTimingState={}));t.HomeTimingStates=class{constructor(){this.homeSectionToState={},n.values(o.HomeSections).forEach(e=>this.homeSectionToState[e]=r.INIT)}progressState(e,t){return this.homeSectionToState[e]+1===t&&(this.homeSectionToState[e]=t,!0)}haveAllSectionsReachedState(e){return n.every(this.homeSectionToState,t=>t>=e)}}})),define("metaserver/static/js/starred/id_type_pair",["require","exports","tslib","metaserver/static/js/filepath/filepath","metaserver/static/js/home/resource_id_types"],(function(e,t,i,n,o){"use strict";function r(e){return!!e.file_id}function s(e){return!!e.pad_id}function a(e){return!!e.folder_id}function l(e){return!!e.fq_path}function c(e){return!!e.filename}Object.defineProperty(t,"__esModule",{value:!0}),t.itemNameFromStarrableItem=t.idTypePairFromStarrableItem=t.idTypePairToString=void 0,n=i.__importStar(n),t.idTypePairToString=function(e){return e.type+":"+e.id},t.idTypePairFromStarrableItem=function(e){return r(e)||c(e)?{id:e.file_id,type:o.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID}:s(e)?{id:e.pad_id,type:o.HOME_RESOURCE_ID_TYPE.PAPER_DOCUMENT_ID}:a(e)?{id:e.folder_id,type:o.HOME_RESOURCE_ID_TYPE.PAPER_FOLDER_ID}:l(e)?{id:e.fq_path,type:o.HOME_RESOURCE_ID_TYPE.FQ_PATH}:e},t.itemNameFromStarrableItem=function(e){return r(e)||l(e)?n.filename(e.fq_path):s(e)?e.title:a(e)?e.name:c(e)?e.filename:e}})),define("metaserver/static/prod_assets_web_modules/@tanstack/react-table",["exports","react"],(function(e,t){"use strict";var i=(function(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(i){if("default"!==i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}})),t.default=e,Object.freeze(t)})(t);function n(e,t){return"function"==typeof e?e(t):e}function o(e,t){return i=>{t.setState(t=>({...t,[e]:n(i,t[e])}))}}function r(e){return e instanceof Function}function s(e,t){const i=[],n=e=>{e.forEach(e=>{i.push(e);const o=t(e);null!=o&&o.length&&n(o)})};return n(e),i}function a(e,t,i){let n,o=[];return()=>{let r;i.key&&i.debug&&(r=Date.now());const s=e();if(s.length===o.length&&!s.some((e,t)=>o[t]!==e))return n;let a;if(o=s,i.key&&i.debug&&(a=Date.now()),n=t(...s),null==i||null==i.onChange||i.onChange(n),i.key&&i.debug&&null!=i&&i.debug()){const e=Math.round(100*(Date.now()-r))/100,t=Math.round(100*(Date.now()-a))/100,n=t/16,o=(e,t)=>{for(e=String(e);e.length<t;)e=" "+e;return e};console.info("%c⏱ "+o(t,5)+" /"+o(e,5)+" ms","\n            font-size: .6rem;\n            font-weight: bold;\n            color: hsl("+Math.max(0,Math.min(120-120*n,120))+"deg 100% 31%);",null==i?void 0:i.key)}return n}}function l(e,t,i,n){var o,r;const s={...e._getDefaultColumnDef(),...t};let l,c=null!=(o=null!=(r=s.id)?r:s.accessorKey)?o:"string"==typeof s.header?s.header:void 0;if(s.accessorFn?l=s.accessorFn:s.accessorKey&&(l=e=>e[s.accessorKey]),!c)throw new Error;let d={id:""+String(c),accessorFn:l,parent:n,depth:i,columnDef:s,columns:[],getFlatColumns:a(()=>[!0],()=>{var e;return[d,...null==(e=d.columns)?void 0:e.flatMap(e=>e.getFlatColumns())]},{key:"column.getFlatColumns",debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugColumns}}),getLeafColumns:a(()=>[e._getOrderColumnsFn()],e=>{var t;if(null!=(t=d.columns)&&t.length){let t=d.columns.flatMap(e=>e.getLeafColumns());return e(t)}return[d]},{key:"column.getLeafColumns",debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugColumns}})};return d=e._features.reduce((t,i)=>Object.assign(t,null==i.createColumn?void 0:i.createColumn(d,e)),d),d}function c(e,t,i){var n;let o={id:null!=(n=i.id)?n:t.id,column:t,index:i.index,isPlaceholder:!!i.isPlaceholder,placeholderId:i.placeholderId,depth:i.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const e=[],t=i=>{i.subHeaders&&i.subHeaders.length&&i.subHeaders.map(t),e.push(i)};return t(o),e},getContext:()=>({table:e,header:o,column:t})};return e._features.forEach(t=>{Object.assign(o,null==t.createHeader?void 0:t.createHeader(o,e))}),o}const d={createTable:e=>({getHeaderGroups:a(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,i,n,o)=>{var r,s;const a=null!=(r=null==n?void 0:n.map(e=>i.find(t=>t.id===e)).filter(Boolean))?r:[],l=null!=(s=null==o?void 0:o.map(e=>i.find(t=>t.id===e)).filter(Boolean))?s:[];return u(t,[...a,...i.filter(e=>!(null!=n&&n.includes(e.id)||null!=o&&o.includes(e.id))),...l],e)},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getCenterHeaderGroups:a(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,i,n,o)=>u(t,i=i.filter(e=>!(null!=n&&n.includes(e.id)||null!=o&&o.includes(e.id))),e,"center"),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getLeftHeaderGroups:a(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(t,i,n)=>{var o;return u(t,null!=(o=null==n?void 0:n.map(e=>i.find(t=>t.id===e)).filter(Boolean))?o:[],e,"left")},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getRightHeaderGroups:a(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(t,i,n)=>{var o;return u(t,null!=(o=null==n?void 0:n.map(e=>i.find(t=>t.id===e)).filter(Boolean))?o:[],e,"right")},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getFooterGroups:a(()=>[e.getHeaderGroups()],e=>[...e].reverse(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getLeftFooterGroups:a(()=>[e.getLeftHeaderGroups()],e=>[...e].reverse(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getCenterFooterGroups:a(()=>[e.getCenterHeaderGroups()],e=>[...e].reverse(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getRightFooterGroups:a(()=>[e.getRightHeaderGroups()],e=>[...e].reverse(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getFlatHeaders:a(()=>[e.getHeaderGroups()],e=>e.map(e=>e.headers).flat(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getLeftFlatHeaders:a(()=>[e.getLeftHeaderGroups()],e=>e.map(e=>e.headers).flat(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getCenterFlatHeaders:a(()=>[e.getCenterHeaderGroups()],e=>e.map(e=>e.headers).flat(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getRightFlatHeaders:a(()=>[e.getRightHeaderGroups()],e=>e.map(e=>e.headers).flat(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getCenterLeafHeaders:a(()=>[e.getCenterFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getLeftLeafHeaders:a(()=>[e.getLeftFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getRightLeafHeaders:a(()=>[e.getRightFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getLeafHeaders:a(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(e,t,i)=>{var n,o,r,s,a,l;return[...null!=(n=null==(o=e[0])?void 0:o.headers)?n:[],...null!=(r=null==(s=t[0])?void 0:s.headers)?r:[],...null!=(a=null==(l=i[0])?void 0:l.headers)?a:[]].map(e=>e.getLeafHeaders()).flat()},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}})})};function u(e,t,i,n){var o,r;let s=0;const a=function(e,t){void 0===t&&(t=1),s=Math.max(s,t),e.filter(e=>e.getIsVisible()).forEach(e=>{var i;null!=(i=e.columns)&&i.length&&a(e.columns,t+1)},0)};a(e);let l=[];const d=(e,t)=>{const o={depth:t,id:[n,""+t].filter(Boolean).join("_"),headers:[]},r=[];e.forEach(e=>{const s=[...r].reverse()[0];let a,l=!1;if(e.column.depth===o.depth&&e.column.parent?a=e.column.parent:(a=e.column,l=!0),s&&(null==s?void 0:s.column)===a)s.subHeaders.push(e);else{const o=c(i,a,{id:[n,t,a.id,null==e?void 0:e.id].filter(Boolean).join("_"),isPlaceholder:l,placeholderId:l?""+r.filter(e=>e.column===a).length:void 0,depth:t,index:r.length});o.subHeaders.push(e),r.push(o)}o.headers.push(e),e.headerGroup=o}),l.push(o),t>0&&d(r,t-1)},u=t.map((e,t)=>c(i,e,{depth:s,index:t}));d(u,s-1),l.reverse();const m=e=>e.filter(e=>e.column.getIsVisible()).map(e=>{let t=0,i=0,n=[0];return e.subHeaders&&e.subHeaders.length?(n=[],m(e.subHeaders).forEach(e=>{let{colSpan:i,rowSpan:o}=e;t+=i,n.push(o)})):t=1,i+=Math.min(...n),e.colSpan=t,e.rowSpan=i,{colSpan:t,rowSpan:i}});return m(null!=(o=null==(r=l[0])?void 0:r.headers)?o:[]),l}const m={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},g={getDefaultColumnDef:()=>m,getInitialState:e=>({columnSizing:{},columnSizingInfo:{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]},...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",onColumnSizingChange:o("columnSizing",e),onColumnSizingInfoChange:o("columnSizingInfo",e)}),createColumn:(e,t)=>({getSize:()=>{var i,n,o;const r=t.getState().columnSizing[e.id];return Math.min(Math.max(null!=(i=e.columnDef.minSize)?i:m.minSize,null!=(n=null!=r?r:e.columnDef.size)?n:m.size),null!=(o=e.columnDef.maxSize)?o:m.maxSize)},getStart:i=>{const n=i?"left"===i?t.getLeftVisibleLeafColumns():t.getRightVisibleLeafColumns():t.getVisibleLeafColumns(),o=n.findIndex(t=>t.id===e.id);if(o>0){const e=n[o-1];return e.getStart(i)+e.getSize()}return 0},resetSize:()=>{t.setColumnSizing(t=>{let{[e.id]:i,...n}=t;return n})},getCanResize:()=>{var i,n;return(null==(i=e.columnDef.enableResizing)||i)&&(null==(n=t.options.enableColumnResizing)||n)},getIsResizing:()=>t.getState().columnSizingInfo.isResizingColumn===e.id}),createHeader:(e,t)=>({getSize:()=>{let t=0;const i=e=>{var n;e.subHeaders.length?e.subHeaders.forEach(i):t+=null!=(n=e.column.getSize())?n:0};return i(e),t},getStart:()=>{if(e.index>0){const t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},getResizeHandler:()=>{const i=t.getColumn(e.column.id),n=i.getCanResize();return o=>{if(!n)return;if(null==o.persist||o.persist(),_(o)&&o.touches&&o.touches.length>1)return;const r=e.getSize(),s=e?e.getLeafHeaders().map(e=>[e.column.id,e.column.getSize()]):[[i.id,i.getSize()]],a=_(o)?Math.round(o.touches[0].clientX):o.clientX,l=(e,i)=>{if("number"!=typeof i)return;let n={};t.setColumnSizingInfo(e=>{var t,o;const r=i-(null!=(t=null==e?void 0:e.startOffset)?t:0),s=Math.max(r/(null!=(o=null==e?void 0:e.startSize)?o:0),-.999999);return e.columnSizingStart.forEach(e=>{let[t,i]=e;n[t]=Math.round(100*Math.max(i+i*s,0))/100}),{...e,deltaOffset:r,deltaPercentage:s}}),"onChange"!==t.options.columnResizeMode&&"end"!==e||t.setColumnSizing(e=>({...e,...n}))},c={moveHandler:e=>{return t=e.clientX,l("move",t);var t},upHandler:e=>{var i;document.removeEventListener("mousemove",c.moveHandler),document.removeEventListener("mouseup",c.upHandler),i=e.clientX,l("end",i),t.setColumnSizingInfo(e=>({...e,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))}},d=!!p()&&{passive:!1};_(o)||(document.addEventListener("mousemove",c.moveHandler,d),document.addEventListener("mouseup",c.upHandler,d)),t.setColumnSizingInfo(e=>({...e,startOffset:a,startSize:r,deltaOffset:0,deltaPercentage:0,columnSizingStart:s,isResizingColumn:i.id}))}}}),createTable:e=>({setColumnSizing:t=>null==e.options.onColumnSizingChange?void 0:e.options.onColumnSizingChange(t),setColumnSizingInfo:t=>null==e.options.onColumnSizingInfoChange?void 0:e.options.onColumnSizingInfoChange(t),resetColumnSizing:t=>{var i;e.setColumnSizing(t?{}:null!=(i=e.initialState.columnSizing)?i:{})},resetHeaderSizeInfo:t=>{var i;e.setColumnSizingInfo(t?{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}:null!=(i=e.initialState.columnSizingInfo)?i:{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]})},getTotalSize:()=>{var t,i;return null!=(t=null==(i=e.getHeaderGroups()[0])?void 0:i.headers.reduce((e,t)=>e+t.getSize(),0))?t:0},getLeftTotalSize:()=>{var t,i;return null!=(t=null==(i=e.getLeftHeaderGroups()[0])?void 0:i.headers.reduce((e,t)=>e+t.getSize(),0))?t:0},getCenterTotalSize:()=>{var t,i;return null!=(t=null==(i=e.getCenterHeaderGroups()[0])?void 0:i.headers.reduce((e,t)=>e+t.getSize(),0))?t:0},getRightTotalSize:()=>{var t,i;return null!=(t=null==(i=e.getRightHeaderGroups()[0])?void 0:i.headers.reduce((e,t)=>e+t.getSize(),0))?t:0}})};let h=null;function p(){if("boolean"==typeof h)return h;let e=!1;try{const t={get passive(){return e=!0,!1}},i=()=>{};window.addEventListener("test",i,t),window.removeEventListener("test",i)}catch(t){e=!1}return h=e,h}function _(e){return"touchstart"===e.type}const f={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:o("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let t=!1,i=!1;return{_autoResetExpanded:()=>{var n,o;if(t){if(null!=(n=null!=(o=e.options.autoResetAll)?o:e.options.autoResetExpanded)?n:!e.options.manualExpanding){if(i)return;i=!0,e._queue(()=>{e.resetExpanded(),i=!1})}}else e._queue(()=>{t=!0})},setExpanded:t=>null==e.options.onExpandedChange?void 0:e.options.onExpandedChange(t),toggleAllRowsExpanded:t=>{(null!=t?t:!e.getIsAllRowsExpanded())?e.setExpanded(!0):e.setExpanded({})},resetExpanded:t=>{var i,n;e.setExpanded(t?{}:null!=(i=null==(n=e.initialState)?void 0:n.expanded)?i:{})},getCanSomeRowsExpand:()=>e.getRowModel().flatRows.some(e=>e.getCanExpand()),getToggleAllRowsExpandedHandler:()=>t=>{null==t.persist||t.persist(),e.toggleAllRowsExpanded()},getIsSomeRowsExpanded:()=>{const t=e.getState().expanded;return!0===t||Object.values(t).some(Boolean)},getIsAllRowsExpanded:()=>{const t=e.getState().expanded;return"boolean"==typeof t?!0===t:!!Object.keys(t).length&&!e.getRowModel().flatRows.some(e=>e.getIsExpanded())},getExpandedDepth:()=>{let t=0;return(!0===e.getState().expanded?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(e=>{const i=e.split(".");t=Math.max(t,i.length)}),t},getPreExpandedRowModel:()=>e.getSortedRowModel(),getExpandedRowModel:()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())}},createRow:(e,t)=>({toggleExpanded:i=>{t.setExpanded(n=>{var o;const r=!0===n||!(null==n||!n[e.id]);let s={};if(!0===n?Object.keys(t.getRowModel().rowsById).forEach(e=>{s[e]=!0}):s=n,i=null!=(o=i)?o:!r,!r&&i)return{...s,[e.id]:!0};if(r&&!i){const{[e.id]:t,...i}=s;return i}return n})},getIsExpanded:()=>{var i;const n=t.getState().expanded;return!!(null!=(i=null==t.options.getIsRowExpanded?void 0:t.options.getIsRowExpanded(e))?i:!0===n||(null==n?void 0:n[e.id]))},getCanExpand:()=>{var i,n,o;return(null==(i=null==t.options.getRowCanExpand?void 0:t.options.getRowCanExpand(e))||i)&&(null==(n=t.options.enableExpanding)||n)&&!(null==(o=e.subRows)||!o.length)},getToggleExpandedHandler:()=>{const t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}})},v=(e,t,i)=>{var n;const o=i.toLowerCase();return null==(n=e.getValue(t))?void 0:n.toLowerCase().includes(o)};v.autoRemove=e=>w(e);const S=(e,t,i)=>{var n;return null==(n=e.getValue(t))?void 0:n.includes(i)};S.autoRemove=e=>w(e);const E=(e,t,i)=>{var n;return(null==(n=e.getValue(t))?void 0:n.toLowerCase())===i.toLowerCase()};E.autoRemove=e=>w(e);const I=(e,t,i)=>{var n;return null==(n=e.getValue(t))?void 0:n.includes(i)};I.autoRemove=e=>w(e)||!(null!=e&&e.length);const T=(e,t,i)=>!i.some(i=>{var n;return!(null!=(n=e.getValue(t))&&n.includes(i))});T.autoRemove=e=>w(e)||!(null!=e&&e.length);const R=(e,t,i)=>i.some(i=>{var n;return null==(n=e.getValue(t))?void 0:n.includes(i)});R.autoRemove=e=>w(e)||!(null!=e&&e.length);const y=(e,t,i)=>e.getValue(t)===i;y.autoRemove=e=>w(e);const A=(e,t,i)=>e.getValue(t)==i;A.autoRemove=e=>w(e);const C=(e,t,i)=>{let[n,o]=i;const r=e.getValue(t);return r>=n&&r<=o};C.resolveFilterValue=e=>{let[t,i]=e,n="number"!=typeof t?parseFloat(t):t,o="number"!=typeof i?parseFloat(i):i,r=null===t||Number.isNaN(n)?-1/0:n,s=null===i||Number.isNaN(o)?1/0:o;if(r>s){const e=r;r=s,s=e}return[r,s]},C.autoRemove=e=>w(e)||w(e[0])&&w(e[1]);const b={includesString:v,includesStringSensitive:S,equalsString:E,arrIncludes:I,arrIncludesAll:T,arrIncludesSome:R,equals:y,weakEquals:A,inNumberRange:C};function w(e){return null==e||""===e}const P={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],globalFilter:void 0,...e}),getDefaultOptions:e=>({onColumnFiltersChange:o("columnFilters",e),onGlobalFilterChange:o("globalFilter",e),filterFromLeafRows:!1,globalFilterFn:"auto",getColumnCanGlobalFilter:t=>{var i,n;return"string"==typeof(null==(i=e.getCoreRowModel().flatRows[0])||null==(n=i._getAllCellsByColumnId()[t.id])?void 0:n.getValue())}}),createColumn:(e,t)=>({getAutoFilterFn:()=>{const i=t.getCoreRowModel().flatRows[0],n=null==i?void 0:i.getValue(e.id);return"string"==typeof n?b.includesString:"number"==typeof n?b.inNumberRange:"boolean"==typeof n||null!==n&&"object"==typeof n?b.equals:Array.isArray(n)?b.arrIncludes:b.weakEquals},getFilterFn:()=>r(e.columnDef.filterFn)?e.columnDef.filterFn:"auto"===e.columnDef.filterFn?e.getAutoFilterFn():b[e.columnDef.filterFn],getCanFilter:()=>{var i,n,o;return(null==(i=e.columnDef.enableColumnFilter)||i)&&(null==(n=t.options.enableColumnFilters)||n)&&(null==(o=t.options.enableFilters)||o)&&!!e.accessorFn},getCanGlobalFilter:()=>{var i,n,o,r;return(null==(i=e.columnDef.enableGlobalFilter)||i)&&(null==(n=t.options.enableGlobalFilter)||n)&&(null==(o=t.options.enableFilters)||o)&&(null==(r=null==t.options.getColumnCanGlobalFilter?void 0:t.options.getColumnCanGlobalFilter(e))||r)&&!!e.accessorFn},getIsFiltered:()=>e.getFilterIndex()>-1,getFilterValue:()=>{var i,n;return null==(i=t.getState().columnFilters)||null==(n=i.find(t=>t.id===e.id))?void 0:n.value},getFilterIndex:()=>{var i,n;return null!=(i=null==(n=t.getState().columnFilters)?void 0:n.findIndex(t=>t.id===e.id))?i:-1},setFilterValue:i=>{t.setColumnFilters(t=>{const o=e.getFilterFn(),r=null==t?void 0:t.find(t=>t.id===e.id),s=n(i,r?r.value:void 0);var a;if(D(o,s,e))return null!=(a=null==t?void 0:t.filter(t=>t.id!==e.id))?a:[];const l={id:e.id,value:s};var c;return r?null!=(c=null==t?void 0:t.map(t=>t.id===e.id?l:t))?c:[]:null!=t&&t.length?[...t,l]:[l]})},_getFacetedRowModel:t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,e.id),getFacetedRowModel:()=>e._getFacetedRowModel?e._getFacetedRowModel():t.getPreFilteredRowModel(),_getFacetedUniqueValues:t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,e.id),getFacetedUniqueValues:()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,_getFacetedMinMaxValues:t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,e.id),getFacetedMinMaxValues:()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}),createRow:(e,t)=>({columnFilters:{},columnFiltersMeta:{}}),createTable:e=>({getGlobalAutoFilterFn:()=>b.includesString,getGlobalFilterFn:()=>{const{globalFilterFn:t}=e.options;return r(t)?t:"auto"===t?e.getGlobalAutoFilterFn():b[t]},setColumnFilters:t=>{const i=e.getAllLeafColumns();null==e.options.onColumnFiltersChange||e.options.onColumnFiltersChange(e=>{var o;return null==(o=n(t,e))?void 0:o.filter(e=>{const t=i.find(t=>t.id===e.id);return!t||!D(t.getFilterFn(),e.value,t)})})},setGlobalFilter:t=>{null==e.options.onGlobalFilterChange||e.options.onGlobalFilterChange(t)},resetGlobalFilter:t=>{e.setGlobalFilter(t?void 0:e.initialState.globalFilter)},resetColumnFilters:t=>{var i,n;e.setColumnFilters(t?[]:null!=(i=null==(n=e.initialState)?void 0:n.columnFilters)?i:[])},getPreFilteredRowModel:()=>e.getCoreRowModel(),_getFilteredRowModel:e.options.getFilteredRowModel&&e.options.getFilteredRowModel(e),getFilteredRowModel:()=>e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel(),_getGlobalFacetedRowModel:e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),getGlobalFacetedRowModel:()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),_getGlobalFacetedUniqueValues:e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),getGlobalFacetedUniqueValues:()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,_getGlobalFacetedMinMaxValues:e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),getGlobalFacetedMinMaxValues:()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}})};function D(e,t,i){return!(!e||!e.autoRemove)&&e.autoRemove(t,i)||void 0===t||"string"==typeof t&&!t}const F={sum:(e,t,i)=>i.reduce((t,i)=>{const n=i.getValue(e);return t+("number"==typeof n?n:0)},0),min:(e,t,i)=>{let n;return i.forEach(t=>{const i=t.getValue(e);null!=i&&(n>i||void 0===n&&i>=i)&&(n=i)}),n},max:(e,t,i)=>{let n;return i.forEach(t=>{const i=t.getValue(e);null!=i&&(n<i||void 0===n&&i>=i)&&(n=i)}),n},extent:(e,t,i)=>{let n,o;return i.forEach(t=>{const i=t.getValue(e);null!=i&&(void 0===n?i>=i&&(n=o=i):(n>i&&(n=i),o<i&&(o=i)))}),[n,o]},mean:(e,t)=>{let i=0,n=0;if(t.forEach(t=>{let o=t.getValue(e);null!=o&&(o=+o)>=o&&(++i,n+=o)}),i)return n/i},median:(e,t)=>{if(!t.length)return;let i=0,n=0;return t.forEach(t=>{let o=t.getValue(e);"number"==typeof o&&(i=Math.min(i,o),n=Math.max(n,o))}),(i+n)/2},unique:(e,t)=>Array.from(new Set(t.map(t=>t.getValue(e))).values()),uniqueCount:(e,t)=>new Set(t.map(t=>t.getValue(e))).size,count:(e,t)=>t.length},L={getDefaultColumnDef:()=>({aggregatedCell:e=>{var t,i;return null!=(t=null==(i=e.getValue())||null==i.toString?void 0:i.toString())?t:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:o("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,t)=>({toggleGrouping:()=>{t.setGrouping(t=>null!=t&&t.includes(e.id)?t.filter(t=>t!==e.id):[...null!=t?t:[],e.id])},getCanGroup:()=>{var i,n,o,r;return null!=(i=null==(n=null!=(o=null==(r=e.columnDef.enableGrouping)||r)?o:t.options.enableGrouping)||n)?i:!!e.accessorFn},getIsGrouped:()=>{var i;return null==(i=t.getState().grouping)?void 0:i.includes(e.id)},getGroupedIndex:()=>{var i;return null==(i=t.getState().grouping)?void 0:i.indexOf(e.id)},getToggleGroupingHandler:()=>{const t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},getAutoAggregationFn:()=>{const i=t.getCoreRowModel().flatRows[0],n=null==i?void 0:i.getValue(e.id);return"number"==typeof n?F.sum:"[object Date]"===Object.prototype.toString.call(n)?F.extent:void 0},getAggregationFn:()=>{if(!e)throw new Error;return r(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:"auto"===e.columnDef.aggregationFn?e.getAutoAggregationFn():F[e.columnDef.aggregationFn]}}),createTable:e=>({setGrouping:t=>null==e.options.onGroupingChange?void 0:e.options.onGroupingChange(t),resetGrouping:t=>{var i,n;e.setGrouping(t?[]:null!=(i=null==(n=e.initialState)?void 0:n.grouping)?i:[])},getPreGroupedRowModel:()=>e.getFilteredRowModel(),getGroupedRowModel:()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())}),createRow:e=>({getIsGrouped:()=>!!e.groupingColumnId,_groupingValuesCache:{}}),createCell:(e,t,i,n)=>({getIsGrouped:()=>t.getIsGrouped()&&t.id===i.groupingColumnId,getIsPlaceholder:()=>!e.getIsGrouped()&&t.getIsGrouped(),getIsAggregated:()=>{var t;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!(null==(t=i.subRows)||!t.length)}})};function N(e,t,i){if(null==t||!t.length||!i)return e;const n=e.filter(e=>!t.includes(e.id));return"remove"===i?n:[...t.map(t=>e.find(e=>e.id===t)).filter(Boolean),...n]}const M={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:o("columnOrder",e)}),createTable:e=>({setColumnOrder:t=>null==e.options.onColumnOrderChange?void 0:e.options.onColumnOrderChange(t),resetColumnOrder:t=>{var i;e.setColumnOrder(t?[]:null!=(i=e.initialState.columnOrder)?i:[])},_getOrderColumnsFn:a(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(e,t,i)=>n=>{let o=[];if(null!=e&&e.length){const t=[...e],i=[...n];for(;i.length&&t.length;){const e=t.shift(),n=i.findIndex(t=>t.id===e);n>-1&&o.push(i.splice(n,1)[0])}o=[...o,...i]}else o=n;return N(o,t,i)},{key:!1})})},O={getInitialState:e=>({...e,pagination:{pageIndex:0,pageSize:10,...null==e?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:o("pagination",e)}),createTable:e=>{let t=!1,i=!1;return{_autoResetPageIndex:()=>{var n,o;if(t){if(null!=(n=null!=(o=e.options.autoResetAll)?o:e.options.autoResetPageIndex)?n:!e.options.manualPagination){if(i)return;i=!0,e._queue(()=>{e.resetPageIndex(),i=!1})}}else e._queue(()=>{t=!0})},setPagination:t=>null==e.options.onPaginationChange?void 0:e.options.onPaginationChange(e=>n(t,e)),resetPagination:t=>{var i;e.setPagination(t?{pageIndex:0,pageSize:10}:null!=(i=e.initialState.pagination)?i:{pageIndex:0,pageSize:10})},setPageIndex:t=>{e.setPagination(i=>{let o=n(t,i.pageIndex);const r=void 0===e.options.pageCount||-1===e.options.pageCount?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return o=Math.min(Math.max(0,o),r),{...i,pageIndex:o}})},resetPageIndex:t=>{var i,n,o;e.setPageIndex(t?0:null!=(i=null==(n=e.initialState)||null==(o=n.pagination)?void 0:o.pageIndex)?i:0)},resetPageSize:t=>{var i,n,o;e.setPageSize(t?10:null!=(i=null==(n=e.initialState)||null==(o=n.pagination)?void 0:o.pageSize)?i:10)},setPageSize:t=>{e.setPagination(e=>{const i=Math.max(1,n(t,e.pageSize)),o=e.pageSize*e.pageIndex,r=Math.floor(o/i);return{...e,pageIndex:r,pageSize:i}})},setPageCount:t=>e.setPagination(i=>{var o;let r=n(t,null!=(o=e.options.pageCount)?o:-1);return"number"==typeof r&&(r=Math.max(-1,r)),{...i,pageCount:r}}),getPageOptions:a(()=>[e.getPageCount()],e=>{let t=[];return e&&e>0&&(t=[...new Array(e)].fill(null).map((e,t)=>t)),t},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable}}),getCanPreviousPage:()=>e.getState().pagination.pageIndex>0,getCanNextPage:()=>{const{pageIndex:t}=e.getState().pagination,i=e.getPageCount();return-1===i||0!==i&&t<i-1},previousPage:()=>e.setPageIndex(e=>e-1),nextPage:()=>e.setPageIndex(e=>e+1),getPrePaginationRowModel:()=>e.getExpandedRowModel(),getPaginationRowModel:()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),getPageCount:()=>{var t;return null!=(t=e.options.pageCount)?t:Math.ceil(e.getPrePaginationRowModel().rows.length/e.getState().pagination.pageSize)}}}},j={getInitialState:e=>({columnPinning:{left:[],right:[]},...e}),getDefaultOptions:e=>({onColumnPinningChange:o("columnPinning",e)}),createColumn:(e,t)=>({pin:i=>{const n=e.getLeafColumns().map(e=>e.id).filter(Boolean);t.setColumnPinning(e=>{var t,o,r,s,a,l;return"right"===i?{left:(null!=(r=null==e?void 0:e.left)?r:[]).filter(e=>!(null!=n&&n.includes(e))),right:[...(null!=(s=null==e?void 0:e.right)?s:[]).filter(e=>!(null!=n&&n.includes(e))),...n]}:"left"===i?{left:[...(null!=(a=null==e?void 0:e.left)?a:[]).filter(e=>!(null!=n&&n.includes(e))),...n],right:(null!=(l=null==e?void 0:e.right)?l:[]).filter(e=>!(null!=n&&n.includes(e)))}:{left:(null!=(t=null==e?void 0:e.left)?t:[]).filter(e=>!(null!=n&&n.includes(e))),right:(null!=(o=null==e?void 0:e.right)?o:[]).filter(e=>!(null!=n&&n.includes(e)))}})},getCanPin:()=>e.getLeafColumns().some(e=>{var i,n;return(null==(i=e.columnDef.enablePinning)||i)&&(null==(n=t.options.enablePinning)||n)}),getIsPinned:()=>{const i=e.getLeafColumns().map(e=>e.id),{left:n,right:o}=t.getState().columnPinning,r=i.some(e=>null==n?void 0:n.includes(e)),s=i.some(e=>null==o?void 0:o.includes(e));return r?"left":!!s&&"right"},getPinnedIndex:()=>{var i,n,o;const r=e.getIsPinned();return r?null!=(i=null==(n=t.getState().columnPinning)||null==(o=n[r])?void 0:o.indexOf(e.id))?i:-1:0}}),createRow:(e,t)=>({getCenterVisibleCells:a(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,t.getState().columnPinning.right],(e,t,i)=>{const n=[...null!=t?t:[],...null!=i?i:[]];return e.filter(e=>!n.includes(e.column.id))},{key:"row.getCenterVisibleCells",debug:()=>{var e;return null!=(e=t.options.debugAll)?e:t.options.debugRows}}),getLeftVisibleCells:a(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,,],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.column.id===t)).filter(Boolean).map(e=>({...e,position:"left"})),{key:"row.getLeftVisibleCells",debug:()=>{var e;return null!=(e=t.options.debugAll)?e:t.options.debugRows}}),getRightVisibleCells:a(()=>[e._getAllVisibleCells(),t.getState().columnPinning.right],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.column.id===t)).filter(Boolean).map(e=>({...e,position:"left"})),{key:"row.getRightVisibleCells",debug:()=>{var e;return null!=(e=t.options.debugAll)?e:t.options.debugRows}})}),createTable:e=>({setColumnPinning:t=>null==e.options.onColumnPinningChange?void 0:e.options.onColumnPinningChange(t),resetColumnPinning:t=>{var i,n;return e.setColumnPinning(t?{left:[],right:[]}:null!=(i=null==(n=e.initialState)?void 0:n.columnPinning)?i:{left:[],right:[]})},getIsSomeColumnsPinned:t=>{var i;const n=e.getState().columnPinning;var o,r;return t?Boolean(null==(i=n[t])?void 0:i.length):Boolean((null==(o=n.left)?void 0:o.length)||(null==(r=n.right)?void 0:r.length))},getLeftLeafColumns:a(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.id===t)).filter(Boolean),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugColumns}}),getRightLeafColumns:a(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.id===t)).filter(Boolean),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugColumns}}),getCenterLeafColumns:a(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(e,t,i)=>{const n=[...null!=t?t:[],...null!=i?i:[]];return e.filter(e=>!n.includes(e.id))},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugColumns}})})},x={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:o("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>({setRowSelection:t=>null==e.options.onRowSelectionChange?void 0:e.options.onRowSelectionChange(t),resetRowSelection:t=>{var i;return e.setRowSelection(t?{}:null!=(i=e.initialState.rowSelection)?i:{})},toggleAllRowsSelected:t=>{e.setRowSelection(i=>{t=void 0!==t?t:!e.getIsAllRowsSelected();const n={...i},o=e.getPreGroupedRowModel().flatRows;return t?o.forEach(e=>{n[e.id]=!0}):o.forEach(e=>{delete n[e.id]}),n})},toggleAllPageRowsSelected:t=>e.setRowSelection(i=>{const n=void 0!==t?t:!e.getIsAllPageRowsSelected(),o={...i};return e.getRowModel().rows.forEach(t=>{H(o,t.id,n,e)}),o}),getPreSelectedRowModel:()=>e.getCoreRowModel(),getSelectedRowModel:a(()=>[e.getState().rowSelection,e.getCoreRowModel()],(t,i)=>Object.keys(t).length?V(e,i):{rows:[],flatRows:[],rowsById:{}},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable}}),getFilteredSelectedRowModel:a(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(t,i)=>Object.keys(t).length?V(e,i):{rows:[],flatRows:[],rowsById:{}},{key:"getFilteredSelectedRowModel",debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable}}),getGroupedSelectedRowModel:a(()=>[e.getState().rowSelection,e.getSortedRowModel()],(t,i)=>Object.keys(t).length?V(e,i):{rows:[],flatRows:[],rowsById:{}},{key:"getGroupedSelectedRowModel",debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable}}),getIsAllRowsSelected:()=>{const t=e.getPreFilteredRowModel().flatRows,{rowSelection:i}=e.getState();let n=Boolean(t.length&&Object.keys(i).length);return n&&t.some(e=>!i[e.id])&&(n=!1),n},getIsAllPageRowsSelected:()=>{const t=e.getPaginationRowModel().flatRows,{rowSelection:i}=e.getState();let n=!!t.length;return n&&t.some(e=>!i[e.id])&&(n=!1),n},getIsSomeRowsSelected:()=>{var t;return!e.getIsAllRowsSelected()&&!!Object.keys(null!=(t=e.getState().rowSelection)?t:{}).length},getIsSomePageRowsSelected:()=>{const t=e.getPaginationRowModel().flatRows;return!e.getIsAllPageRowsSelected()&&t.some(e=>e.getIsSelected()||e.getIsSomeSelected())},getToggleAllRowsSelectedHandler:()=>t=>{e.toggleAllRowsSelected(t.target.checked)},getToggleAllPageRowsSelectedHandler:()=>t=>{e.toggleAllPageRowsSelected(t.target.checked)}}),createRow:(e,t)=>({toggleSelected:i=>{const n=e.getIsSelected();t.setRowSelection(o=>{if(n===(i=void 0!==i?i:!n))return o;const r={...o};return H(r,e.id,i,t),r})},getIsSelected:()=>{const{rowSelection:i}=t.getState();return k(e,i)},getIsSomeSelected:()=>{const{rowSelection:i}=t.getState();return"some"===U(e,i)},getIsAllSubRowsSelected:()=>{const{rowSelection:i}=t.getState();return"all"===U(e,i)},getCanSelect:()=>{var i;return"function"==typeof t.options.enableRowSelection?t.options.enableRowSelection(e):null==(i=t.options.enableRowSelection)||i},getCanSelectSubRows:()=>{var i;return"function"==typeof t.options.enableSubRowSelection?t.options.enableSubRowSelection(e):null==(i=t.options.enableSubRowSelection)||i},getCanMultiSelect:()=>{var i;return"function"==typeof t.options.enableMultiRowSelection?t.options.enableMultiRowSelection(e):null==(i=t.options.enableMultiRowSelection)||i},getToggleSelectedHandler:()=>{const t=e.getCanSelect();return i=>{var n;t&&e.toggleSelected(null==(n=i.target)?void 0:n.checked)}}})},H=(e,t,i,n)=>{var o;const r=n.getRow(t);r.getIsGrouped(),i?(r.getCanMultiSelect()||Object.keys(e).forEach(t=>delete e[t]),e[t]=!0):delete e[t],null!=(o=r.subRows)&&o.length&&r.getCanSelectSubRows()&&r.subRows.forEach(t=>H(e,t.id,i,n))};function V(e,t){const i=e.getState().rowSelection,n=[],o={},r=function(e,t){return e.map(e=>{var t;const s=k(e,i);if(s&&(n.push(e),o[e.id]=e),null!=(t=e.subRows)&&t.length&&(e={...e,subRows:r(e.subRows)}),s)return e}).filter(Boolean)};return{rows:r(t.rows),flatRows:n,rowsById:o}}function k(e,t){var i;return null!=(i=t[e.id])&&i}function U(e,t,i){if(e.subRows&&e.subRows.length){let i=!0,n=!1;return e.subRows.forEach(e=>{n&&!i||(k(e,t)?n=!0:i=!1)}),i?"all":!!n&&"some"}return!1}const q=/([0-9]+)/gm;function B(e,t){return e===t?0:e>t?1:-1}function G(e){return"number"==typeof e?isNaN(e)||e===1/0||e===-1/0?"":String(e):"string"==typeof e?e:""}function K(e,t){const i=e.split(q).filter(Boolean),n=t.split(q).filter(Boolean);for(;i.length&&n.length;){const e=i.shift(),t=n.shift(),o=parseInt(e,10),r=parseInt(t,10),s=[o,r].sort();if(isNaN(s[0])){if(e>t)return 1;if(t>e)return-1}else{if(isNaN(s[1]))return isNaN(o)?-1:1;if(o>r)return 1;if(r>o)return-1}}return i.length-n.length}const z={alphanumeric:(e,t,i)=>K(G(e.getValue(i)).toLowerCase(),G(t.getValue(i)).toLowerCase()),alphanumericCaseSensitive:(e,t,i)=>K(G(e.getValue(i)),G(t.getValue(i))),text:(e,t,i)=>B(G(e.getValue(i)).toLowerCase(),G(t.getValue(i)).toLowerCase()),textCaseSensitive:(e,t,i)=>B(G(e.getValue(i)),G(t.getValue(i))),datetime:(e,t,i)=>B(e.getValue(i).getTime(),t.getValue(i).getTime()),basic:(e,t,i)=>B(e.getValue(i),t.getValue(i))},Y={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto"}),getDefaultOptions:e=>({onSortingChange:o("sorting",e),isMultiSortEvent:e=>e.shiftKey}),createColumn:(e,t)=>({getAutoSortingFn:()=>{const i=t.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const t of i){const i=null==t?void 0:t.getValue(e.id);if("[object Date]"===Object.prototype.toString.call(i))return z.datetime;if("string"==typeof i&&(n=!0,i.split(q).length>1))return z.alphanumeric}return n?z.text:z.basic},getAutoSortDir:()=>{const i=t.getFilteredRowModel().flatRows[0];return"string"==typeof(null==i?void 0:i.getValue(e.id))?"asc":"desc"},getSortingFn:()=>{if(!e)throw new Error;return r(e.columnDef.sortingFn)?e.columnDef.sortingFn:"auto"===e.columnDef.sortingFn?e.getAutoSortingFn():z[e.columnDef.sortingFn]},toggleSorting:(i,n)=>{const o=e.getNextSortingOrder();t.setSorting(r=>{var s,a;const l=null==r?void 0:r.find(t=>t.id===e.id),c=null==r?void 0:r.findIndex(t=>t.id===e.id),d=null!=i;let u,m=[];if(u=e.getCanMultiSort()&&n?l?"toggle":"add":null!=r&&r.length&&c!==r.length-1?"replace":l?"toggle":"replace","toggle"!==u||null!=(s=t.options.enableSortingRemoval)&&!s||d||n&&null!=(a=t.options.enableMultiRemove)&&!a||o||(u="remove"),"replace"===u)m=[{id:e.id,desc:d?i:"desc"===o}];else if("add"===u&&null!=r&&r.length){var g;m=[...r,{id:e.id,desc:d?i:"desc"===o}],m.splice(0,m.length-(null!=(g=t.options.maxMultiSortColCount)?g:Number.MAX_SAFE_INTEGER))}else"toggle"===u&&null!=r&&r.length?m=r.map(t=>t.id===e.id?{...t,desc:d?i:"desc"===o}:t):"remove"===u&&null!=r&&r.length&&(m=r.filter(t=>t.id!==e.id));return m})},getNextSortingOrder:()=>{var i,n;const o=(null!=(i=null!=(n=e.columnDef.sortDescFirst)?n:t.options.sortDescFirst)?i:"desc"===e.getAutoSortDir())?"desc":"asc",r=e.getIsSorted();return r?r===o&&("desc"===r?"asc":"desc"):o},getCanSort:()=>{var i,n;return(null==(i=e.columnDef.enableSorting)||i)&&(null==(n=t.options.enableSorting)||n)&&!!e.accessorFn},getCanMultiSort:()=>{var i,n;return null!=(i=null!=(n=e.columnDef.enableMultiSort)?n:t.options.enableMultiSort)?i:!!e.accessorFn},getIsSorted:()=>{var i;const n=null==(i=t.getState().sorting)?void 0:i.find(t=>t.id===e.id);return!!n&&(n.desc?"desc":"asc")},getSortIndex:()=>{var i,n;return null!=(i=null==(n=t.getState().sorting)?void 0:n.findIndex(t=>t.id===e.id))?i:-1},clearSorting:()=>{t.setSorting(t=>null!=t&&t.length?t.filter(t=>t.id!==e.id):[])},getToggleSortingHandler:()=>{const i=e.getCanSort();return n=>{i&&(null==n.persist||n.persist(),null==e.toggleSorting||e.toggleSorting(void 0,!!e.getCanMultiSort()&&(null==t.options.isMultiSortEvent?void 0:t.options.isMultiSortEvent(n))))}}}),createTable:e=>({setSorting:t=>null==e.options.onSortingChange?void 0:e.options.onSortingChange(t),resetSorting:t=>{var i,n;e.setSorting(t?[]:null!=(i=null==(n=e.initialState)?void 0:n.sorting)?i:[])},getPreSortedRowModel:()=>e.getGroupedRowModel(),getSortedRowModel:()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())})},W={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:o("columnVisibility",e)}),createColumn:(e,t)=>({toggleVisibility:i=>{e.getCanHide()&&t.setColumnVisibility(t=>({...t,[e.id]:null!=i?i:!e.getIsVisible()}))},getIsVisible:()=>{var i,n;return null==(i=null==(n=t.getState().columnVisibility)?void 0:n[e.id])||i},getCanHide:()=>{var i,n;return(null==(i=e.columnDef.enableHiding)||i)&&(null==(n=t.options.enableHiding)||n)},getToggleVisibilityHandler:()=>t=>{null==e.toggleVisibility||e.toggleVisibility(t.target.checked)}}),createRow:(e,t)=>({_getAllVisibleCells:a(()=>[e.getAllCells(),t.getState().columnVisibility],e=>e.filter(e=>e.column.getIsVisible()),{key:"row._getAllVisibleCells",debug:()=>{var e;return null!=(e=t.options.debugAll)?e:t.options.debugRows}}),getVisibleCells:a(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(e,t,i)=>[...e,...t,...i],{key:!1,debug:()=>{var e;return null!=(e=t.options.debugAll)?e:t.options.debugRows}})}),createTable:e=>{const t=(t,i)=>a(()=>[i(),i().filter(e=>e.getIsVisible()).map(e=>e.id).join("_")],e=>e.filter(e=>null==e.getIsVisible?void 0:e.getIsVisible()),{key:t,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugColumns}});return{getVisibleFlatColumns:t("getVisibleFlatColumns",()=>e.getAllFlatColumns()),getVisibleLeafColumns:t("getVisibleLeafColumns",()=>e.getAllLeafColumns()),getLeftVisibleLeafColumns:t("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),getRightVisibleLeafColumns:t("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),getCenterVisibleLeafColumns:t("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),setColumnVisibility:t=>null==e.options.onColumnVisibilityChange?void 0:e.options.onColumnVisibilityChange(t),resetColumnVisibility:t=>{var i;e.setColumnVisibility(t?{}:null!=(i=e.initialState.columnVisibility)?i:{})},toggleAllColumnsVisible:t=>{var i;t=null!=(i=t)?i:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((e,i)=>({...e,[i.id]:t||!(null!=i.getCanHide&&i.getCanHide())}),{}))},getIsAllColumnsVisible:()=>!e.getAllLeafColumns().some(e=>!(null!=e.getIsVisible&&e.getIsVisible())),getIsSomeColumnsVisible:()=>e.getAllLeafColumns().some(e=>null==e.getIsVisible?void 0:e.getIsVisible()),getToggleAllColumnsVisibilityHandler:()=>t=>{var i;e.toggleAllColumnsVisible(null==(i=t.target)?void 0:i.checked)}}}},J=[d,W,M,j,P,Y,L,f,O,x,g];function $(e){var t;(e.debugAll||e.debugTable)&&console.info("Creating Table Instance...");let i={_features:J};const o=i._features.reduce((e,t)=>Object.assign(e,null==t.getDefaultOptions?void 0:t.getDefaultOptions(i)),{});let r={...null!=(t=e.initialState)?t:{}};i._features.forEach(e=>{var t;r=null!=(t=null==e.getInitialState?void 0:e.getInitialState(r))?t:r});const s=[];let c=!1;const d={_features:J,options:{...o,...e},initialState:r,_queue:e=>{s.push(e),c||(c=!0,Promise.resolve().then(()=>{for(;s.length;)s.shift()();c=!1}).catch(e=>setTimeout(()=>{throw e})))},reset:()=>{i.setState(i.initialState)},setOptions:e=>{const t=n(e,i.options);i.options=(e=>i.options.mergeOptions?i.options.mergeOptions(o,e):{...o,...e})(t)},getState:()=>i.options.state,setState:e=>{null==i.options.onStateChange||i.options.onStateChange(e)},_getRowId:(e,t,n)=>{var o;return null!=(o=null==i.options.getRowId?void 0:i.options.getRowId(e,t,n))?o:""+(n?[n.id,t].join("."):t)},getCoreRowModel:()=>(i._getCoreRowModel||(i._getCoreRowModel=i.options.getCoreRowModel(i)),i._getCoreRowModel()),getRowModel:()=>i.getPaginationRowModel(),getRow:e=>{const t=i.getRowModel().rowsById[e];if(!t)throw new Error;return t},_getDefaultColumnDef:a(()=>[i.options.defaultColumn],e=>{var t;return e=null!=(t=e)?t:{},{header:e=>e.header.column.id,footer:e=>e.header.column.id,cell:e=>{var t,i;return null!=(t=null==(i=e.renderValue())||null==i.toString?void 0:i.toString())?t:null},...i._features.reduce((e,t)=>Object.assign(e,null==t.getDefaultColumnDef?void 0:t.getDefaultColumnDef()),{}),...e}},{debug:()=>{var e;return null!=(e=i.options.debugAll)?e:i.options.debugColumns},key:!1}),_getColumnDefs:()=>i.options.columns,getAllColumns:a(()=>[i._getColumnDefs()],e=>{const t=function(e,n,o){return void 0===o&&(o=0),e.map(e=>{const r=l(i,e,o,n);return r.columns=e.columns?t(e.columns,r,o+1):[],r})};return t(e)},{key:!1,debug:()=>{var e;return null!=(e=i.options.debugAll)?e:i.options.debugColumns}}),getAllFlatColumns:a(()=>[i.getAllColumns()],e=>e.flatMap(e=>e.getFlatColumns()),{key:!1,debug:()=>{var e;return null!=(e=i.options.debugAll)?e:i.options.debugColumns}}),_getAllFlatColumnsById:a(()=>[i.getAllFlatColumns()],e=>e.reduce((e,t)=>(e[t.id]=t,e),{}),{key:!1,debug:()=>{var e;return null!=(e=i.options.debugAll)?e:i.options.debugColumns}}),getAllLeafColumns:a(()=>[i.getAllColumns(),i._getOrderColumnsFn()],(e,t)=>t(e.flatMap(e=>e.getLeafColumns())),{key:!1,debug:()=>{var e;return null!=(e=i.options.debugAll)?e:i.options.debugColumns}}),getColumn:e=>{const t=i._getAllFlatColumnsById()[e];if(!t)throw new Error;return t}};return Object.assign(i,d),i._features.forEach(e=>Object.assign(i,null==e.createTable?void 0:e.createTable(i))),i}const X=(e,t,i,n,o,r)=>{let l={id:t,index:n,original:i,depth:o,_valuesCache:{},getValue:t=>{if(l._valuesCache.hasOwnProperty(t))return l._valuesCache[t];const i=e.getColumn(t);return i.accessorFn?(l._valuesCache[t]=i.accessorFn(l.original,n),l._valuesCache[t]):void 0},renderValue:t=>{var i;return null!=(i=l.getValue(t))?i:e.options.renderFallbackValue},subRows:null!=r?r:[],getLeafRows:()=>s(l.subRows,e=>e.subRows),getAllCells:a(()=>[e.getAllLeafColumns()],t=>t.map(t=>(function(e,t,i,n){const o={id:t.id+"_"+i.id,row:t,column:i,getValue:()=>t.getValue(n),renderValue:()=>{var t;return null!=(t=o.getValue())?t:e.options.renderFallbackValue},getContext:()=>({table:e,column:i,row:t,cell:o,getValue:o.getValue,renderValue:o.renderValue})};return e._features.forEach(n=>{Object.assign(o,null==n.createCell?void 0:n.createCell(o,i,t,e))},{}),o})(e,l,t,t.id)),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugRows}}),_getAllCellsByColumnId:a(()=>[l.getAllCells()],e=>e.reduce((e,t)=>(e[t.column.id]=t,e),{}),{key:"row.getAllCellsByColumnId",debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugRows}})};for(let t=0;t<e._features.length;t++){const i=e._features[t];Object.assign(l,null==i||null==i.createRow?void 0:i.createRow(l,e))}return l};function Q(e,t,i){return i.options.filterFromLeafRows?(function(e,t,i){const n={},o=function(e,r){const s=[];for(let r=0;r<e.length;r++){var a;let l=e[r];if(null!=(a=l.subRows)&&a.length){const e=X(i,l.id,l.original,l.index,l.depth);if(e.columnFilters=l.columnFilters,e.subRows=o(l.subRows),!e.subRows.length)continue;l=e}t(l)&&(s.push(l),n[l.id]=l,n[r]=l)}return s};return{rows:o(e),flatRows:[],rowsById:n}})(e,t,i):(function(e,t,i){const n=[],o={},r=function(e,s){const a=[];for(let s=0;s<e.length;s++){let c=e[s];if(t(c)){var l;if(null!=(l=c.subRows)&&l.length){const e=X(i,c.id,c.original,c.index,c.depth);e.subRows=r(c.subRows),c=e}a.push(c),n.push(c),o[c.id]=c}}return a};return{rows:r(e),flatRows:n,rowsById:o}})(e,t,i)}function Z(e,t){const i=[],n=e=>{var t;i.push(e),null!=(t=e.subRows)&&t.length&&e.getIsExpanded()&&e.subRows.forEach(n)};return e.rows.forEach(n),{rows:i,flatRows:e.flatRows,rowsById:e.rowsById}}e.ColumnSizing=g,e.Expanding=f,e.Filters=P,e.Grouping=L,e.Headers=d,e.Ordering=M,e.Pagination=O,e.Pinning=j,e.RowSelection=x,e.Sorting=Y,e.Visibility=W,e.aggregationFns=F,e.buildHeaderGroups=u,e.createColumn=l,e.createRow=X,e.createTable=$,e.defaultColumnSizing=m,e.expandRows=Z,e.filterFns=b,e.flattenBy=s,e.flexRender=function(e,t){return e?(function(e){return"function"==typeof e&&(()=>{const t=Object.getPrototypeOf(e);return t.prototype&&t.prototype.isReactComponent})()})(n=e)||"function"==typeof n||(function(e){return"object"==typeof e&&"symbol"==typeof e.$$typeof&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)})(n)?i.createElement(e,t):e:null;var n},e.functionalUpdate=n,e.getCoreRowModel=function(){return e=>a(()=>[e.options.data],t=>{const i={rows:[],flatRows:[],rowsById:{}},n=function(t,o,r){void 0===o&&(o=0);const s=[];for(let l=0;l<t.length;l++){const c=X(e,e._getRowId(t[l],l,r),t[l],l,o);var a;i.flatRows.push(c),i.rowsById[c.id]=c,s.push(c),e.options.getSubRows&&(c.originalSubRows=e.options.getSubRows(t[l],l),null!=(a=c.originalSubRows)&&a.length&&(c.subRows=n(c.originalSubRows,o+1,c)))}return s};return i.rows=n(t),i},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{e._autoResetPageIndex()}})},e.getExpandedRowModel=function(){return e=>a(()=>[e.getState().expanded,e.getPreExpandedRowModel(),e.options.paginateExpandedRows],(e,t,i)=>t.rows.length&&i&&(!0===e||Object.keys(null!=e?e:{}).length)?Z(t):t,{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable}})},e.getFacetedMinMaxValues=function(){return(e,t)=>a(()=>[e.getColumn(t).getFacetedRowModel()],e=>{var i;const n=null==(i=e.flatRows[0])?void 0:i.getValue(t);if(void 0===n)return;let o=[n,n];for(let i=0;i<e.flatRows.length;i++){var r;const n=null==(r=e.flatRows[i])?void 0:r.getValue(t);n<o[0]?o[0]=n:n>o[1]&&(o[1]=n)}return o},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{}})},e.getFacetedRowModel=function(){return(e,t)=>a(()=>[e.getPreFilteredRowModel(),e.getState().columnFilters,e.getState().globalFilter,e.getFilteredRowModel()],(i,n,o)=>{if(!i.rows.length||(null==n||!n.length)&&!o)return i;const r=[...n.map(e=>e.id).filter(e=>e!==t),o?"__global__":void 0].filter(Boolean);return Q(i.rows,e=>{for(let t=0;t<r.length;t++)if(!1===e.columnFilters[r[t]])return!1;return!0},e)},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{}})},e.getFacetedUniqueValues=function(){return(e,t)=>a(()=>[e.getColumn(t).getFacetedRowModel()],e=>{let i=new Map;for(let r=0;r<e.flatRows.length;r++){var n;const s=null==(n=e.flatRows[r])?void 0:n.getValue(t);var o;i.has(s)?i.set(s,(null!=(o=i.get(s))?o:0)+1):i.set(s,1)}return i},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{}})},e.getFilteredRowModel=function(){return e=>a(()=>[e.getPreFilteredRowModel(),e.getState().columnFilters,e.getState().globalFilter],(t,i,n)=>{if(!t.rows.length||(null==i||!i.length)&&!n){for(let e=0;e<t.flatRows.length;e++)t.flatRows[e].columnFilters={},t.flatRows[e].columnFiltersMeta={};return t}const o=[],r=[];(null!=i?i:[]).forEach(t=>{var i;const n=e.getColumn(t.id).getFilterFn();n&&o.push({id:t.id,filterFn:n,resolvedValue:null!=(i=null==n.resolveFilterValue?void 0:n.resolveFilterValue(t.value))?i:t.value})});const s=i.map(e=>e.id),a=e.getGlobalFilterFn(),l=e.getAllLeafColumns().filter(e=>e.getCanGlobalFilter());let c,d;n&&a&&l.length&&(s.push("__global__"),l.forEach(e=>{var t;r.push({id:e.id,filterFn:a,resolvedValue:null!=(t=null==a.resolveFilterValue?void 0:a.resolveFilterValue(n))?t:n})}));for(let e=0;e<t.flatRows.length;e++){const i=t.flatRows[e];if(i.columnFilters={},o.length)for(let e=0;e<o.length;e++){c=o[e];const t=c.id;i.columnFilters[t]=c.filterFn(i,t,c.resolvedValue,e=>{i.columnFiltersMeta[t]=e})}if(r.length){for(let e=0;e<r.length;e++){d=r[e];const t=d.id;if(d.filterFn(i,t,d.resolvedValue,e=>{i.columnFiltersMeta[t]=e})){i.columnFilters.__global__=!0;break}}!0!==i.columnFilters.__global__&&(i.columnFilters.__global__=!1)}}return Q(t.rows,e=>{for(let t=0;t<s.length;t++)if(!1===e.columnFilters[s[t]])return!1;return!0},e)},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{e._autoResetPageIndex()}})},e.getGroupedRowModel=function(){return e=>a(()=>[e.getState().grouping,e.getPreGroupedRowModel()],(t,i)=>{if(!i.rows.length||!t.length)return i;const n=t.filter(t=>e.getColumn(t)),o=[],r={},a=function(t,i,l){if(void 0===i&&(i=0),i===n.length)return t;const c=n[i],d=(function(e,t){const i=new Map;return e.reduce((e,i)=>{const n=""+i.getValue(t),o=e.get(n);return o?e.set(n,[...o,i]):e.set(n,[i]),e},i)})(t,c);return Array.from(d.entries()).map((t,d)=>{let[u,m]=t,g=c+":"+u;g=l?l+">"+g:g;const h=a(m,i+1,g),p=i?s(m,e=>e.subRows):m,_=X(e,g,void 0,d,i);return Object.assign(_,{groupingColumnId:c,groupingValue:u,subRows:h,leafRows:p,getValue:t=>{var i;if(n.includes(t))return _._valuesCache.hasOwnProperty(t)?_._valuesCache[t]:(m[0]&&(_._valuesCache[t]=null!=(i=m[0].getValue(t))?i:void 0),_._valuesCache[t]);if(_._groupingValuesCache.hasOwnProperty(t))return _._groupingValuesCache[t];const o=e.getColumn(t).getAggregationFn();return o?(_._groupingValuesCache[t]=o(t,p,m),_._groupingValuesCache[t]):void 0}}),h.forEach(e=>{o.push(e),r[e.id]=e}),_})},l=a(i.rows,0,"");return l.forEach(e=>{o.push(e),r[e.id]=e}),{rows:l,flatRows:o,rowsById:r}},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{e._queue(()=>{e._autoResetExpanded(),e._autoResetPageIndex()})}})},e.getPaginationRowModel=function(e){return e=>a(()=>[e.getState().pagination,e.getPrePaginationRowModel()],(t,i)=>{if(!i.rows.length)return i;const{pageSize:n,pageIndex:o}=t;let{rows:r,flatRows:s,rowsById:a}=i;const l=n*o,c=l+n;let d;r=r.slice(l,c),d=e.options.paginateExpandedRows?{rows:r,flatRows:s,rowsById:a}:Z({rows:r,flatRows:s,rowsById:a}),d.flatRows=[];const u=e=>{d.flatRows.push(e),e.subRows.length&&e.subRows.forEach(u)};return d.rows.forEach(u),d},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable}})},e.getSortedRowModel=function(){return e=>a(()=>[e.getState().sorting,e.getPreSortedRowModel()],(t,i)=>{if(!i.rows.length||null==t||!t.length)return i;const n=e.getState().sorting,o=[],r=n.filter(t=>e.getColumn(t.id).getCanSort()),s={};r.forEach(t=>{const i=e.getColumn(t.id);s[t.id]={sortUndefined:i.columnDef.sortUndefined,invertSorting:i.columnDef.invertSorting,sortingFn:i.getSortingFn()}});const a=e=>{const t=e.slice();return t.sort((e,t)=>{for(let n=0;n<r.length;n+=1){var i;const o=r[n],a=s[o.id],l=null!=(i=null==o?void 0:o.desc)&&i;if(a.sortUndefined){const i=void 0===e.getValue(o.id),n=void 0===t.getValue(o.id);if(i||n)return i&&n?0:i?a.sortUndefined:-a.sortUndefined}let c=a.sortingFn(e,t,o.id);if(0!==c)return l&&(c*=-1),a.invertSorting&&(c*=-1),c}return e.index-t.index}),t.forEach(e=>{o.push(e),!e.subRows||e.subRows.length<=1||(e.subRows=a(e.subRows))}),t};return{rows:a(i.rows),flatRows:o,rowsById:i.rowsById}},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{e._autoResetPageIndex()}})},e.isFunction=r,e.isRowSelected=k,e.isSubRowSelected=U,e.makeStateUpdater=o,e.memo=a,e.noop=function(){},e.orderColumns=N,e.passiveEventSupported=p,e.reSplitAlphaNumeric=q,e.selectRowsFn=V,e.shouldAutoRemoveFilter=D,e.sortingFns=z,e.useReactTable=function(e){const t={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[n]=i.useState(()=>({current:$(t)})),[o,r]=i.useState(()=>n.current.initialState);return n.current.setOptions(t=>({...t,...e,state:{...o,...e.state},onStateChange:t=>{r(t),null==e.onStateChange||e.onStateChange(t)}})),n.current},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=pkg-files-table.min.js-vflmnCW0w.map