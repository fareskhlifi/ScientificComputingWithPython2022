define("metaserver/static/js/clean/ui/path_filter_button",["require","exports","tslib","react","spectrum/dropdown_button/index","metaserver/static/js/clean/ui/title_bubble","metaserver/static/js/clean/em_string","metaserver/static/js/filepath/filepath","dig-components/tooltips","metaserver/static/js/clean/ui/sticky_position","dig-components/buttons","dig-components/chips"],(function(e,t,a,s,r,i,n,o,d,c,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PathFilterButton=void 0,s=a.__importDefault(s),o=a.__importStar(o);t.PathFilterButton=({path:e,defaultText:t,dropdownClasses:a,disabled:p,onClick:m,useDigComponents:y,id:_,label:g,useButtonComponent:f})=>{const h=e&&!o.paths_are_equal(e,"/")?n.Emstring.em_snippet(o.filename(e),10,.6):null;if(y){const r=f?s.default.createElement(l.Button,{variant:"outline",className:a,disabled:p,onClick:m,id:_,"aria-labelledby":`${g} ${_}`,withDropdownIcon:!0},h||t):s.default.createElement(u.FilterChip,{className:a,disabled:p,onClick:m,id:_,"aria-labelledby":`${g} ${_}`,isSelected:!!h},h||t);return e&&h?s.default.createElement(d.Tooltip,{title:e,placement:"bottom"},r):r}const S=s.default.createElement(r.DropdownButton,{className:a,disabled:p,onClick:m,id:_,"aria-labelledby":`${g} ${_}`},h||t);return h?s.default.createElement(i.TitleBubble,{content:e,position:c.StickyPosition.BOTTOM},S):S}})),define("metaserver/static/js/starred/store",["require","exports","tslib","lodash","metaserver/static/js/flux/dispatcher","metaserver/static/js/flux/flux_store","metaserver/static/js/starred/constants","metaserver/static/js/home/starred/constants","metaserver/static/js/starred/id_type_pair"],(function(e,t,a,s,r,i,n,o,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredStore=t._StarredStoreClass=void 0,s=a.__importStar(s);class c extends i.FluxStore{constructor(){super(r.Dispatcher),this.idsToLoadingState={},this.idsToStarred={}}getLoadingStates(){return this.idsToLoadingState}hasIdTypePair(e){return this.idsToLoadingState.hasOwnProperty((0,d.idTypePairToString)(e))}getLoadingState(e){return this.idsToLoadingState[(0,d.idTypePairToString)(e)]}getIsStarred(e){return this.idsToStarred[(0,d.idTypePairToString)(e)]}getAllStarredPairStrings(){return Object.keys(s.pickBy(this.idsToStarred,e=>e))}getIsLoading(e){return this.getLoadingState(e)===n.StarredLoadingState.LOADING}onLoading(e){const t={};e.forEach(e=>t[(0,d.idTypePairToString)(e)]=n.StarredLoadingState.LOADING),this.idsToLoadingState=Object.assign(Object.assign({},this.idsToLoadingState),t)}onSetStatus(e=[]){const t={},a={};e.forEach(e=>{const s=(0,d.idTypePairToString)(e.idTypePair);t[s]=n.StarredLoadingState.LOAD_SUCCESS,a[s]=e.starred}),this.idsToLoadingState=Object.assign(Object.assign({},this.idsToLoadingState),t),this.idsToStarred=Object.assign(Object.assign({},this.idsToStarred),a)}onLoadFailure(e){const t={};e.forEach(e=>{const a=(0,d.idTypePairToString)(e),s=this.idsToLoadingState[a];void 0!==s&&s!==n.StarredLoadingState.LOADING||(t[a]=n.StarredLoadingState.LOAD_FAILED)}),this.idsToLoadingState=Object.assign(Object.assign({},this.idsToLoadingState),t)}__onDispatch(e){const t=e.action;switch(t.type){case n.StarredActionTypes.LOADING:this.onLoading(t.idTypePairs),this.__emitChange();break;case n.StarredActionTypes.SET_STATUS:case o.StarredResourceActionTypes.LOAD_SUCCESS:this.onSetStatus(t.starredStatuses),this.__emitChange();break;case n.StarredActionTypes.LOAD_FAILURE:this.onLoadFailure(t.idTypePairs),this.__emitChange();break;default:return}}}t._StarredStoreClass=c,t.StarredStore=new c})),define("metaserver/static/js/home/recents/recent_activity_starred",["require","exports","tslib","lodash","metaserver/static/js/starred/id_type_pair"],(function(e,t,a,s,r){"use strict";function i(e){return e.resource_id&&e.id_type?{id:e.resource_id,type:e.id_type}:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getIdTypePairFromRecentItem=t.getIdTypePairsByRecentActivityItems=t.getIdTypePair=void 0,s=a.__importStar(s),t.getIdTypePair=i,t.getIdTypePairsByRecentActivityItems=function(e){const t={};return e.forEach(e=>{const a=i(e);a&&(t[(0,r.idTypePairToString)(a)]=a)}),s.values(t)},t.getIdTypePairFromRecentItem=function(e){return e.resourceId&&e.idType?{id:e.resourceId,type:e.idType}:null}})),define("metaserver/static/js/starred/browse_update",["require","exports","metaserver/static/js/starred/actions","metaserver/static/js/starred/id_type_pair","metaserver/static/js/starred/store"],(function(e,t,a,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkForMissingStarredData=void 0,t.checkForMissingStarredData=function({items:e,isNonUserRelativeContext:t,user:i}){if(!t){const t=e.map(s.idTypePairFromStarrableItem).filter(e=>!(!e.id||r.StarredStore.hasIdTypePair(e)));t.length&&a.StarredActions.fetchStatuses(i.role,t)}}})),define("metaserver/static/js/starred/model",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.statusResultsToStarredStatuses=void 0,t.statusResultsToStarredStatuses=function(e){return e.map(e=>{const{id:t,type:a,is_starred:s,canonical_id:r,canonical_id_type:i}=e,n={idTypePair:{id:t,type:a},starred:s};return r&&i&&(n.canonicalIdTypePair={id:r,type:i}),n})}})),define("metaserver/static/js/starred/actions",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/starred/api","metaserver/static/js/starred/constants","metaserver/static/js/starred/model","metaserver/static/js/starred/utils"],(function(e,t,a,s,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredActions=void 0,r=a.__importStar(r);class d{static setStarredStatus(e,t){s.Dispatcher.dispatch({type:i.StarredActionTypes.SET_STATUS,starredStatuses:[{idTypePair:e,starred:t}]})}static fetchStatuses(e,t,a=!1){return a||d.markAsLoading(t),r.fetchStatuses(e,t).then(e=>{s.Dispatcher.dispatch({type:i.StarredActionTypes.SET_STATUS,starredStatuses:(0,n.statusResultsToStarredStatuses)(e)})}).catch(e=>(s.Dispatcher.dispatch({type:i.StarredActionTypes.LOAD_FAILURE,idTypePairs:t}),Promise.reject(e)))}static markAsLoading(e){s.Dispatcher.dispatch({type:i.StarredActionTypes.LOADING,idTypePairs:e})}static update(e,t,a,n){const o={id:t,type:a};let d;s.Dispatcher.dispatch({type:i.StarredActionTypes.LOADING,idTypePairs:[o]});const c=r.update(e,t,a,n);return c.then(()=>d=n).catch(e=>{throw d=!n,e}).finally(()=>{s.Dispatcher.dispatch({type:i.StarredActionTypes.SET_STATUS,starredStatuses:[{idTypePair:{id:t,type:a},starred:d}]})}),c}static updateWithSnackbar(e,t,a,s,r){return d.update(e,t,a,s).then(()=>{(0,o.displayStarSnackbar)({itemName:r,isStarred:s,success:!0})}).catch(e=>{(0,o.displayStarSnackbar)({itemName:r,isStarred:s,success:!1})})}}t.StarredActions=d})),define("metaserver/static/js/file_viewer/toggle_browse_elements_util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showElementsBehindFileViewer=t.hideElementsBehindFileViewer=void 0;const a=[".maestro-chrome","#maestro-nav","#page-footer","#page-content","#page-header","#page-sidebar","#flash-upload-container","#maestro-header","#maestro-header-portal","#maestro-prompt",".snackbar-container","#onboarding-sidebar-pagelet",".maestro-portal"].join();t.hideElementsBehindFileViewer=function(){Array.from(document.querySelectorAll(a)).forEach(e=>{e.style.display&&e.setAttribute("data-preview-old-display",e.style.display),e.style.display="none"})},t.showElementsBehindFileViewer=function(){Array.from(document.querySelectorAll(a)).forEach(e=>{e.style.display=e.hasAttribute("data-preview-old-display")?e.getAttribute("data-preview-old-display"):""})}})),define("typescript/component_libraries/deep-integrations/src/data/actions",["require","exports","tslib","typescript/component_libraries/deep-integrations/src/api_v2/shared_link","typescript/component_libraries/deep-integrations/src/async","typescript/component_libraries/deep-integrations/src/data/types","lodash"],(function(e,t,a,s,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearMakeZoomMeetingMessage=t.makeZoomMeeting=t.loadUpcomingCalendarEvents=t.loadCalendarEvents=t.getRangeKey=t.loadCalendarEventsInCommon=t.clearLoadEventsError=t.clearLoadEventsInCommonError=t.clearLastSentMessage=t.clearCanSendMessage=t.canSendMessage=t.sendChatMessage=t.saveInputFocus=t.saveChatMessage=void 0,n=a.__importDefault(n);function o(e){return t=>{t({type:i.Actions.clearLastSentMessage,meta:{userKey:e.account_id}})}}function d(e,t){return e.toString()+"-"+t.toString()}function c(e,t){return(s,r,n)=>a.__awaiter(this,void 0,void 0,(function*(){s({type:i.Actions.clearMakeZoomMeetingMessage,meta:{userKey:t,ical_uid:e.ical_uid}})}))}t.saveChatMessage=function(e,t){return a=>{a({type:i.Actions.saveChatMessage,meta:{userKey:e.account_id},payload:{chatMessage:t}})}},t.saveInputFocus=function(e,t){return a=>{a({type:i.Actions.saveInputFocus,meta:{userKey:e.account_id},payload:{hasInputFocus:t}})}},t.sendChatMessage=function(e,t,n){return(d,c,l)=>a.__awaiter(this,void 0,void 0,(function*(){const{apiV2Client:a,reportError:c}=l();d({type:i.Actions.sendChatMessage,meta:{userKey:e.account_id},payload:{state:"pending"}});const u=[n.text],p=(n.attachments||[]).map(e=>"file_share_link"===e.type?(0,s.getSharedLinkMetadata)(e.fileId,a).then(e=>e.url):Promise.resolve(null));try{yield Promise.all(p).then(e=>e.filter(e=>null!==e).forEach(e=>u.push(e)))}catch(t){return d({type:i.Actions.sendChatMessage,meta:{userKey:e.account_id},payload:{state:"rejected",error:t}}),void c(t,"non-critical",["ProfileCard"],{action:"getSharedLinkMetadata"})}const m={target:e.account_id,message:u.join("\n")};switch(t[".tag"]){case"slack_dropbox":{const t=yield(0,r.toAsync)(a.ns("slack").rpc("send_direct_message",m,{}));"rejected"===t.state&&c(t.error,"non-critical",["ProfileCard"],{action:"sendChatMessage_slack"}),"fulfilled"===t.state?(d({type:i.Actions.sendChatMessage,meta:{userKey:e.account_id},payload:{state:"fulfilled",value:{message_link:t.value.deep_link}}}),d({type:i.Actions.saveChatMessage,meta:{userKey:e.account_id},payload:{chatMessage:""}}),setTimeout(()=>d(o(e)),3e3)):d({type:i.Actions.sendChatMessage,meta:{userKey:e.account_id},payload:t});break}case"zoom":{const t=yield(0,r.toAsync)(a.ns("zoom").rpc("send_direct_message",m,{}));"rejected"===t.state&&c(t.error,"non-critical",["ProfileCard"],{action:"sendChatMessage_zoom"}),"fulfilled"===t.state?(d({type:i.Actions.sendChatMessage,meta:{userKey:e.account_id},payload:{state:"fulfilled",value:{message_link:t.value.conversation_link}}}),d({type:i.Actions.saveChatMessage,meta:{userKey:e.account_id},payload:{chatMessage:""}}),setTimeout(()=>d(o(e)),3e3)):d({type:i.Actions.sendChatMessage,meta:{userKey:e.account_id},payload:t});break}}}))},t.canSendMessage=function(e,t){return(s,n,o)=>a.__awaiter(this,void 0,void 0,(function*(){const{apiV2Client:a}=o(),n={target:e.account_id};s({type:i.Actions.canSendMessage,meta:{userKey:e.account_id,serviceType:t},payload:{state:"pending"}});const{reportError:d}=o();let c;switch(t[".tag"]){case"slack_dropbox":c=yield(0,r.toAsync)(a.ns("slack").rpc("can_send_message",n,{}));break;case"zoom":c=yield(0,r.toAsync)(a.ns("zoom").rpc("can_send_message",n,{}));break;default:c={state:"rejected",error:new Error("unknown/unsupported service type")}}"rejected"===c.state&&d(c.error,"non-critical",["ProfileCard"],{action:"canSendMessage"}),s({type:i.Actions.canSendMessage,meta:{userKey:e.account_id,serviceType:t},payload:c})}))},t.clearCanSendMessage=function(e,t){return a=>{a({type:i.Actions.clearCanSendMessage,meta:{userKey:e.account_id,serviceType:t}})}},t.clearLastSentMessage=o,t.clearLoadEventsInCommonError=function(e,t){return t=>{t({type:i.Actions.clearLoadEventsInCommonError,meta:{userKey:e.account_id}})}},t.clearLoadEventsError=function(e,t,a,s){const r=d(t,a);return t=>{t({type:i.Actions.clearLoadEventsError,meta:{userKey:e.account_id,rangeKey:r}})}},t.loadCalendarEventsInCommon=function(e,t){return(s,n,o)=>a.__awaiter(this,void 0,void 0,(function*(){const a=n(),d=a&&a.sharedCalendarState[e.account_id];d&&"rejected"!==d.eventSections.state||s({type:i.Actions.loadCalendarEventsInCommon,meta:{userKey:e.account_id,timestamp:t.now()},payload:{state:"pending"}});const{apiV2Client:c,reportError:l}=o(),u={account_ids_or_emails:[e.account_id],range_start_time:Date.now(),range_end_time:Date.now()+864e5},p=yield(0,r.toAsync)(c.ns("calendar").rpc("fetch_events_in_common",u,{}));if("rejected"===p.state)l(p.error,"non-critical",["ProfileCard"],{integration_action:"loadCalendarEvents"}),s({type:i.Actions.loadCalendarEventsInCommon,meta:{userKey:e.account_id,timestamp:t.now()},payload:p});else if("fulfilled"===p.state){const a=p.value.event_mapping[e.account_id]||[];s({type:i.Actions.loadCalendarEventsInCommon,meta:{userKey:e.account_id,timestamp:t.now()},payload:{state:"fulfilled",value:a}})}}))},t.getRangeKey=d,t.loadCalendarEvents=function(e,t,s,o,c){const l=d(s,o),u=e.account_id,p={range_start_time:s,range_end_time:o,calendar_id:e.email||u};return(e,s,o)=>a.__awaiter(this,void 0,void 0,(function*(){const{apiV2Client:a,reportError:d}=o(),{fullCalendarState:m}=s();void 0!==m[u]&&void 0!==m[u][l]||e({type:i.Actions.loadCalendarEvents,meta:{userKey:u,rangeKey:l,timestamp:t.now()},payload:{state:"pending"}});const y=yield(0,r.toAsync)(a.ns("calendar").rpc("fetch_events",p,{}));if("rejected"===y.state)d(y.error,"non-critical",["FullCalendar"],{integration_action:"loadCalendarEvents"}),e({type:i.Actions.loadCalendarEvents,meta:{userKey:u,rangeKey:l,timestamp:t.now()},payload:y});else if("fulfilled"===y.state){let a=y.value.events;void 0!==c&&(a=a.filter(e=>e.end_time-e.start_time<=c)),a=n.default.sortBy(a,["start_time","end_time"]),e({type:i.Actions.loadCalendarEvents,meta:{userKey:u,rangeKey:l,timestamp:t.now()},payload:{state:"fulfilled",value:a}})}}))},t.loadUpcomingCalendarEvents=function(){return(e,t,s)=>a.__awaiter(this,void 0,void 0,(function*(){const t=s().apiV2Client,a={range_start_time:Date.now(),range_end_time:Date.now()+9e5};e({type:i.Actions.loadUpcomingCalendarEvents,meta:{},payload:{state:"pending"}});try{const s=(yield t.ns("calendar").rpc("fetch_events",a,{})).events;e({type:i.Actions.loadUpcomingCalendarEvents,meta:{},payload:{state:"fulfilled",value:s}})}catch(t){e({type:i.Actions.loadUpcomingCalendarEvents,meta:{},payload:{state:"rejected",error:t}})}}))},t.makeZoomMeeting=function(e,t){return(s,n,o)=>a.__awaiter(this,void 0,void 0,(function*(){const{apiV2Client:a,reportError:n}=o(),d={event_key:e.calendar_event_key};s({type:i.Actions.makeZoomMeeting,meta:{userKey:t,ical_uid:e.ical_uid},payload:{state:"pending"}});const l=yield(0,r.toAsync)(a.ns("zoom").rpc("make_zoom_meeting",d,{}));if("rejected"===l.state)n(l.error,"non-critical",["ProfileCard"],{integration_action:"makeZoomMeeting"}),s({type:i.Actions.makeZoomMeeting,meta:{userKey:t,ical_uid:e.ical_uid},payload:l});else if("fulfilled"===l.state){const e=l.value.calendar_event;s({type:i.Actions.makeZoomMeeting,meta:{userKey:t,ical_uid:e.ical_uid},payload:{state:"fulfilled",value:e}}),setTimeout(()=>s(c(e,t)),3e3)}}))},t.clearMakeZoomMeetingMessage=c})),define("typescript/component_libraries/deep-integrations/src/platform/performance_timer",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultPerformanceTimer=void 0,t.DefaultPerformanceTimer={now:()=>Date.now()}}));
//# sourceMappingURL=pkg-starred.min.js-vflPW4RPV.map