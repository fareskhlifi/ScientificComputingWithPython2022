define("metaserver/static/js/cloud_docs/cloud_doc_api_client",["require","exports","tslib"],(function(e,t,o){"use strict";function r(){return o.__awaiter(this,void 0,void 0,(function*(){const{UserApiV2Client:t}=yield new Promise((t,o)=>{e(["metaserver/static/js/api_v2/user_client"],t,o)}).then(o.__importStar);return(new t).ns("cloud_docs")}))}Object.defineProperty(t,"__esModule",{value:!0}),t.encryptEmail=t.logTokenInUse=t.getPreferredUrl=t.getTeamSettings=t.setSignInSnackbarAsync=t.getSignInSnackbarAsync=t.setUserEducationSnackbarAsync=t.getUserEducationSnackbarAsync=t.setPassSnackbarAsync=t.getPassSnackbarAsync=t.dismissPreferredEditorPrompt=t.getNavigationProperties=t.getLockProviderAsync=t.getCloudDocToken=void 0,t.getCloudDocToken=function(e,t,a,i){(function(e,t){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("get_token",{cloud_doc_id:t},{subjectUserId:e})}))})(e,t).then(a,i)},t.getLockProviderAsync=function(e,t){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("get_lock_provider",{file_id:t},{subjectUserId:e})}))},t.getNavigationProperties=function(e,t,a,i){(function(e,t){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("get_navigation_properties",{cloud_doc_id:t},{subjectUserId:e})}))})(e,t).then(a,i)},t.dismissPreferredEditorPrompt=function(e,t,a){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("preferred_editor_prompt/disable",{integration_name:t,preferred_editor_doc_type:a},{subjectUserId:e})}))},t.getPassSnackbarAsync=function(e,t){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("pass_snackbar/get",{cloud_doc_id:t},{subjectUserId:e})}))},t.setPassSnackbarAsync=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("pass_snackbar/set",void 0,{subjectUserId:e})}))},t.getUserEducationSnackbarAsync=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("user_education_snackbar/get",void 0,{subjectUserId:e})}))},t.setUserEducationSnackbarAsync=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("user_education_snackbar/set",void 0,{subjectUserId:e})}))},t.getSignInSnackbarAsync=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("signin_snackbar/get",void 0,{subjectUserId:e})}))},t.setSignInSnackbarAsync=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("signin_snackbar/set",void 0,{subjectUserId:e})}))},t.getTeamSettings=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("team_settings/get",void 0,{subjectUserId:e})}))},t.getPreferredUrl=function(e,t,a){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("get_preferred_editor_url",{file_id:t,file_ext:a},{subjectUserId:e})}))},t.logTokenInUse=function(e,t,a){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("log_token_in_use",{doc_id:t,auth_token:a},{subjectUserId:e}).catch(()=>new Promise(()=>null))}))},t.encryptEmail=function(t){return o.__awaiter(this,void 0,void 0,(function*(){return(yield(function(){return o.__awaiter(this,void 0,void 0,(function*(){const{NoAuthApiV2Client:t}=yield new Promise((t,o)=>{e(["metaserver/static/js/api_v2/noauth_client"],t,o)}).then(o.__importStar);return(new t).ns("cloud_docs")}))})()).rpc("logged_out/encrypt_email",{email:t},{})}))}})),define("metaserver/static/js/cloud_docs/create_api",["require","exports","tslib","react","typescript/libraries/shared/apex-metrics/src/index","metaserver/static/js/api_v2/user_client","metaserver/static/js/cloud_docs/constants","metaserver/static/js/cloud_docs/create_pointer_modal","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/cloud_docs/types","metaserver/static/js/filepath/filepath","metaserver/static/js/logging/hive/schemas/web-modal-activity","metaserver/static/js/clean/ui/async_file_modal_controller","metaserver/static/js/folder_dialog/async","metaserver/static/js/components/ui/modal","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/browse/api","metaserver/static/js/browse/action_logger","metaserver/static/js/clean/web_user_action_events","metaserver/static/js/core/browser","js/browser/cookies","metaserver/static/js/core/i18n","spectrum/util/uuid_generator","metaserver/static/js/metrics/index","metaserver/static/js/cloud_docs/constants","metaserver/static/js/cloud_docs/create_google_shortcut_modal"],(function(e,t,o,r,a,i,s,n,l,d,c,u,_,m,p,g,f,v,E,h,M,T,S,b,y,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCreateActionSource=t.createNewPointer=t.createNewGoogleShortcut=t.createNewCloudOnlyDoc=t.createPlaceholderTabForNewCloudDoc=t.constructFormForCreateNewMicrosoftFile=t.createNewFile=t.showAsyncFolderDialog=t.logCreateFileSuccessCallback=t.logCreateFileCallback=t.logCreateFileAttempt=t.getDepthFromPath=t.CloudDocSnackbarId=void 0,r=o.__importDefault(r),c=o.__importStar(c),_=o.__importStar(_),m=o.__importStar(m),f=o.__importStar(f),h=o.__importStar(h);const C=T.intl.formatMessage({id:"UpDkTB",defaultMessage:"Create file in..."}),w=T.intl.formatMessage({id:"7E4VWP",defaultMessage:"Create shortcut in..."}),I=T.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),A=T.intl.formatMessage({id:"GDikFY",defaultMessage:"Choose folder"});t.CloudDocSnackbarId="create-cloud-doc";t.getDepthFromPath=e=>(e.replace(/\/$/,"").match(/\//g)||[]).length;t.logCreateFileAttempt=(e,t)=>{(0,l.logUserAction)({actionEvent:d.UserActionEventType.PRE_CREATE,userId:t.userId,actionSource:t.action_source,data:{webOpenId:e}})};t.logCreateFileCallback=({ts:e,documentType:t,selection_mode:r,emptyFolder:i,error:s})=>o.__awaiter(void 0,void 0,void 0,(function*(){const o=(0,b.getMetricsReporter)(),n={};n.document_type=t||"unknown",n.selection_mode=r||"undefined",n.empty_folder=String(i),n.error=s?"true":"false",o.createStats({ns:y.CLOUD_DOCS_AMP_NAMESPACE,name:"web/createFile"},n).recordDuration(Date.now()-e,a.TimeUnit.MILLISECONDS)}));t.logCreateFileSuccessCallback=({ts:e,openId:o,selection_mode:r,empty_folder:a})=>i=>{(0,t.logCreateFileCallback)({ts:Date.now(),documentType:i.documentType,selection_mode:r,emptyFolder:a}),(0,v.logFileCreateSuccess)({uid:i.userId,document_type:i.documentType,time_elapsed:Date.now()-e,open_id:o,selection_mode:r,empty_folder:a}),(0,l.logUserAction)({actionEvent:d.UserActionEventType.CREATE,userId:i.userId,docPathOrId:i.fq_path,actionSource:i.action_source,data:{webOpenId:o}})};t.showAsyncFolderDialog=({user:e,source:o,documentType:r,selection_mode:a,empty_folder:i,handleClickNewFolder:n,initialPath:l})=>{const d=(0,s.isPointerFileType)(r),c=d?w:C,_=d?A:I;m.showFolderDialog({modalName:u.ModalName.CLOUD_DOCS_CREATE,user:e,title:c,primaryActionLabel:_,handleClickNewFolder:n,initialPath:l,useApiV2:!0,onSuccess:(s,n)=>{const l=s||"/";(0,v.logFileCreateClick)({uid:e.id,source:o,action:E.WebUserActionLogEvent.FILE_CREATE_HOME_FOLDER_SELECTED,depth_folder_selected:(0,t.getDepthFromPath)(l),selection_mode:a,empty_folder:i}),(0,t.createNewFile)({user:e,path:l,documentType:r,source:o,selection_mode:a,empty_folder:i})}})};t.createNewFile=({user:r,path:a,documentType:i,source:d,selection_mode:c,empty_folder:u,defaultUrl:_,useApiV2ForPifsCreation:m,createShortcutForGdssFile:p})=>o.__awaiter(void 0,void 0,void 0,(function*(){return Promise.all([new Promise((t,o)=>{e(["metaserver/static/js/account/email"],t,o)}).then(o.__importStar),new Promise((t,o)=>{e(["metaserver/static/js/account/email_verify_reasons"],t,o)}).then(o.__importStar)]).then(([{EmailVerification:e},{EmailVerificationReasons:o}])=>{if(!e.get_for_user(r).verified_or_show(o.CLOUD_DOCS))return;const g=(0,S.generateUUID)("web-create");if((0,s.isMicrosoftFileType)(i)){(0,t.logCreateFileAttempt)(g,{userId:r.id,action_source:(0,l.getActionSourceFromNewFileMenuType)(d)});const e=(0,t.logCreateFileSuccessCallback)({ts:Date.now(),openId:g,selection_mode:c,empty_folder:u});F({userId:r.id,path:a,documentType:i,logSuccessCallback:e,source:d})}else if((0,s.isPointerFileType)(i))n.CreatePointerModal.showInstance({createOnSubmit:e=>{(0,t.logCreateFileAttempt)(g,{userId:r.id,action_source:(0,l.getActionSourceFromNewFileMenuType)(d)});const o=(0,t.logCreateFileSuccessCallback)({ts:Date.now(),openId:g,selection_mode:c,empty_folder:u});(0,t.createNewPointer)({userId:r.id,pathName:a,name:e.pointerData.name,url:e.pointerData.url,onError:e.onError,logSuccessCallback:o,source:d})},defaultUrl:_});else{(0,t.logCreateFileAttempt)(g,{userId:r.id,action_source:(0,l.getActionSourceFromNewFileMenuType)(d)});const e=(0,t.logCreateFileSuccessCallback)({ts:Date.now(),openId:g,selection_mode:c,empty_folder:u});(0,t.createNewCloudOnlyDoc)({userId:r.id,pathName:a,title:T.intl.formatMessage({id:"j+AeKy",defaultMessage:"Untitled"}),documentType:i,logSuccessCallback:e,source:d,openId:g,selection_mode:c,empty_folder:u,useApiV2ForPifsCreation:m,createShortcutForGdssFile:p})}})}));const F=({userId:e,path:o,documentType:r,logSuccessCallback:a,source:i})=>{const s={fq_path:o,extension:r,action_source:(0,t.getCreateActionSource)(i),_subject_uid:String(e),t:M.Cookies.read("__Host-js_csrf")},n=(0,t.constructFormForCreateNewMicrosoftFile)(s);document.body.appendChild(n),n.submit(),a({userId:e,documentType:r,action_source:(0,l.getActionSourceFromNewFileMenuType)(i)})};t.constructFormForCreateNewMicrosoftFile=e=>{const t=document.createElement("form");t.action="/ow/msft/create_new_file",t.method="POST",t.target="_blank";for(const o of Object.keys(e)){const r=document.createElement("input");r.type="hidden",r.name=o,r.value=e[o],t.appendChild(r)}return t};t.createPlaceholderTabForNewCloudDoc=()=>h.open_tab(s.LOADING_PAGE_URL,!0);t.createNewCloudOnlyDoc=({userId:e,pathName:o,title:a,documentType:n,logSuccessCallback:d,source:u,openId:m,selection_mode:v,empty_folder:E,useApiV2ForPifsCreation:M,createShortcutForGdssFile:S})=>{const b=T.intl.formatMessage({id:"XcMi4Q",defaultMessage:"Creating new file…"}),y=T.intl.formatMessage({id:"5VrbkU",defaultMessage:"File created!"});if(M&&(n===s.PaperNewFileTypes.PAPER||n===s.PaperNewFileTypes.PAPER_TEMPLATE)){g.Snackbar.sync(b,!0,t.CloudDocSnackbarId);const r=new i.UserApiV2Client,_={".tag":n===s.PaperNewFileTypes.PAPER_TEMPLATE?"paper_template":"paper"};return void r.ns("cloud_docs").rpc("create",{to_path:c.normalize(o)||"/",title:a,cloud_doc_type:_},{subjectUserId:e}).then(o=>{g.Snackbar.complete(y,t.CloudDocSnackbarId),d({userId:e,documentType:n,fq_path:o.result_path,action_source:(0,l.getActionSourceFromNewFileMenuType)(u)}),h.open_tab(o.url)}).catch(()=>{(0,t.logCreateFileCallback)({ts:Date.now(),documentType:n,selection_mode:v,emptyFolder:E,error:!0}),g.Snackbar.fail(T.intl.formatMessage({id:"fi9Okp",defaultMessage:"Oops, something went wrong. Please try again later."}),t.CloudDocSnackbarId)})}if(S&&Object.values(s.GoogleFileTypes).includes(n))return void p.Modal.showInstance(r.default.createElement(O.CreateGoogleShortcutModal,{fileType:n,onCreate:e=>{(0,t.createNewGoogleShortcut)()}}));const C=e=>(e.preventDefault(),e.returnValue="","");window.addEventListener("beforeunload",C);let w=(0,t.createPlaceholderTabForNewCloudDoc)();const I=r=>{g.Snackbar.sync(b,!0,t.CloudDocSnackbarId),f.createCloudDoc({pathName:o,title:a,documentType:n,userId:e,onSuccess:({changesets:o,createdFile:r,failureDetails:a})=>{if(a){const e=()=>{d=(0,t.logCreateFileSuccessCallback)({ts:Date.now(),openId:m,selection_mode:v,empty_folder:E}),w=(0,t.createPlaceholderTabForNewCloudDoc)(),I(!1)};w.close(),g.Snackbar.close(t.CloudDocSnackbarId),window.removeEventListener("beforeunload",C),_.showFileSystemWarningsModal({fsws:a,confirmText:T.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),onFinalAccept:e})}else if(g.Snackbar.complete(y,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",C),null!==r&&(d({userId:e,documentType:n,fq_path:r.fq_path,action_source:(0,l.getActionSourceFromNewFileMenuType)(u)}),w)){let e=r.open_to_url;try{const t=new URL(e);t.searchParams.set("web_open_id",m),e=t.toString()}catch(e){}w.location.replace(e)}},onError:e=>{(0,t.logCreateFileCallback)({ts:Date.now(),documentType:n,selection_mode:v,emptyFolder:E,error:!0}),g.Snackbar.fail(e,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",C)},checkFSWs:r})};I(!0)};t.createNewGoogleShortcut=()=>{};t.createNewPointer=({userId:e,pathName:t,name:o,url:r,onError:a,logSuccessCallback:n,source:u})=>{const _=new i.UserApiV2Client,m=T.intl.formatMessage({id:"l6L9q8",defaultMessage:"Creating new shortcut"}),f=T.intl.formatMessage({id:"EqUCHi",defaultMessage:"Created shortcut"});return g.Snackbar.sync(m,!0,"create-cloud-shortcut"),_.ns("cloud_docs").rpc("create",{to_path:c.normalize(t)||"/",title:o,cloud_doc_type:d.SimplePointer,pointer_url:r},{subjectUserId:e}).then(t=>{n({userId:e,documentType:s.PointerFileTypes.SIMPLE_POINTER,fq_path:t.result_path,action_source:(0,l.getActionSourceFromNewFileMenuType)(u)}),p.Modal.close(),g.Snackbar.complete(`${f} "${c.filename(t.result_path)}"`,"create-cloud-shortcut")}).catch(e=>{a(),g.Snackbar.fail(T.intl.formatMessage({id:"fi9Okp",defaultMessage:"Oops, something went wrong. Please try again later."}),"create-cloud-shortcut")})};t.getCreateActionSource=e=>{switch(e){case s.NewFileMenuFromType.BROWSE:return s.ActionSourceValue.WEB_BROWSE;case s.NewFileMenuFromType.HOME:return s.ActionSourceValue.WEB_HOME;default:return s.ActionSourceValue.WEB}}})),define("metaserver/static/js/cloud_docs/create_pointer_modal",["require","exports","tslib","react","metaserver/static/js/cloud_docs/pointers_common","metaserver/static/js/components/ui/css","metaserver/static/js/components/ui/modal","metaserver/static/js/core/i18n","dig-components/modal","dig-components/buttons"],(function(e,t,o,r,a,i,s,n,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreatePointerModal=void 0,r=o.__importDefault(r);const c=n.intl.formatMessage({id:"8yzGEK",defaultMessage:"Create a new shortcut"}),u=n.intl.formatMessage({id:"S8dvWz",defaultMessage:"Create"}),_=n.intl.formatMessage({id:"I5Fo4y",defaultMessage:"Creating..."}),m=n.intl.formatMessage({id:"vPeF94",defaultMessage:"Name"}),p=n.intl.formatMessage({id:"nYdrYR",defaultMessage:"URL"}),g=n.intl.formatMessage({id:"U1i5X8",defaultMessage:"Invalid URL"});class f extends r.default.Component{constructor(e){super(e),this.onChange=e=>{this.setState({pointerData:e})},this.handleCreateOnClick=()=>{this.setState({creationInProgress:!0}),this.props.createOnSubmit({pointerData:{name:this.state.pointerData.name.trim(),url:this.state.pointerData.url.trim()},onError:this.handleSubmitError})},this.handleSubmitError=()=>{this.setState({creationInProgress:!1})},this.closeModal=()=>{s.Modal.close()},this.state={pointerData:{name:"",url:""},creationInProgress:!1}}render(){const e=a.CreatePointerFields.canSubmit(this.state.pointerData)&&!this.state.creationInProgress;return r.default.createElement(l.Modal,{title:c,"aria-label":"Shortcut Creation Modal",open:!0},r.default.createElement(l.Modal.Header,{hasBottomSpacing:"title-standard"},r.default.createElement(l.Modal.Title,null,c)),r.default.createElement(l.Modal.Body,{hasVerticalSpacing:!1},r.default.createElement(a.CreatePointerFields,{name:this.state.pointerData.name,url:this.state.pointerData.url,onChange:this.onChange,onSubmit:this.handleCreateOnClick,nameLabel:m,urlLabel:p,urlValidationMessage:g,urlPrepopulateFunction:()=>Promise.resolve(this.props.defaultUrl)})),r.default.createElement(l.Modal.Footer,null,r.default.createElement(d.Button,{variant:"opacity",onClick:this.closeModal},n.intl.formatMessage({id:"gZIlfg",defaultMessage:"Cancel"})),r.default.createElement(d.Button,{variant:"primary",disabled:!e,onClick:this.handleCreateOnClick},this.state.creationInProgress?_:u)))}static showInstance(e){return s.Modal.showInstance(r.default.createElement(v,Object.assign({},e)))}}t.CreatePointerModal=f,f.displayName="CreatePointerModal";const v=(0,i.requireCssWithComponent)(f,["/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css","/static/metaserver/static/css/cloud_docs/create_pointer_modal-vflATc8Dt.css"])})),define("metaserver/static/js/cloud_docs/event_logging",["require","exports","tslib","metaserver/static/js/api_v2/user_client","metaserver/static/js/api_v2/noauth_client","metaserver/static/js/cloud_docs/types","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/clean/web_user_action_events","metaserver/static/js/logging/hive/schemas/web-user-action","metaserver/static/js/logging/telemetry","metaserver/static/js/file_viewer/constants","metaserver/static/js/cloud_docs/constants","metaserver/static/js/perf_tools/web_timing_utils","metaserver/static/js/core/exception","metaserver/static/js/filepath/filepath"],(function(e,t,o,r,a,i,s,n,l,d,c,u,_,m,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logLoggedOutUXSnackBarAction=t.logInterstitialLoginAction=t.logFileConvertPromptAction=t.logFileOpenPromptAction=t.getActionSourceFromNewFileMenuType=t.getActionSourceFromSourceArgs=t.getActionSourceFromSurface=t.checkAndLogNpu=t.logLoggedOutUserAction=t.logUserAction=t.logClientEvent=t.logViewEvent=t.getStartTime=void 0,s=o.__importStar(s),d=o.__importStar(d);let g=void 0;t.getStartTime=()=>{try{g=g||window.performance.timing.fetchStart}catch(e){(0,m.reportStack)("Unable to get fetchStart from browser.",{severity:m.SEVERITY.NONCRITICAL}),g=s.start_time()}return g},t.logViewEvent=function(e,t,o){const a={file_views:[{file_info:{shared_link_details:{url:t}},platform_type:{".tag":o}}]};(new r.UserApiV2Client).ns("seen_state").rpc("log_file_view",a,{subjectUserId:e})},t.logClientEvent=function(e,o,r,n,l){const d=l||[];d.push({key:"time_on_page_with_redirect",value:s.time_since_start().toString()}),d.some(e=>"time_now"===e.key)||d.push({key:"time_now",value:Date.now().toString()}),(new a.NoAuthApiV2Client).ns("cloud_docs").rpc("log_client_event",{client:i.editorTypeToClient[o],doc_id:e,event_name:r,auth_token:n,time_on_page:_.WebTimingUtil.getNow()-(0,t.getStartTime)(),extras:d},{})},t.logUserAction=function(e){const t=(new r.UserApiV2Client).ns("cloud_docs");let o;e.hasOwnProperty("docPathOrId")&&e.docPathOrId&&(o={".tag":"path_or_id",path_or_id:e.docPathOrId});const a=e.data&&e.data.webOpenId,i=e.data&&e.data.origDest,s=e.data&&e.data.routingDest;t.rpc("log_user_action",{action:e.actionEvent,doc_id:o,source:e.actionSource,open_id:a,orig_dest:i,routing_dest:s,extra_info:e.extra},{subjectUserId:e.userId})},t.logLoggedOutUserAction=function(e){const t=(new a.NoAuthApiV2Client).ns("cloud_docs");let o;e.hasOwnProperty("docPathOrId")&&e.docPathOrId&&(o={".tag":"path_or_id",path_or_id:e.docPathOrId});const r=e.data&&e.data.webOpenId,i=e.data&&e.data.origDest,s=e.data&&e.data.routingDest;t.rpc("logged_out/log_user_action",{action:e.actionEvent,doc_id:o,source:e.actionSource,open_id:r,orig_dest:i,routing_dest:s,extra_info:e.extra},{})},t.checkAndLogNpu=function(e,t,o,a,i){(new r.UserApiV2Client).ns("cloud_docs").rpc("log_new_partner_users",{partner:t,cloud_doc_type:(0,p.file_extension)(o),cloud_editor:a,platform:i},{subjectUserId:e})};t.getActionSourceFromSurface=e=>"search"===e?i.UserActionSourceType.WEB_SEARCH:"previews"===e?i.UserActionSourceType.WEB_PREVIEW:"home_recent"===e||"home_starred"===e?i.UserActionSourceType.WEB_HOME:"browse"===e||"sidebar"===e?i.UserActionSourceType.WEB_BROWSE:i.UserActionSourceType.WEB;t.getActionSourceFromSourceArgs=e=>e.fileViewOrigin===c.FileViewOriginType.SEARCH?i.UserActionSourceType.WEB_SEARCH:e.fileViewOrigin===c.FileViewOriginType.BROWSE?i.UserActionSourceType.WEB_BROWSE:e.fileViewOrigin===c.FileViewOriginType.HOME?i.UserActionSourceType.WEB_HOME:i.UserActionSourceType.WEB;t.getActionSourceFromNewFileMenuType=e=>{switch(e){case u.NewFileMenuFromType.BROWSE:return i.UserActionSourceType.WEB_BROWSE;case u.NewFileMenuFromType.HOME:return i.UserActionSourceType.WEB_HOME;default:return i.UserActionSourceType.WEB}},t.logFileOpenPromptAction=function(e,t,o,r,a){(new d.HiveLogger).log(new l.WebUserActionRow({user_id:e,event_name:n.WebUserActionLogEvent.FILE_OPEN_PROMPT_ACTION,extra:{file_type:t,integration_name:o,prompt_action:r,ask_again:a}}))},t.logFileConvertPromptAction=function(e,t,o,r){(new d.HiveLogger).log(new l.WebUserActionRow({user_id:e,event_name:n.WebUserActionLogEvent.FILE_CONVERT_PROMPT_ACTION,extra:{prompt_action:t,integration_name:o,file_extension:r}}))},t.logInterstitialLoginAction=function(e,t,o){(new d.HiveLogger).log(new l.WebUserActionRow({event_name:n.WebUserActionLogEvent.INTERSTITIAL_LOGIN_ACTION,extra:{prompt_action:e,logged_out_ux_google_variant:t,file_extension:o}}))},t.logLoggedOutUXSnackBarAction=function(e,t,o,r){(new d.HiveLogger).log(new l.WebUserActionRow({event_name:n.WebUserActionLogEvent.LOGGED_OUT_UX_SNACKBAR_ACTION,extra:{prompt_action:e,file_extension:t,logged_out_ux_google_variant:o||"",logged_out_ux_paper_variant:r||""}}))}})),define("metaserver/static/js/cloud_docs/open_with_utils",["require","exports","tslib","typescript/libraries/shared/apex-metrics/src/index","metaserver/static/js/core/browser","metaserver/static/js/cloud_docs/constants","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/cloud_docs/types","metaserver/static/js/clean/referrer_cleansing_redirect","metaserver/static/js/cloud_docs/constants","metaserver/static/js/core/uri","metaserver/static/js/cloud_docs/utils","metaserver/static/js/clean/open_with","spectrum/util/uuid_generator","metaserver/static/js/core/browser_detection","metaserver/static/js/cloud_docs/create_api","metaserver/static/js/metrics/index"],(function(e,t,o,r,a,i,s,n,l,d,c,u,_,m,p,g,f){"use strict";let v;Object.defineProperty(t,"__esModule",{value:!0}),t.getGoogleEditorType=t.isCloudBasedDoc=t.isShortcut=t.isGoogleDoc=t.getOpenWithWopiEditorInfo=t.getOpenWithGoogleEditorInfo=t.getOpenWithCloudEditorInfo=t.OpenWithCloudDocProvider=t.openCloudDoc=t.openWithCloudEditor=t.fileToOpenWithParams=t.openCloudEditorUrl=t.isInEdgeIframe=t.handleError=t.decodeAPIError=t.getCloudEditorUrl=t.getCloudEditorUrlCached=void 0,l=o.__importStar(l),_=o.__importDefault(_),p=o.__importStar(p);t.getCloudEditorUrlCached=(e,r)=>o.__awaiter(void 0,void 0,void 0,(function*(){return v||(v=(0,t.getCloudEditorUrl)(e,r)),v}));function E(e){if(void 0!==e&&void 0!==e.error&&void 0!==e.error[".tag"])return e.error[".tag"]}function h(e){switch(E(e)){case"invalid_file_id":case"permission_denied":case"other":default:return}}t.getCloudEditorUrl=(t,r)=>o.__awaiter(void 0,void 0,void 0,(function*(){return(yield(function(){return o.__awaiter(this,void 0,void 0,(function*(){const{UserApiV2Client:t}=yield new Promise((t,o)=>{e(["metaserver/static/js/api_v2/user_client"],t,o)}).then(o.__importStar);return(new t).ns("cloud_docs")}))})()).rpc("get_cloud_editor_url",{file_id:r},{subjectUserId:t})})),t.decodeAPIError=E,t.handleError=h;function M(e,t,o,r,i,l,d){const u=(0,m.generateUUID)("web_open_id"),_=c.URI.parse(e.cloud_editor_url).updateQuery({cloud_editor:i,web_open_id:u});l&&_.updateQuery({ignore_lock:"1"});const p=_.toString();p&&(void 0===d&&(d=n.UserActionSourceType.WEB),(0,s.logUserAction)({actionEvent:n.UserActionEventType.PRE_OPEN,userId:r,docPathOrId:o,actionSource:d,data:{webOpenId:u}}),null!=t?(0,a.redirect)(p,t):(0,a.open_tab)(p))}t.isInEdgeIframe=()=>{let e=!1;if(p.edge||p.msie||p.edgeChromium())try{e=window.self!==window.top}catch(t){e=!0}return e},t.openCloudEditorUrl=M;t.fileToOpenWithParams=e=>({fileId:e.file_id,openToUrl:e.open_to_url});t.openWithCloudEditor=({fileId:e,openToUrl:a},s,n,l,d)=>o.__awaiter(void 0,void 0,void 0,(function*(){try{const o=performance.now(),c=(0,f.getMetricsReporter)(),u={};try{u.editor=n,d&&(u.source=d[".tag"]);const _=(0,t.isInEdgeIframe)();if(u.isInEdgeIframe=String(_),a&&a.startsWith("https://www.dropbox.com/scl/fi/")){u.usedOpenToURLFromFile="true",M({cloud_editor_url:a},null,e,s,n,l,d)}else{u.usedOpenToURLFromFile="false";const o=_?null:(0,g.createPlaceholderTabForNewCloudDoc)();M(_?yield(0,t.getCloudEditorUrlCached)(s,e):yield(0,t.getCloudEditorUrl)(s,e),o,e,s,n,l,d)}u.error="false"}catch(e){u.error="true",h(e)}finally{c.createStats({ns:i.CLOUD_DOCS_AMP_NAMESPACE,name:"web/openWithCloudEditor"},u).recordDuration(performance.now()-o,r.TimeUnit.MILLISECONDS)}}catch(e){h(e)}}));var T;t.openCloudDoc=(t,r,d)=>{if(d||(d=n.UserActionSourceType.WEB),t.href)if((0,i.isPointerByExtension)(t.ns_path))l.safe_open_tab_and_redirect(t.href),(0,s.logUserAction)({actionEvent:n.UserActionEventType.PRE_OPEN,userId:r.id,docPathOrId:t.file_id,actionSource:d});else{const e=(0,m.generateUUID)("web_open_id"),o=c.URI.parse(t.href).updateQuery("web_open_id",e).toString();(0,a.open_tab)(o),(0,s.logUserAction)({actionEvent:n.UserActionEventType.PRE_OPEN,userId:r.id,docPathOrId:t.file_id,actionSource:d,data:{webOpenId:e}})}else{const a=(0,g.createPlaceholderTabForNewCloudDoc)();new Promise((t,o)=>{e(["metaserver/static/js/previews/data/actions"],t,o)}).then(o.__importStar).then(e=>e.fetchPreviewUrl(t,r)).then(e=>{e&&null!==a&&l.redirect(e,a,!0)})}},(function(e){e.OfficeOnline="OfficeOnline",e.GoogleDSS="GoogleDSS"})(T=t.OpenWithCloudDocProvider||(t.OpenWithCloudDocProvider={}));t.getOpenWithCloudEditorInfo=(e,o,r,a)=>{const i=[],s=(0,t.getOpenWithWopiEditorInfo)(e,o,a);s&&r.wopi&&i.push(s);const n=(0,t.getOpenWithGoogleEditorInfo)(e,o,a);return n&&r.gdd&&i.push(n),i};t.getOpenWithGoogleEditorInfo=(e,o,r)=>{const a=y(e,o);return a?{text:d.DSS_TYPE_TO_TEXT[a],iconUrl:d.DSS_TYPE_TO_OPEN_WITH_ICONS[a],handler:()=>(0,t.openWithCloudEditor)((0,t.fileToOpenWithParams)(e),o.id,a,!1,r),provider:T.GoogleDSS}:null};function S(e){return[".gdoc",".gsheet",".gslides"].indexOf((0,u.getFileExt)(e))>=0}function b(e){return".web"===(0,u.getFileExt)(e)}function y(e,t){const o=(0,u.getFileExt)(e);for(const e of Object.keys(d.DSS_TYPE_TO_SUPPORTED_EXTS)){const t=e;if(d.DSS_TYPE_TO_SUPPORTED_EXTS[t].indexOf(o)>=0)return t}switch(o){case".gdoc":return d.GoogleFileTypes.GOOGLE_DSS_DOC;case".gsheet":return d.GoogleFileTypes.GOOGLE_DSS_SHEET;case".gslides":return d.GoogleFileTypes.GOOGLE_DSS_SLIDES}return null}t.getOpenWithWopiEditorInfo=(e,o,r)=>{const a=_.default.getWopiOpenWithButtonInfo(e);return a?{text:a.name,spriteName:a.icon,handler:()=>(0,t.openWithCloudEditor)((0,t.fileToOpenWithParams)(e),o.id,a.editor,!1,r),provider:T.OfficeOnline}:null},t.isGoogleDoc=S,t.isShortcut=b,t.isCloudBasedDoc=function(e){return!!S(e)||!!b(e)},t.getGoogleEditorType=y})),define("metaserver/static/js/cloud_docs/pointers_common",["require","exports","tslib","ts-key-enum","react","dig-components/text_fields"],(function(e,t,o,r,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreatePointerFields=void 0,a=o.__importStar(a);class s extends a.Component{constructor(){super(...arguments),this.handleKeyPress=e=>{e.key===r.Key.Enter&&s.canSubmit({name:this.props.name,url:this.props.url})&&this.props.onSubmit()},this.handleNameChange=e=>{const t=e.target.value;this.props.onChange({name:t,url:this.props.url})},this.handleUrlChange=e=>{const t=e.target.value;this.props.onChange({name:this.props.name,url:t})},this.setNameFieldRef=e=>{this.nameRef=e}}render(){const e=""===this.props.url||s.isUrlValid(this.props.url);let t="";return e||(t=this.props.urlValidationMessage),a.createElement("div",{className:"create-pointer--fields"},a.createElement("div",{className:"create-pointer--fieldset"},a.createElement("label",{htmlFor:"create-pointer--link_input"},this.props.urlLabel),a.createElement("div",{className:"create-pointer--fieldset-with-icon"},this.props.urlIcon,a.createElement(i.TextInput,{id:"create-pointer--link_input",className:"create-pointer--link_input",isInvalid:!e,onChange:this.handleUrlChange,onKeyPress:this.handleKeyPress,value:this.props.url,placeholder:this.props.urlPlaceholder,autoFocus:!0}))),a.createElement("div",{className:"create-pointer--url-validation-warning"},t),a.createElement("div",{className:"create-pointer--fieldset"},a.createElement("label",{htmlFor:"create-pointer--name_input"},this.props.nameLabel),a.createElement(i.TextInput,{id:"create-pointer--name_input",onChange:this.handleNameChange,onKeyPress:this.handleKeyPress,ref:this.setNameFieldRef,placeholder:this.props.namePlaceholder})))}componentDidMount(){return o.__awaiter(this,void 0,void 0,(function*(){if(this.props.urlPrepopulateFunction){const e=yield this.props.urlPrepopulateFunction();e&&(this.props.onChange({name:this.props.name,url:e}),this.nameRef.focus())}}))}}t.CreatePointerFields=s,s.isUrlValid=e=>/^((http|https):\/\/)?([^.:/\\?#@!]+?\.)+[^.:/\\?#@!]+/i.test(e.trim()),s.canSubmit=e=>""!==e.name&&""!==e.url&&s.isUrlValid(e.url),s.displayName="CreatePointerFields"})),define("metaserver/static/js/cloud_docs/preferred_editor_utils",["require","exports","tslib","metaserver/static/js/core/i18n","metaserver/static/js/core/browser","metaserver/static/js/core/exception","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/cloud_docs/utils","metaserver/static/js/cloud_docs/types","react","metaserver/static/js/filepath/filepath","metaserver/static/js/cloud_docs/open_with_utils","metaserver/static/js/core/uri","metaserver/static/js/cloud_docs/cloud_doc_api_client","spectrum/util/uuid_generator","metaserver/static/js/cloud_docs/preferred_editor_constants","metaserver/static/js/cloud_docs/create_api"],(function(e,t,o,r,a,i,s,n,l,d,c,u,_,m,p,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPreferredEditorPrompt=t.openInPreferredEditor=t.hasPreferredEditorSupport=void 0,d=o.__importDefault(d),t.hasPreferredEditorSupport=function(e){const t=(0,n.getFileExt)(e);return g.PREFERRED_EDITOR_SUPPORTED_EXTS.indexOf(t)>=0},t.openInPreferredEditor=function(e,t,o,r,d){const c=(0,n.getFileExt)(t),v=o[e.id];let E="";if(v)try{const o=v[g.EXTENSION_TO_DOC_TYPE[c]],n=o===g.PreferredEditorTypes.GoogleDSS||o===g.PreferredEditorTypes.OfficeOnline,h=(0,p.generateUUID)("web_open_id");if(t.is_in_vault_folder)return n&&(0,s.logUserAction)({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:(0,s.getActionSourceFromSourceArgs)(d),data:{webOpenId:h},extra:{block_vault_content:"true"}}),void r();if(n){const o=(0,f.createPlaceholderTabForNewCloudDoc)();(0,u.getCloudEditorUrl)(e.id,t.file_id).then(a=>{E=_.URI.parse(a.cloud_editor_url).updateQuery("web_open_id",h).toString(),o?o.location.replace(E):r(),(0,s.logUserAction)({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:(0,s.getActionSourceFromSourceArgs)(d),data:{webOpenId:h}})}).catch(e=>{(0,i.reportStack)("Error getting cloud editor url from preferred editor open.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:E,file_ext:c,preferred_editor_configs:v,error:e.message}}),o&&o.close(),r()})}else(0,m.getPreferredUrl)(e.id,t.file_id,c).then(o=>{o.preferred_editor_url&&(E=_.URI.parse(o.preferred_editor_url).updateQuery("web_open_id",h).toString(),(0,s.logUserAction)({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:(0,s.getActionSourceFromSourceArgs)(d),data:{webOpenId:h}}),(0,a.redirect)(E))}).catch(e=>{(0,i.reportStack)("Error getting preferred editor url from preferred editor open.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:E,file_ext:c,preferred_editor_configs:v,error:e.message}})}),r()}catch(e){(0,i.reportStack)("Error opening docs in preferred editor.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:E,file_ext:c,preferred_editor_configs:v,error:e.message}}),r()}else r()},t.getPreferredEditorPrompt=function(e,t){const o="."+(0,c.file_extension)(e),a=g.EXTENSION_TO_DOC_TYPE[o],i=g.INTEGRATION_NAME_TO_PROMPT[t][a];return i?{title:r.intl.formatMessage({id:"jXF9I9",defaultMessage:"Would you like to open <b>{file_extension}</b> files with {web_editor_name} by default?"},{file_extension:o,web_editor_name:i,b:e=>d.default.createElement("b",null,e)}),body:r.intl.formatMessage({id:"f37GH8",defaultMessage:"{web_editor_name} will automatically be used to open your <b>{file_extension}</b> files in Dropbox. You can always update this later in your Dropbox settings."},{file_extension:o,web_editor_name:i,b:e=>d.default.createElement("b",null,e)})}:null}})),define("metaserver/static/js/cloud_docs/preferred_editor_constants",["require","exports","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/types"],(function(e,t,o,r){"use strict";var a,i;Object.defineProperty(t,"__esModule",{value:!0}),t.IntegrationNameToPreferredEditorEnums=t.INTEGRATION_NAME_TO_PROMPT=t.PREFERRED_EDITOR_SUPPORTED_EXTS=t.EXTENSION_TO_DOC_TYPE=t.PreferredEditorOptionsMap=t.PreferredEditorDocTypes=t.PreferredEditorTypes=void 0,(function(e){e[e.Unknown=0]="Unknown",e[e.FileViewer=1]="FileViewer",e[e.OfficeOnline=2]="OfficeOnline",e[e.GoogleDSS=3]="GoogleDSS"})(a=t.PreferredEditorTypes||(t.PreferredEditorTypes={})),(function(e){e.WORD="ms_word",e.EXCEL="ms_excel",e.POWERPOINT="ms_powerpoint"})(i=t.PreferredEditorDocTypes||(t.PreferredEditorDocTypes={})),t.PreferredEditorOptionsMap={[i.WORD]:{1:o.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:o.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),3:o.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"})},[i.EXCEL]:{1:o.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:o.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),3:o.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"})},[i.POWERPOINT]:{1:o.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:o.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"}),3:o.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"})}},t.EXTENSION_TO_DOC_TYPE={".docx":i.WORD,".doc":i.WORD,".xlsx":i.EXCEL,".xls":i.EXCEL,".pptx":i.POWERPOINT,".ppt":i.POWERPOINT},t.PREFERRED_EDITOR_SUPPORTED_EXTS=Object.keys(t.EXTENSION_TO_DOC_TYPE),t.INTEGRATION_NAME_TO_PROMPT={[r.IntegrationName.GOOGLE_DSS]:{[i.WORD]:o.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),[i.EXCEL]:o.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),[i.POWERPOINT]:o.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"})},[r.IntegrationName.OFFICE_ONLINE]:{[i.WORD]:o.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),[i.EXCEL]:o.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),[i.POWERPOINT]:o.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"})},[r.IntegrationName.PAPER_INTEGRATION]:{}},t.IntegrationNameToPreferredEditorEnums={[r.IntegrationName.GOOGLE_DSS]:a.GoogleDSS,[r.IntegrationName.OFFICE_ONLINE]:a.OfficeOnline,[r.IntegrationName.PAPER_INTEGRATION]:a.Unknown}})),define("metaserver/static/js/cloud_docs/utils",["require","exports","metaserver/static/js/filepath/filepath","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/cloud_docs/types"],(function(e,t,o,r,a){"use strict";function i(e){return e.replace(/[/?<>:*\\]/g,"_")}Object.defineProperty(t,"__esModule",{value:!0}),t.replaceInvalidURLFilenameChars=t.replaceInvalidFilenameChars=t.integrationNameToShareActionOrigin=t.getFileExt=void 0,t.getFileExt=function(e){let t="";return e.hasOwnProperty("ext")?t=e.ext:e.hasOwnProperty("filename")?(t=(0,o.file_extension)(e.filename),t&&(t="."+t)):(t=(0,o.file_extension)(e),t&&(t="."+t)),t},t.integrationNameToShareActionOrigin=function(e){switch(e){case a.IntegrationName.GOOGLE_DSS:return r.SHARE_ACTION_ORIGIN_TYPE.GOOGLE_DSS;case a.IntegrationName.PAPER_INTEGRATION:return r.SHARE_ACTION_ORIGIN_TYPE.PAPER_INTEGRATION;case a.IntegrationName.OFFICE_ONLINE:return r.SHARE_ACTION_ORIGIN_TYPE.OFFICE_INTEGRATION;default:throw"No mapping for integration to share action origin: "+e}},t.replaceInvalidFilenameChars=i,t.replaceInvalidURLFilenameChars=function(e){return i(e).replace(/\ /g,"-")}})),define("metaserver/static/js/account_page/tabs/default_apps",["require","exports","tslib","react","metaserver/static/js/account_page/widgets/preferred_editor/view","metaserver/static/js/account_page/widgets/desktop_settings/view","metaserver/static/js/account_page/widgets/linked_apps/logger","metaserver/static/js/vault/components/vault_account_section_async","metaserver/static/js/clean/active_user"],(function(e,t,o,r,a,i,s,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize_module=t.moduleInit=t.DefaultAppsTab=void 0,r=o.__importDefault(r);class d extends r.default.Component{componentDidMount(){(0,s.logEvent)("view_default_apps_page")}render(){const{expVaultTCSecurityEnhancement:e,gddMigrationHideDefaultApps:t,showPaperDesktopSettings:o}=this.props,s=(0,l.mustGetActiveUserId)();return r.default.createElement("div",{className:"account-page-tab"},r.default.createElement(a.PreferredEditors,{gddMigrationHideDefaultApps:t}),o?r.default.createElement(i.DesktopSettings,{ref:"desktopSettings"}):null,r.default.createElement(n.AsyncVaultAccountSection,{userId:s,expVaultTCSecurityEnhancement:e}))}}t.DefaultAppsTab=d,d.displayName="DefaultAppsTab",t.moduleInit=function(e){},t.initialize_module=function(e){}})),define("metaserver/static/js/account_page/widgets/desktop_settings/view",["require","exports","tslib","metaserver/static/js/core/i18n","react","js/browser/cookies","metaserver/static/js/account_page/components/dropdown_block","metaserver/static/js/core/notify","styled-components"],(function(e,t,o,r,a,i,s,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DesktopSettings=void 0,a=o.__importDefault(a);const d=(l=o.__importDefault(l)).default.h2`
  &&& {
    padding-left: 0;
    padding-right: 0;
    padding-bottom: 0;
  }
`,c={desktopSettingsHeader:r.intl.formatMessage({id:"8r3ApF",defaultMessage:"Paper desktop app"}),desktopSettingsMessage:r.intl.formatMessage({id:"z6Rf6I",defaultMessage:"Choose what happens when you click a link to a Paper doc on this computer."}),desktopOption:r.intl.formatMessage({id:"pCdNnf",defaultMessage:"Open in desktop app"}),webOption:r.intl.formatMessage({id:"1NiPiC",defaultMessage:"Open in web browser"})},u={0:c.desktopOption,1:c.webOption};class _ extends a.default.PureComponent{constructor(e){super(e),this.handleChangeDesktopAutoRedirect=e=>{0===Number(e)?this.enableDesktopAutoRedirectForDevice():this.disableDesktopAutoRedirectForDevice(),this.setState({desktopAutoRedirectEnabled:0===Number(e)}),n.Notify.success(r.intl.formatMessage({id:"MmMgu9",defaultMessage:"Paper app setting updated."}))},this.state={desktopAutoRedirectEnabled:this.isDesktopAutoRedirectEnabledForDevice()}}isDesktopAutoRedirectEnabledForDevice(){const e=this.getDesktopAutoRedirectSnoozeForDevice();return Date.now()>e}getDesktopAutoRedirectSnoozeForDevice(){const e=i.Cookies.read("dc_ars")||"",t=parseFloat(e);return isNaN(t)?"0"===i.Cookies.read("dc_ar")?2**42:0:t}enableDesktopAutoRedirectForDevice(){this.setDesktopAutoRedirectForDevice(0)}disableDesktopAutoRedirectForDevice(){this.setDesktopAutoRedirectForDevice(2**42)}setDesktopAutoRedirectForDevice(e){i.Cookies.create("dc_ars",`${e}`,730,".dropbox.com"),i.Cookies.delete("dc_ar")}render(){const e=this.state.desktopAutoRedirectEnabled;return a.default.createElement(s.DropdownBlock,{label:a.default.createElement(d,{className:"account-page-block__heading"},c.desktopSettingsHeader),subLabel:c.desktopSettingsMessage,selected:e?0:1,items:u,onItemSelected:this.handleChangeDesktopAutoRedirect,className:"paper-desktop-connected-apps-dropdown"})}}t.DesktopSettings=_,_.displayName="DesktopSettings"})),define("metaserver/static/js/account_page/widgets/preferred_editor/api",["require","exports","tslib","metaserver/static/js/api_v2/user_client"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.preferredEditorSet=t.preferredEditorGet=void 0;t.preferredEditorGet=e=>o.__awaiter(void 0,void 0,void 0,(function*(){return(new r.UserApiV2Client).ns("cloud_docs").rpc("preferred_editor/get",void 0,{subjectUserId:e})}));t.preferredEditorSet=(e,t,a)=>o.__awaiter(void 0,void 0,void 0,(function*(){return(new r.UserApiV2Client).ns("cloud_docs").rpc("preferred_editor/set",{editor_enum:Number(a),doc_type:t},{subjectUserId:e})}))})),define("metaserver/static/js/account_page/widgets/preferred_editor/view",["require","exports","tslib","react","styled-components","spectrum/icon_partners/index","metaserver/static/js/account_page/components/action_table","metaserver/static/js/clean/active_user","dig-components/buttons","dig-components/menu","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/core/i18n","metaserver/static/js/account_page/widgets/preferred_editor/api","metaserver/static/js/cloud_docs/cloud_doc_api_client","metaserver/static/js/cloud_docs/types","metaserver/static/js/cloud_docs/preferred_editor_constants"],(function(e,t,o,r,a,i,s,n,l,d,c,u,_,m,p,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreferredEditors=void 0,r=o.__importDefault(r),a=o.__importDefault(a),m=o.__importStar(m);class v extends s.ActionTable{}const E=a.default.div`
  display: flex;
  align-items: center;
`,h=a.default.span`
  margin-right: var(--spacing__base_unit);
  margin-top: 6px;
`;class M extends r.default.Component{constructor(e){super(e),this.preferredEditorGet=e=>m.preferredEditorGet(e).then(e=>{const t=e.preferred_editor_map;for(const e of Object.keys(t)){const o=e;t[o]===f.PreferredEditorTypes.Unknown?t[o]=f.PreferredEditorTypes.FileViewer:this.state.supportedEditorTypes[t[o]]||(t[o]=f.PreferredEditorTypes.FileViewer)}this.setState({preferredEditors:t})}).catch(e=>{c.Snackbar.fail(_.intl.formatMessage({id:"xfMCig",defaultMessage:"Ooops, something went wrong."}))}),this.teamSettingsGet=e=>o.__awaiter(this,void 0,void 0,(function*(){const t=this.state.supportedEditorTypes;try{const o=yield(0,p.getTeamSettings)(e);t[f.PreferredEditorTypes.GoogleDSS]=o.settings[g.CloudDocProviderIntegration.GDD_INTEGRATION][".tag"]===g.IntegrationCreateAndEdit[".tag"],this.setState({supportedEditorTypes:t})}catch(e){e.error&&"not_in_team"===e.error[".tag"]?t[f.PreferredEditorTypes.GoogleDSS]=!0:c.Snackbar.fail(_.intl.formatMessage({id:"xfMCig",defaultMessage:"Ooops, something went wrong."}))}})),this.populateSettings=()=>o.__awaiter(this,void 0,void 0,(function*(){this.state.user.is_team&&(yield this.teamSettingsGet(this.state.user.id)),yield this.preferredEditorGet(this.state.user.id),this.setState({allSettingsFetched:!0}),(0,u.mark_time_to_interactive)()})),this.preferredEditorSet=(e,t,o)=>m.preferredEditorSet(e,t,o).then(()=>{const e=this.state.preferredEditors;e[t]=o,this.setState({preferredEditors:e})}).catch(e=>{c.Snackbar.fail(_.intl.formatMessage({id:"xfMCig",defaultMessage:"Ooops, something went wrong."}))}),this.renderEditorDetail=(e,t)=>{switch(t){case"file_type":return this.renderFileType(e);case"extensions":return e.extensions;case"open_with":const t=e.file_type,o=this.state.preferredEditors[t],a=f.PreferredEditorOptionsMap[t][o],i=[],s=e=>{this.handleSelection(t,e)},n=t+"-preferred-editor";for(const e of Object.keys(this.state.supportedEditorTypes)){const o=Number(e);o==f.PreferredEditorTypes.GoogleDSS&&this.props.gddMigrationHideDefaultApps||this.state.supportedEditorTypes[o]&&o!==f.PreferredEditorTypes.Unknown&&(i[o]=f.PreferredEditorOptionsMap[t][o])}return r.default.createElement(d.Menu.Wrapper,{className:n,style:{display:"block"},onSelection:s},({getContentProps:e,getTriggerProps:t})=>r.default.createElement(r.default.Fragment,null,r.default.createElement(l.Button,Object.assign({},t(),{withDropdownIcon:!0,style:{width:"100%"},variant:"outline"}),r.default.createElement("span",{style:{flexGrow:2,textAlign:"left"}},a)),r.default.createElement(d.Menu.Content,Object.assign({},e()),r.default.createElement(d.Menu.Segment,null,this.renderMenuItems(i,o)))))}return null};const t=(0,n.mustGetActiveUser)();this.state={preferredEditors:{[f.PreferredEditorDocTypes.WORD]:f.PreferredEditorTypes.FileViewer,[f.PreferredEditorDocTypes.EXCEL]:f.PreferredEditorTypes.FileViewer,[f.PreferredEditorDocTypes.POWERPOINT]:f.PreferredEditorTypes.FileViewer},supportedEditorTypes:{[f.PreferredEditorTypes.Unknown]:!0,[f.PreferredEditorTypes.FileViewer]:!0,[f.PreferredEditorTypes.GoogleDSS]:!t.is_team,[f.PreferredEditorTypes.OfficeOnline]:!0},allSettingsFetched:!1,user:t}}componentDidMount(){this.populateSettings()}renderFileType(e){const t=r.default.createElement(i.IconPartners,{name:e.icon_name,width:"24px",height:"24px"});return r.default.createElement(E,{className:"app-name"},r.default.createElement(h,{className:"app-name__icon"},t),r.default.createElement("span",null,e.name))}renderMenuItems(e,t){const o=[];for(const a of Object.keys(e)){const i=Number(a);o.push(r.default.createElement(d.Menu.SelectItem,{key:i,value:i,selected:i===t},e[i]))}return o}handleSelection(e,t){this.state.preferredEditors[e]!==t&&this.preferredEditorSet(this.state.user.id,e,t)}getPreferredEditorInfo(){const e=[];return e.push({id:0,name:_.intl.formatMessage({id:"yY5byF",defaultMessage:"Word Document"}),icon_name:"microsoft_docx",extensions:".docx, .doc",file_type:f.PreferredEditorDocTypes.WORD,preferredEditor:this.state.preferredEditors[f.PreferredEditorDocTypes.WORD]}),e.push({id:1,name:_.intl.formatMessage({id:"0rYKaW",defaultMessage:"Excel Workbook"}),icon_name:"microsoft_xlsx",extensions:".xlsx, .xls",file_type:f.PreferredEditorDocTypes.EXCEL,preferredEditor:this.state.preferredEditors[f.PreferredEditorDocTypes.EXCEL]}),e.push({id:2,name:_.intl.formatMessage({id:"e9uLbL",defaultMessage:"PowerPoint Presentation"}),icon_name:"microsoft_pptx",extensions:".pptx, .ppt",file_type:f.PreferredEditorDocTypes.POWERPOINT,preferredEditor:this.state.preferredEditors[f.PreferredEditorDocTypes.POWERPOINT]}),e}render(){const e={keys:["file_type","extensions","open_with"],headers:{file_type:_.intl.formatMessage({id:"cHI0C1",defaultMessage:"File type"}),extensions:_.intl.formatMessage({id:"ZWvP4o",defaultMessage:"Extensions"}),open_with:_.intl.formatMessage({id:"jqiXoh",defaultMessage:"Open with"})},data:this.getPreferredEditorInfo(),renderRowDetail:this.renderEditorDetail,onClosePressed:()=>{},hideClose:()=>!0,dismissAriaLabel:()=>"",dismissHeaderAriaLabel:"",hasActionsColumn:!1},t=_.intl.formatMessage({id:"tUQkb5",defaultMessage:"Default editing apps"});return this.state.allSettingsFetched?r.default.createElement("div",{className:"account-page-block preferred-editor-settings"},r.default.createElement("h2",{className:"account-page-block__heading"},t),r.default.createElement("p",{className:"account-page-block__subtext"},_.intl.formatMessage({id:"F2cWbF",defaultMessage:"You can select how you’d like each file type to open in Dropbox."})),r.default.createElement(v,Object.assign({},e))):null}}t.PreferredEditors=M,M.displayName="PreferredEditors"})),define("metaserver/static/js/vault/components/vault_account_section_async",["require","exports","tslib","react"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncVaultAccountSection=void 0,r=o.__importDefault(r);const{lazy:a,Suspense:i}=r.default,s=a(()=>o.__awaiter(void 0,void 0,void 0,(function*(){const{StyledVaultAccountSection:t}=yield new Promise((t,o)=>{e(["metaserver/static/js/vault/components/vault_account_section"],t,o)}).then(o.__importStar);return{default:t}})));t.AsyncVaultAccountSection=e=>r.default.createElement(i,{fallback:r.default.createElement("div",null)},r.default.createElement(s,Object.assign({},e)))})),define("metaserver/static/js/cloud_docs/gdd_migration/auth",["require","exports","tslib","metaserver/static/js/api_v2/user_client","metaserver/static/js/profile_services/profile_services_link","metaserver/static/js/profile_services/profile_services_constants"],(function(e,t,o,r,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureUserHasGddMigrationCompatibleLink=t.GddMigrationCompatibleLinkStatus=void 0,i=o.__importDefault(i);const s=["documents"];var n;(function(e){e[e.HAS_COMPATIBLE_LINK=0]="HAS_COMPATIBLE_LINK",e[e.HAS_INCOMPATIBLE_LINK=1]="HAS_INCOMPATIBLE_LINK",e[e.NOT_LINKED=2]="NOT_LINKED"})(n=t.GddMigrationCompatibleLinkStatus||(t.GddMigrationCompatibleLinkStatus={})),t.ensureUserHasGddMigrationCompatibleLink=function(e){return o.__awaiter(this,void 0,void 0,(function*(){const t=e.email,l=yield(function(e,t){return o.__awaiter(this,void 0,void 0,(function*(){const o=new r.UserApiV2Client,a=yield o.ns("profile_services").rpc("list_linked_services",void 0,{subjectUserId:e.id});let i=!1;for(const e of a.linked_services){if("google"===e.service_type[".tag"]&&("is_connected"===e.connection_state[".tag"]&&s.every(t=>e.granted_permissions.some(e=>e[".tag"]===t))&&(i=!0,!t||e.display_name===t)))return n.HAS_COMPATIBLE_LINK}return i?n.HAS_INCOMPATIBLE_LINK:n.NOT_LINKED}))})(e,t);if(l===n.HAS_COMPATIBLE_LINK)return n.HAS_COMPATIBLE_LINK;if(l===n.HAS_INCOMPATIBLE_LINK)try{yield(function(e){return o.__awaiter(this,void 0,void 0,(function*(){const t=new r.UserApiV2Client;yield t.ns("profile_services").rpc("unlink",{service:{".tag":"google"}},{subjectUserId:e.id})}))})(e)}catch(e){}const d=new a.ProfileServicesLinkingHandler,c=yield d.auth_service_with_user_promise(i.default.GOOGLE,e.id,null,"link_read_files",void 0,void 0,s,void 0,t);return c.success?c.display_name===t?n.HAS_COMPATIBLE_LINK:n.HAS_INCOMPATIBLE_LINK:n.NOT_LINKED}))}})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/controllers/manual_conversion_controller",["require","exports","tslib","react","metaserver/static/js/api_v2/user_client","metaserver/static/js/cloud_docs/gdd_migration/auth","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/clean/ts_utils","metaserver/static/js/core/i18n","metaserver/static/js/api_v2/error","metaserver/static/js/filepath/filepath","metaserver/static/js/cloud_docs/gdd_migration/ui/strings","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/manual_conversion_prompt","metaserver/static/js/cloud_docs/gdd_migration/ui/utils","metaserver/static/js/components/ui/modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template"],(function(e,t,o,r,a,i,s,n,l,d,c,u,_,m,p,g){"use strict";var f;Object.defineProperty(t,"__esModule",{value:!0}),t.promptAndConvertToMsFile=t.promptAndConvertToWebShortcut=void 0,r=o.__importStar(r),(function(e){e.LINK_TO_INCOMPATIBLE_GOOGLE_ACCOUNT=l.intl.formatMessage({id:"u9TFTP",defaultMessage:"Please link to the Google account of the same email as your Dropbox account."}),e.FAIL_TO_LINK_GOOGLE_ACCOUNT=l.intl.formatMessage({id:"4L5zkJ",defaultMessage:"Failed to link Google account."}),e.pendingSaveShortcuts=function(e){return l.intl.formatMessage({id:"8NY+mp",defaultMessage:"Saving {numFiles, plural, one{shortcut} other{shortcuts}}..."},{numFiles:e})},e.pendingSaveFiles=function(e){return l.intl.formatMessage({id:"weKkwH",defaultMessage:"Saving {numFiles, plural, one{file} other{files}}..."},{numFiles:e})},e.successMessageMultipleShortcuts=function(e){return l.intl.formatMessage({id:"6LGshF",defaultMessage:"{numFiles} files saved as shortcuts."},{numFiles:e})},e.successMessageMultipleMsFiles=function(e){return l.intl.formatMessage({id:"ZXYeoK",defaultMessage:"{numFiles} files saved as Microsoft files."},{numFiles:e})},e.successMessageOneFile=function(e,t){return l.intl.formatMessage({id:"/p3tX1",defaultMessage:"{fileName} saved to <b>“{folderName}”</b> folder."},{fileName:e,folderName:t,b:e=>r.default.createElement("b",null,e)})},e.SERVER_ERROR=l.intl.formatMessage({id:"+rrsxb",defaultMessage:"Server error"}),e.srcFilesNotFound=function(e){return l.intl.formatMessage({id:"eRab3W",defaultMessage:"Source {numFiles, plural, one{file} other{files}} not found"},{numFiles:e})},e.srcFilesWrongType=function(e){return l.intl.formatMessage({id:"V0eQ4f",defaultMessage:"Source {numFiles, plural, one{file} other{files}} of the wrong type"},{numFiles:e})},e.GOOGLE_ACCOUNT_NOT_LINKED=l.intl.formatMessage({id:"Qs6YhO",defaultMessage:"Google account not linked"}),e.FOLDER_CREATION_FAILED=l.intl.formatMessage({id:"gBED0D",defaultMessage:"Folder creation failed"}),e.FIND_UNUSED_FILENAME_FAILED=l.intl.formatMessage({id:"UgrtDM",defaultMessage:"Find unused filename failed"}),e.UPLOAD_FAILED=l.intl.formatMessage({id:"MQocdR",defaultMessage:"Upload failed"}),e.GRANT_PERMISSIONS_FAILED=l.intl.formatMessage({id:"OltuRn",defaultMessage:"Grant permissions failed"}),e.GOOGLE_SERVER_ERROR=l.intl.formatMessage({id:"gTHqcG",defaultMessage:"Google server error"}),e.singleFileFailSave=function({fileName:e,rootCause:t}){return e?l.intl.formatMessage({id:"VemLR3",defaultMessage:"{fileName} couldn’t be saved ({rootCause})."},{fileName:e,rootCause:t}):l.intl.formatMessage({id:"Uni1RU",defaultMessage:"File couldn’t be saved ({rootCause})."},{rootCause:t})},e.multipleFilesPartialFailureShortcuts=function(e){return l.intl.formatMessage({id:"0u8Kpo",defaultMessage:"Some files couldn’t be saved as shortcuts ({rootCause})."},{rootCause:e})},e.multipleFilesFullFailureShortcuts=function(e){return l.intl.formatMessage({id:"UA4umv",defaultMessage:"Files couldn’t be saved as shortcuts ({rootCause})."},{rootCause:e})},e.multipleFilesFailSaveMsFile=function(e){return l.intl.formatMessage({id:"SNvXDY",defaultMessage:"Files couldn’t be saved as Microsoft files ({rootCause})."},{rootCause:e})},e.FAILED_TO_GET_GOOGLE_SHORTCUT_SETTINGS=l.intl.formatMessage({id:"AoDCl3",defaultMessage:"Failed to get Google shortcut settings. Please try again."})})(f||(f={}));const v={forceDig:!0,id:"cloud-docs-manual-conversion-snackbar",closeButtonText:u.Strings.CLOSE},E=e=>{const t=Object.assign(Object.assign({},v),{title:e,timeoutDelayMs:1e4,variant:"fail"});s.Snackbar.show(r.default.createElement(s.Snackbar,Object.assign({},t)))},h=e=>{const t=Object.assign(Object.assign({},v),{title:e,timeoutDelayMs:1e4,variant:"complete"});s.Snackbar.show(r.default.createElement(s.Snackbar,Object.assign({},t)))},M=e=>{const t=Object.assign(Object.assign({},v),{title:e,variant:"sync"});s.Snackbar.show(r.default.createElement(s.Snackbar,Object.assign({},t)))},T=e=>"ns_path"in e?(0,c.filename)(e.ns_path):void 0,S=e=>{const t=e.map(e=>T(e));return{hasGddFiles:t.some(e=>(0,m.hasGddFileExtension)(e)),hasMsFiles:t.some(e=>(0,m.hasMsFileExtension)(e))}},b=e=>{const{hasGddFiles:t}=S(e);return!t},y=e=>o.__awaiter(void 0,void 0,void 0,(function*(){try{const t=new a.UserApiV2Client;return yield t.ns("cloud_docs").rpc("google_shortcut_settings/get",void 0,{subjectUserId:e.id})}catch(e){return E(f.FAILED_TO_GET_GOOGLE_SHORTCUT_SETTINGS),null}})),O=(e,t)=>{const{hasGddFiles:o,hasMsFiles:r}=S(e);if(o&&r){if(t.copy_permissions_from_google_file[".tag"]===t.copy_permissions_from_non_google_file[".tag"])return t.copy_permissions_from_google_file}else{if(o)return t.copy_permissions_from_google_file;if(r)return t.copy_permissions_from_non_google_file}return{".tag":"ask_each_time"}},C=({files:e,user:t,dontAskMeAgain:r,copyFilePermissions:i})=>o.__awaiter(void 0,void 0,void 0,(function*(){const o=(({dontAskMeAgain:e,copyFilePermissions:t})=>e?t?{".tag":"always"}:{".tag":"never"}:{".tag":"ask_each_time"})({dontAskMeAgain:r,copyFilePermissions:i}),s={},{hasGddFiles:n,hasMsFiles:l}=S(e);n&&(s.copy_permissions_from_google_file=o),l&&(s.copy_permissions_from_non_google_file=o);const d=new a.UserApiV2Client;try{yield d.ns("cloud_docs").rpc("google_shortcut_settings/set",s,{subjectUserId:t.id})}catch(e){}})),w=({showOriginalFileDeleteWarning:e,numFiles:t,onUpdateCopyPermissionsSetting:o,onSubmit:a})=>{const[i,s]=(0,r.useState)(!1),n=(0,r.useMemo)(()=>(0,_.ManualConversionPromptModal)({showOriginalFileDeleteWarning:e,numFiles:t,dontAskMeAgain:i,onSetDontAskMeAgain:e=>s(e),onConvertAndCopy:()=>{p.Modal.close(),o({dontAskMeAgain:i,copyFilePermissions:!0}),a({copyFilePermissions:!0})},onConvertButDontCopy:()=>{p.Modal.close(),o({dontAskMeAgain:i,copyFilePermissions:!1}),a({copyFilePermissions:!1})}}),[e,t,o,a,i,s]);return r.default.createElement(g.ModalTemplate,Object.assign({open:!0},n,{onRequestClose:p.Modal.close}))};w.displayName="ManualConversionComponent";const I=({showOriginalFileDeleteWarning:e,numFiles:t,copyPermissionsSetting:o,onUpdateCopyPermissionsSetting:a,onSubmit:i})=>{switch(o[".tag"]){case"always":return void i({copyFilePermissions:!0});case"never":return void i({copyFilePermissions:!1});case"ask_each_time":case"other":break;default:(0,n.enforceExhaustive)(o)}p.Modal.showInstance(r.default.createElement(w,{showOriginalFileDeleteWarning:e,numFiles:t,onUpdateCopyPermissionsSetting:a,onSubmit:i}))};t.promptAndConvertToWebShortcut=(e,t)=>o.__awaiter(void 0,void 0,void 0,(function*(){const o=yield y(t);o&&I({showOriginalFileDeleteWarning:!b(e),numFiles:e.length,copyPermissionsSetting:O(e,o),onUpdateCopyPermissionsSetting:({dontAskMeAgain:o,copyFilePermissions:r})=>{C({files:e,user:t,dontAskMeAgain:o,copyFilePermissions:r})},onSubmit:({copyFilePermissions:o})=>{A({files:e,user:t,copyFilePermissions:o})}})}));const A=({files:e,user:t,copyFilePermissions:r})=>o.__awaiter(void 0,void 0,void 0,(function*(){const o=yield(0,i.ensureUserHasGddMigrationCompatibleLink)(t);switch(o){case i.GddMigrationCompatibleLinkStatus.HAS_COMPATIBLE_LINK:break;case i.GddMigrationCompatibleLinkStatus.HAS_INCOMPATIBLE_LINK:return void E(f.LINK_TO_INCOMPATIBLE_GOOGLE_ACCOUNT);case i.GddMigrationCompatibleLinkStatus.NOT_LINKED:return void E(f.FAIL_TO_LINK_GOOGLE_ACCOUNT);default:E(f.FAIL_TO_LINK_GOOGLE_ACCOUNT),(0,n.enforceExhaustive)(o)}M(f.pendingSaveShortcuts(e.length));const s={dest_service:{".tag":"gdrive"},src_files:e.map(e=>e.file_id),keep_original_file:b(e),preserve_existing_shortcut:!0,copy_permissions:r};try{const o=new a.UserApiV2Client,r=yield o.ns("cloud_docs").rpc("convert_to_web_shortcut",s,{subjectUserId:t.id});((e,t)=>{e.length>1?h(f.successMessageMultipleShortcuts(e.length)):h(f.successMessageOneFile((0,c.filename)(t),(0,c.parent_dir)(t)))})(e,r.shortcuts[0].file_path)}catch(t){((e,t)=>{let o=!1,r=f.SERVER_ERROR;if(t instanceof d.AppError){const a=t.error;switch(a[".tag"]){case"src_file_not_found":r=f.srcFilesNotFound(e.length);break;case"src_file_wrong_type":r=f.srcFilesWrongType(e.length);break;case"missing_linked_service":r=f.GOOGLE_ACCOUNT_NOT_LINKED;break;case"external_api_error":switch(o=a.is_partial_failure,a.error_sub_type[".tag"]){case"create_folder":r=f.FOLDER_CREATION_FAILED;break;case"find_unused_filename":r=f.FIND_UNUSED_FILENAME_FAILED;break;case"upload":r=f.UPLOAD_FAILED;break;case"grant_role":r=f.GRANT_PERMISSIONS_FAILED;break;case"other":r=f.GOOGLE_SERVER_ERROR;break;default:(0,n.enforceExhaustive)(a.error_sub_type)}break;case"other":break;default:(0,n.enforceExhaustive)(a)}}if(1===e.length){const t=T(e[0]);E(f.singleFileFailSave({fileName:t,rootCause:r}))}else E(o?f.multipleFilesPartialFailureShortcuts(r):f.multipleFilesFullFailureShortcuts(r))})(e,t)}}));t.promptAndConvertToMsFile=(e,t)=>o.__awaiter(void 0,void 0,void 0,(function*(){const o=yield y(t);o&&I({showOriginalFileDeleteWarning:!0,numFiles:e.length,copyPermissionsSetting:o.copy_permissions_from_google_file,onUpdateCopyPermissionsSetting:({dontAskMeAgain:o,copyFilePermissions:r})=>{C({files:e,user:t,dontAskMeAgain:o,copyFilePermissions:r})},onSubmit:({copyFilePermissions:o})=>{F({files:e,user:t,copyFilePermissions:o})}})}));const F=({files:e,user:t,copyFilePermissions:r})=>o.__awaiter(void 0,void 0,void 0,(function*(){const o={src_files:e.map(e=>e.file_id),keep_original_file:!1,preserve_existing_ms_file:!0,copy_permissions:r};M(f.pendingSaveFiles(e.length));const i=new a.UserApiV2Client;try{const r=yield i.ns("cloud_docs").rpc("convert_gdd_to_ms_office_file",o,{subjectUserId:t.id});((e,t)=>{e.length>1?h(f.successMessageMultipleMsFiles(e.length)):h(f.successMessageOneFile((0,c.filename)(t),(0,c.parent_dir)(t)))})(e,r.converted_files[0].dest_file_path)}catch(t){((e,t)=>{let o=f.SERVER_ERROR;if(t instanceof d.AppError){const r=t.error;switch(r[".tag"]){case"src_file_not_found":o=f.srcFilesNotFound(e.length);break;case"src_file_wrong_type":o=f.srcFilesWrongType(e.length);break;case"other":break;default:(0,n.enforceExhaustive)(r)}}if(1===e.length){const t=T(e[0]);E(f.singleFileFailSave({fileName:t,rootCause:o}))}else E(f.multipleFilesFailSaveMsFile(o))})(e,t)}}))})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/controllers/modal_controller",["require","exports","tslib","react","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/intro_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/whats_happening_to_google_files_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/what_do_you_want_to_do_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/link_google_account_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/could_not_connect_to_google_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/recommend_move_to_google_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/confirm_convert_to_ms_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template","metaserver/static/js/clean/active_user","metaserver/static/js/cloud_docs/gdd_migration/auth","metaserver/static/js/api_v2/user_client","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/utils"],(function(e,t,o,r,a,i,s,n,l,d,c,u,_,m,p,g,f){"use strict";var v,E;Object.defineProperty(t,"__esModule",{value:!0}),t.ModalController=t.MigrationStep=t.MigrationType=void 0,r=o.__importStar(r),(function(e){e.MIGRATE_TO_GOOGLE="MIGRATE_TO_GOOGLE",e.CONVERT_TO_MS="CONVERT_TO_MS"})(v=t.MigrationType||(t.MigrationType={})),(function(e){e.INTRO="INTRO",e.WHATS_HAPPENING="WHATS_HAPPENING",e.MIGRATE_NOT_NOW="MIGRATE_NOT_NOW",e.WHAT_TO_DO="WHAT_TO_DO",e.LINK_GOOGLE="LINK_GOOGLE",e.CONVERT_TO_MS="CONVERT_TO_MS",e.COULD_NOT_CONNECT="COULD_NOT_CONNECT"})(E=t.MigrationStep||(t.MigrationStep={}));const h=(e,t)=>o.__awaiter(void 0,void 0,void 0,(function*(){const o=new p.UserApiV2Client;try{return yield o.ns("cloud_docs").rpc("set_gdd_migration_settings",{settings:{effective_migration_mode:{".tag":t==v.CONVERT_TO_MS?"ms_office_file":"shortcut_to_gdrive"}}},{subjectUserId:e.id}),!0}catch(e){(0,f.showErrorSnackbar)(g.intl.formatMessage({id:"hDQvVQ",defaultMessage:"Could not save migration settings"}))}return!1}));t.ModalController=({open:e,onRequestClose:t})=>{const[M,T]=(0,r.useState)(E.INTRO),[S,b]=(0,r.useState)(),y=(0,_.mustGetActiveUser)();(0,r.useEffect)(()=>{(function(e){return o.__awaiter(this,void 0,void 0,(function*(){const t=new p.UserApiV2Client;try{const{settings:o}=yield t.ns("cloud_docs").rpc("get_gdd_migration_settings",void 0,{subjectUserId:e.id});if(!o||!o.effective_migration_mode)return;if("ms_office_file"==o.effective_migration_mode[".tag"])return v.CONVERT_TO_MS;if("shortcut_to_gdrive"==o.effective_migration_mode[".tag"])return v.MIGRATE_TO_GOOGLE}catch(e){(0,f.showErrorSnackbar)(g.intl.formatMessage({id:"C40Kmf",defaultMessage:"Could not fetch migration settings"}))}}))})(y).then(b)},[]);const O=(0,r.useMemo)(()=>{switch(M){case E.INTRO:return(0,a.IntroModal)({onNext:()=>T(E.WHATS_HAPPENING),onNotNow:()=>T(E.MIGRATE_NOT_NOW)});case E.WHATS_HAPPENING:return(0,i.WhatsHappeningToGoogleFilesModal)({onNext:()=>T(E.WHAT_TO_DO),onBack:()=>T(E.INTRO),timeframeFromCohort:"January 1 2023"});case E.WHAT_TO_DO:return(0,s.WhatDoYouWantToDoModal)({disabled:void 0===S,isConvertToMS:S==v.CONVERT_TO_MS,isMigrateToGoogle:S==v.MIGRATE_TO_GOOGLE,onNext:()=>o.__awaiter(void 0,void 0,void 0,(function*(){if(S==v.MIGRATE_TO_GOOGLE)return T(E.LINK_GOOGLE);if(S==v.CONVERT_TO_MS){if(yield h(y,S))return T(E.CONVERT_TO_MS)}else(0,f.showWarningSnackbar)(g.intl.formatMessage({id:"Q9RiB1",defaultMessage:"Please choose a migration type"}))})),onBack:()=>T(E.WHATS_HAPPENING),onCheckMigrateToGoogle:()=>b(v.MIGRATE_TO_GOOGLE),onCheckConvertToMS:()=>b(v.CONVERT_TO_MS)});case E.LINK_GOOGLE:return(0,n.LinkGoogleAccountModal)({onLinkAccount:()=>o.__awaiter(void 0,void 0,void 0,(function*(){if(!(yield(e=>o.__awaiter(void 0,void 0,void 0,(function*(){try{return(yield(0,m.ensureUserHasGddMigrationCompatibleLink)(e))==m.GddMigrationCompatibleLinkStatus.HAS_COMPATIBLE_LINK}catch(e){}return!1})))(y)))return T(E.COULD_NOT_CONNECT);(yield h(y,null!=S?S:v.MIGRATE_TO_GOOGLE))&&t()})),onBack:()=>T(E.WHAT_TO_DO)});case E.COULD_NOT_CONNECT:return(0,l.CouldNotConnectToGoogleModal)({onTryAgain:()=>T(E.LINK_GOOGLE)});case E.MIGRATE_NOT_NOW:return(0,d.RecommendMoveToGoogleModal)({onMoveFiles:()=>T(E.INTRO),onRemindMeLater:t,moveByDate:"January 1 2023",numFiles:32});case E.CONVERT_TO_MS:return(0,c.ConfirmConvertToMSModal)({onBack:()=>T(E.WHAT_TO_DO),onFinish:t})}},[M,T,S,b,t]);return r.default.createElement(u.ModalTemplate,Object.assign({open:e},O,{onRequestClose:t}))},t.ModalController.displayName="ModalController"})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/confirm_convert_to_ms_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings"],(function(e,t,o,r,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmConvertToMSModal=void 0,r=o.__importDefault(r);t.ConfirmConvertToMSModal=({onFinish:e,onBack:t})=>({title:i.intl.formatMessage({id:"6TTebl",defaultMessage:"Convert Google files to Microsoft Office files"}),infoTextAboveModalTitle:i.intl.formatMessage({id:"lBpsJD",defaultMessage:"4 of 4"}),bodyText:r.default.createElement(r.default.Fragment,null,r.default.createElement("p",null,i.intl.formatMessage({id:"o4sdZa",defaultMessage:"You’re all set."})),r.default.createElement("p",null,i.intl.formatMessage({id:"cjp04s",defaultMessage:"You’ll get an email when migration starts and when it’s finished."}))),tertiaryActions:r.default.createElement(r.default.Fragment,null,r.default.createElement(a.Button,{variant:"opacity",onClick:t},s.Strings.BACK),r.default.createElement(a.Button,{variant:"primary",onClick:e},s.Strings.FINISH)),width:"standard"})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/could_not_connect_to_google_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings"],(function(e,t,o,r,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CouldNotConnectToGoogleModal=void 0,r=o.__importDefault(r);t.CouldNotConnectToGoogleModal=({onTryAgain:e})=>({title:i.intl.formatMessage({id:"mhpv2Q",defaultMessage:"Couldn’t connect to your Google account"}),bodyText:r.default.createElement(r.default.Fragment,null,i.intl.formatMessage({id:"IChG+T",defaultMessage:"You can try again, or go to “Learn more” to manually move your Google files to Google Drive and create shortcuts in Dropbox."})),tertiaryActions:r.default.createElement(r.default.Fragment,null,r.default.createElement(a.Button,{variant:"opacity"},s.Strings.LEARN_MORE),r.default.createElement(a.Button,{variant:"primary",onClick:e},i.intl.formatMessage({id:"WteAJ2",defaultMessage:"Try again"}))),width:"standard",withCloseButton:s.Strings.CLOSE})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/intro_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings","metaserver/static/js/clean/static_urls"],(function(e,t,o,r,a,i,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IntroModal=void 0,r=o.__importDefault(r);t.IntroModal=({onNext:e,onNotNow:t})=>({title:i.intl.formatMessage({id:"8xf9hC",defaultMessage:"Google Files are moving to Google Drive"}),infoTextAboveModalTitle:i.intl.formatMessage({id:"MfPZDB",defaultMessage:"1 of 4"}),bodyText:r.default.createElement(r.default.Fragment,null,r.default.createElement("p",null,i.intl.formatMessage({id:"wtjl7Q",defaultMessage:"To improve performance and access to Google file features, your Google files will be moved from Dropbox to Google Drive."})),r.default.createElement("p",null,i.intl.formatMessage({id:"QjccmA",defaultMessage:"Shortcuts to all your files will be created in Dropbox. Once the files are moved, you can open any Google file from Dropbox by clicking on its shortcut."}))),actions:r.default.createElement(r.default.Fragment,null,r.default.createElement(a.Button,{variant:"opacity",onClick:t},i.intl.formatMessage({id:"0TwJOv",defaultMessage:"Not now"})),r.default.createElement(a.Button,{variant:"primary",onClick:e},s.Strings.NEXT)),tertiaryActions:r.default.createElement(a.Button,{variant:"transparent"},s.Strings.LEARN_MORE),rightFrameImageSrc:(0,n.static_url)("/static/metaserver/static/images/cloud_docs/gdd_migration/migration_modal_intro-vflH_hlVK.png"),width:749})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/link_google_account_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings"],(function(e,t,o,r,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkGoogleAccountModal=void 0,r=o.__importDefault(r);t.LinkGoogleAccountModal=({onLinkAccount:e,onBack:t})=>({title:i.intl.formatMessage({id:"2PB7hS",defaultMessage:"Link Google account"}),infoTextAboveModalTitle:i.intl.formatMessage({id:"lBpsJD",defaultMessage:"4 of 4"}),bodyText:r.default.createElement(r.default.Fragment,null,r.default.createElement("p",null,i.intl.formatMessage({id:"/WNsVV",defaultMessage:"You’ll be asked to sign in and link your Google account to this Dropbox account. Select the Google profile for this Dropbox account, and we’ll take care of the rest."})),r.default.createElement("p",null,i.intl.formatMessage({id:"pYT44N",defaultMessage:"You’ll be notified when the Google file migration is complete."}))),tertiaryActions:r.default.createElement(r.default.Fragment,null,r.default.createElement(a.Button,{variant:"opacity",onClick:t},s.Strings.BACK),r.default.createElement(a.Button,{variant:"primary",onClick:e},i.intl.formatMessage({id:"JhmneM",defaultMessage:"Link account"}))),width:"standard"})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/manual_conversion_prompt",["require","exports","tslib","react","dig-components/banner","dig-components/buttons","dig-components/controls","dig-components/typography","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings"],(function(e,t,o,r,a,i,s,n,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManualConversionPromptModal=void 0,r=o.__importDefault(r);t.ManualConversionPromptModal=({showOriginalFileDeleteWarning:e,numFiles:t,dontAskMeAgain:o,onSetDontAskMeAgain:c,onConvertAndCopy:u,onConvertButDontCopy:_})=>({title:l.intl.formatMessage({id:"PQGSwm",defaultMessage:"Copy file permissions?"}),bodyText:r.default.createElement(r.default.Fragment,null,e&&r.default.createElement("p",null,r.default.createElement(a.Banner,{type:"warning"},r.default.createElement(a.Banner.Message,null,l.intl.formatMessage({id:"l7mfQx",defaultMessage:"The original {numFiles, plural, one{file} other{files}} will be deleted upon conversion."},{numFiles:t})))),r.default.createElement("p",null,l.intl.formatMessage({id:"fJOIy0",defaultMessage:"Do you want to copy the same permission settings for the original {numFiles, plural, one{file over to the new shortcut} other{files over to the new shortcuts}} in Google Drive?"},{numFiles:t})),r.default.createElement("p",null,l.intl.formatMessage({id:"JSg+cB",defaultMessage:"This setting can be modified under <b>Settings > General > Google shortcut settings</b>."},{b:e=>r.default.createElement("strong",null,e)}))),actions:r.default.createElement(r.default.Fragment,null,r.default.createElement(s.Checkbox,{id:"toggleDontAskMeAgain",checked:o,onChange:e=>c(e.currentTarget.checked),"aria-label":l.intl.formatMessage({id:"PJIYJF",defaultMessage:"Toggle don’t ask me again"})}),r.default.createElement(n.Label,{htmlFor:"toggleDontAskMeAgain"},r.default.createElement(n.Text,null,l.intl.formatMessage({id:"rI2pNz",defaultMessage:"Don’t ask me again"})))),tertiaryActions:r.default.createElement(r.default.Fragment,null,r.default.createElement(i.Button,{variant:"opacity",onClick:_},l.intl.formatMessage({id:"/xSS6W",defaultMessage:"Convert but don’t copy"})),r.default.createElement(i.Button,{variant:"primary",onClick:u},l.intl.formatMessage({id:"XTPerx",defaultMessage:"Convert and copy"}))),width:"standard",withCloseButton:d.Strings.CLOSE})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template",["require","exports","tslib","react","dig-components/modal","dig-components/typography","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template.module.css"],(function(e,t,o,r,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModalTemplate=void 0,r=o.__importDefault(r),s=o.__importDefault(s);t.ModalTemplate=({actions:e,ariaLabel:t,bodyText:o,infoTextAboveModalTitle:n,tertiaryActions:l,title:d,rightFrameImageSrc:c,onRequestClose:u,open:_,width:m,withCloseButton:p})=>r.default.createElement(a.Modal,{onRequestClose:u,open:null==_||_,width:m,isCentered:!0,shouldCloseOnOverlayClick:!1,withCloseButton:p,"aria-labelledby":t},r.default.createElement("div",{className:s.default.modalTemplateWrapper},r.default.createElement("div",{className:s.default.modalTemplateContainer},n&&r.default.createElement("div",{className:s.default.modalTemplatePaper},r.default.createElement(i.Text,{size:"small",color:"faint"},n)),r.default.createElement("div",{className:s.default.modalTemplateContent},r.default.createElement("div",{className:s.default.modalTemplateHeading},r.default.createElement(i.Title,null,d)),r.default.createElement("div",{className:s.default.modalTemplateText},o)),r.default.createElement("div",{className:s.default.modalTemplateActions},e&&r.default.createElement("div",{className:s.default.modalTemplateButtonGroup},e),l&&r.default.createElement("div",{className:s.default.modalTemplateTertiaryActionContainer},l))),c&&r.default.createElement("div",{className:s.default.modalTemplateImageFrame},r.default.createElement("img",{src:c})))),t.ModalTemplate.displayName="ModalTemplate"})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template.module.css",["require","exports","css!metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.modalTemplateImageFrame=t.modalTemplateTertiaryActionContainer=t.modalTemplateButtonGroup=t.modalTemplateActions=t.modalTemplateText=t.modalTemplateHeading=t.modalTemplateContent=t.modalTemplatePaper=t.modalTemplateContainer=t.modalTemplateWrapper=void 0,t.modalTemplateWrapper="_modalTemplateWrapper_1abca_1",t.modalTemplateContainer="_modalTemplateContainer_1abca_6",t.modalTemplatePaper="_modalTemplatePaper_1abca_15",t.modalTemplateContent="_modalTemplateContent_1abca_24",t.modalTemplateHeading="_modalTemplateHeading_1abca_34",t.modalTemplateText="_modalTemplateText_1abca_42",t.modalTemplateActions="_modalTemplateActions_1abca_46",t.modalTemplateButtonGroup="_modalTemplateButtonGroup_1abca_56",t.modalTemplateTertiaryActionContainer="_modalTemplateTertiaryActionContainer_1abca_65",t.modalTemplateImageFrame="_modalTemplateImageFrame_1abca_76";t.default={modalTemplateWrapper:"_modalTemplateWrapper_1abca_1",modalTemplateContainer:"_modalTemplateContainer_1abca_6",modalTemplatePaper:"_modalTemplatePaper_1abca_15",modalTemplateContent:"_modalTemplateContent_1abca_24",modalTemplateHeading:"_modalTemplateHeading_1abca_34",modalTemplateText:"_modalTemplateText_1abca_42",modalTemplateActions:"_modalTemplateActions_1abca_46",modalTemplateButtonGroup:"_modalTemplateButtonGroup_1abca_56",modalTemplateTertiaryActionContainer:"_modalTemplateTertiaryActionContainer_1abca_65",modalTemplateImageFrame:"_modalTemplateImageFrame_1abca_76"}})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/recommend_move_to_google_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings"],(function(e,t,o,r,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendMoveToGoogleModal=void 0,r=o.__importDefault(r);t.RecommendMoveToGoogleModal=({onRemindMeLater:e,onMoveFiles:t,moveByDate:o,numFiles:n})=>({title:i.intl.formatMessage({id:"X3l0jP",defaultMessage:"Google files moving to Google Drive"}),bodyText:r.default.createElement(r.default.Fragment,null,r.default.createElement("p",null,r.default.createElement("strong",null,i.intl.formatMessage({id:"VPIeVQ",defaultMessage:"We recommend moving all {numFiles} of your Google files to Google Drive. Shortcuts to the files will be added to Dropbox so you can open them at any time."},{numFiles:n}))),r.default.createElement("p",null,i.intl.formatMessage({id:"dbGYQX",defaultMessage:"Google files that haven’t been moved by {moveByDate} will be converted to Microsoft Office files and stored in Dropbox."},{moveByDate:o}))),tertiaryActions:r.default.createElement(r.default.Fragment,null,r.default.createElement(a.Button,{variant:"opacity",onClick:e},s.Strings.REMIND_ME_LATER),r.default.createElement(a.Button,{variant:"primary",onClick:t},s.Strings.MOVE_FILES)),withCloseButton:s.Strings.CLOSE,width:"standard"})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/what_do_you_want_to_do_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/radio_button_group","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings","metaserver/static/js/clean/static_urls"],(function(e,t,o,r,a,i,s,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WhatDoYouWantToDoModal=void 0,r=o.__importDefault(r);t.WhatDoYouWantToDoModal=({disabled:e,isConvertToMS:t,isMigrateToGoogle:o,onNext:d,onBack:c,onCheckMigrateToGoogle:u,onCheckConvertToMS:_})=>({title:s.intl.formatMessage({id:"hiZ+Ev",defaultMessage:"What do you want to do?"}),infoTextAboveModalTitle:s.intl.formatMessage({id:"7IR9Ol",defaultMessage:"3 of 4"}),bodyText:r.default.createElement("div",{role:"group"},r.default.createElement(i.RadioButtonGroup,{checked:o,disabled:e,id:"continue-google",labelText:s.intl.formatMessage({id:"/ww9z/",defaultMessage:"Continue working in Google Workspace"}),onChange:u,helperText:s.intl.formatMessage({id:"0DqRnx",defaultMessage:"Sign in to your Google account so we can move files to Google Drive."})}),r.default.createElement(i.RadioButtonGroup,{checked:t,disabled:e,id:"continue-microsoft",labelText:s.intl.formatMessage({id:"iGoIY+",defaultMessage:"Convert Google files to Microsoft Office files"}),onChange:_,helperText:s.intl.formatMessage({id:"NAzO7r",defaultMessage:"No action is needed from you. We’ll take care of it."})})),actions:r.default.createElement(r.default.Fragment,null,r.default.createElement(a.Button,{variant:"opacity",onClick:c},n.Strings.BACK),r.default.createElement(a.Button,{variant:"primary",onClick:d},n.Strings.NEXT)),tertiaryActions:r.default.createElement(a.Button,{variant:"transparent"},n.Strings.LEARN_MORE),rightFrameImageSrc:(0,l.static_url)("/static/images/cloud_docs/gdd_migration/migration_modal_what_to_do.png"),width:749}),n.Strings})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/whats_happening_to_google_files_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings","metaserver/static/js/clean/static_urls"],(function(e,t,o,r,a,i,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WhatsHappeningToGoogleFilesModal=void 0,r=o.__importDefault(r);t.WhatsHappeningToGoogleFilesModal=({onNext:e,onBack:t,timeframeFromCohort:o})=>({title:i.intl.formatMessage({id:"U5mUXh",defaultMessage:"What’s happening to Google files"}),infoTextAboveModalTitle:i.intl.formatMessage({id:"MTMS+F",defaultMessage:"2 of 4"}),bodyText:r.default.createElement(r.default.Fragment,null,r.default.createElement("p",null,i.intl.formatMessage({id:"txmtB/",defaultMessage:"Starting {timeframeFromCohort}, all your Google Docs, Sheets, and Slides will open in Google Workspace, instead of Dropbox."},{timeframeFromCohort:o})),r.default.createElement("p",null,i.intl.formatMessage({id:"aWFn9/",defaultMessage:"To keep working in Google Workspace, link your Google account to Dropbox."})),r.default.createElement("p",null,i.intl.formatMessage({id:"ytBG63",defaultMessage:"After {timeframeFromCohort}, if your Dropbox account isn’t linked to your Google account your Google files will be converted to Microsoft Office files."},{timeframeFromCohort:o}))),actions:r.default.createElement(r.default.Fragment,null,r.default.createElement(a.Button,{variant:"opacity",onClick:t},s.Strings.BACK),r.default.createElement(a.Button,{variant:"primary",onClick:e},s.Strings.NEXT)),tertiaryActions:r.default.createElement(a.Button,{variant:"transparent"},s.Strings.LEARN_MORE),rightFrameImageSrc:(0,n.static_url)("/static/metaserver/static/images/cloud_docs/gdd_migration/migration_modal_whats_happening-vflErcmxI.png"),width:749})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/radio_button_group",["require","exports","tslib","react","dig-components/controls","dig-components/typography","metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/radio_button_group.module.css"],(function(e,t,o,r,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RadioButtonGroup=void 0,r=o.__importDefault(r),s=o.__importDefault(s);t.RadioButtonGroup=({checked:e,disabled:t,id:o,labelText:n,helperText:l,onChange:d})=>r.default.createElement("span",{className:s.default.radioButtonGroupRow},r.default.createElement(a.RadioButton,{id:o,checked:e,onChange:d,disabled:t}),r.default.createElement("span",{className:s.default.rowLabelContainer},r.default.createElement(i.Text,{tagName:"label",htmlFor:o},n),l&&r.default.createElement(i.Text,{color:"faint"},l))),t.RadioButtonGroup.displayName="RadioButtonGroup"})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/radio_button_group.module.css",["require","exports","css!metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/radio_button_group.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rowLabelContainer=t.radioButtonGroupRow=void 0,t.radioButtonGroupRow="_radioButtonGroupRow_1qd9u_1",t.rowLabelContainer="_rowLabelContainer_1qd9u_11";t.default={radioButtonGroupRow:"_radioButtonGroupRow_1qd9u_1",rowLabelContainer:"_rowLabelContainer_1qd9u_11"}})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/strings",["require","exports","metaserver/static/js/core/i18n"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Strings=void 0,(function(e){e.NEXT=o.intl.formatMessage({id:"yah+je",defaultMessage:"Next"}),e.BACK=o.intl.formatMessage({id:"k9vJ0G",defaultMessage:"Back"}),e.CANCEL=o.intl.formatMessage({id:"S53N5s",defaultMessage:"Cancel"}),e.CREATE=o.intl.formatMessage({id:"cVVoCl",defaultMessage:"Create"}),e.LEARN_MORE=o.intl.formatMessage({id:"sUsXMb",defaultMessage:"Learn more"}),e.REMIND_ME_LATER=o.intl.formatMessage({id:"zQjTBz",defaultMessage:"Remind me later"}),e.MOVE_FILES=o.intl.formatMessage({id:"qbOcoV",defaultMessage:"Move files"}),e.FINISH=o.intl.formatMessage({id:"n4dBJ7",defaultMessage:"Finish"}),e.CLOSE=o.intl.formatMessage({id:"/nCb7L",defaultMessage:"Close"}),e.DISMISS=o.intl.formatMessage({id:"h4rpeQ",defaultMessage:"Dismiss"}),e.SHOW_IN_GOOGLE_DRIVE=o.intl.formatMessage({id:"S0LHV5",defaultMessage:"Show in Google Drive"}),e.LINK_ACCOUNT=o.intl.formatMessage({id:"JhmneM",defaultMessage:"Link account"}),e.GET_MIGRATION_SETTINGS_ERROR=o.intl.formatMessage({id:"C40Kmf",defaultMessage:"Could not fetch migration settings"}),e.SET_MIGRATION_SETTINGS_ERROR=o.intl.formatMessage({id:"omeHSB",defaultMessage:"Could not update migration settings"}),e.EDIT_APP_PERMISSIONS=o.intl.formatMessage({id:"GYeDWi",defaultMessage:"Edit app permissions"}),e.MIGRATION_FOLDER="Dropbox"})(t.Strings||(t.Strings={}))})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/utils",["require","exports","tslib","react","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/api_v2/user_client","metaserver/static/js/cloud_docs/gdd_migration/ui/strings"],(function(e,t,o,r,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasMsFileExtension=t.hasGddFileExtension=t.getMigrationDetails=t.setMigrationSettings=t.getMigrationSettings=t.showWarningSnackbar=t.showErrorSnackbar=void 0,r=o.__importDefault(r);t.showErrorSnackbar=e=>{a.Snackbar.show(r.default.createElement(a.Snackbar,{forceDig:!0,title:e,closeButtonText:s.Strings.CLOSE,variant:"fail"}))};t.showWarningSnackbar=e=>{a.Snackbar.show(r.default.createElement(a.Snackbar,{forceDig:!0,title:e,closeButtonText:s.Strings.CLOSE,variant:"warn"}))};t.getMigrationSettings=e=>o.__awaiter(void 0,void 0,void 0,(function*(){const t=new i.UserApiV2Client,{settings:o}=yield t.ns("cloud_docs").rpc("get_gdd_migration_settings",void 0,{subjectUserId:e.id});return o}));t.setMigrationSettings=(e,t)=>o.__awaiter(void 0,void 0,void 0,(function*(){const o=new i.UserApiV2Client,{settings:r}=yield o.ns("cloud_docs").rpc("set_gdd_migration_settings",{settings:t},{subjectUserId:e.id});return r}));t.getMigrationDetails=e=>o.__awaiter(void 0,void 0,void 0,(function*(){const t=new i.UserApiV2Client;return yield t.ns("cloud_docs").rpc("get_gdd_migration_details",void 0,{subjectUserId:e.id})}));t.hasGddFileExtension=e=>{if(!e)return!1;const t=e.toLowerCase();return t.endsWith(".gdoc")||t.endsWith(".gsheet")||t.endsWith(".gslides")};t.hasMsFileExtension=e=>{if(!e)return!1;const t=e.toLowerCase();return t.endsWith(".docx")||t.endsWith(".xlsx")||t.endsWith(".pptx")}})),define("metaserver/static/js/cloud_docs/create_google_shortcut_modal",["require","exports","tslib","react","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/new_gdss_web_file/create_gdss_shortcut_modal","metaserver/static/js/components/ui/modal","metaserver/static/js/core/i18n"],(function(e,t,o,r,a,i,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateGoogleShortcutModal=void 0,r=o.__importStar(r);const l=n.intl.formatMessage({id:"o9Zw70",defaultMessage:"Untitled"});t.CreateGoogleShortcutModal=({fileType:e,onCreate:t})=>{const[o,n]=(0,r.useState)("");return r.default.createElement(a.ModalTemplate,Object.assign({open:!0},(0,i.CreateGdssShortcutModal)({fileType:e,shortcutName:o,onChangeShortcutName:n,onCancel:s.Modal.close,onCreate:()=>t(o.length?o:l)}),{onRequestClose:s.Modal.close}))},t.CreateGoogleShortcutModal.displayName="CreateGoogleShortcutModal"})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/new_gdss_web_file/create_gdss_shortcut_modal",["require","exports","tslib","react","dig-components/buttons","dig-components/icons","dig-components/icons/src","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings","metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/text_input_group","metaserver/static/js/cloud_docs/constants"],(function(e,t,o,r,a,i,s,n,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateGdssShortcutModal=t.GoogleFileLabels=void 0,r=o.__importDefault(r),t.GoogleFileLabels={[c.GoogleFileTypes.GOOGLE_DSS_DOC]:n.intl.formatMessage({id:"mh13Sm",defaultMessage:"Google Doc"}),[c.GoogleFileTypes.GOOGLE_DSS_SHEET]:n.intl.formatMessage({id:"EA8pnR",defaultMessage:"Google Sheet"}),[c.GoogleFileTypes.GOOGLE_DSS_SLIDES]:n.intl.formatMessage({id:"gYrVaF",defaultMessage:"Google Slides"})};t.CreateGdssShortcutModal=({fileType:e,shortcutName:o,onChangeShortcutName:c,onCreate:u,onCancel:_})=>({title:n.intl.formatMessage({id:"JSsQfA",defaultMessage:"Create {fileType} shortcut"},{fileType:t.GoogleFileLabels[e]}),bodyText:r.default.createElement(r.default.Fragment,null,r.default.createElement("p",null,r.default.createElement(d.TextInputGroup,{ariaLabel:n.intl.formatMessage({id:"thfeo6",defaultMessage:"{fileType} shortcut name text input"},{fileType:t.GoogleFileLabels[e]}),id:"shortcut-name",isLabelBold:!0,labelSize:"large",label:n.intl.formatMessage({id:"+0ZE67",defaultMessage:"Shortcut name"}),placeholder:n.intl.formatMessage({id:"UfXcek",defaultMessage:"Add shortcut name"}),value:o,onChange:e=>c(e.currentTarget.value)})),r.default.createElement("p",null,n.intl.formatMessage({id:"4fKDuU",defaultMessage:"Will be saved in the folder <button>Dropbox files</button> in Google Drive."},{button:e=>r.default.createElement(a.Button,{variant:"transparent",withIconLeft:r.default.createElement(i.UIIcon,{src:s.FolderLine,role:"presentation"})},e)}))),tertiaryActions:r.default.createElement(r.default.Fragment,null,r.default.createElement(a.Button,{variant:"opacity",onClick:_},l.Strings.CANCEL),r.default.createElement(a.Button,{variant:"primary",onClick:u},l.Strings.CREATE)),width:"small",withCloseButton:l.Strings.CLOSE})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/text_input_group",["require","exports","tslib","react","dig-components/text_fields","dig-components/typography","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/text_input_group.module.css"],(function(e,t,o,r,a,i,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextInputGroup=void 0,r=o.__importDefault(r),n=o.__importDefault(n);t.TextInputGroup=({ariaLabel:e,id:t,isLabelBold:o,label:l,placeholder:d,labelSize:c,value:u,onChange:_})=>r.default.createElement("div",{className:n.default.textInputGroup},l&&r.default.createElement(i.Text,{size:c,tagName:"label",htmlFor:t,isBold:o},l),r.default.createElement("div",null,r.default.createElement(a.TextInput,{id:t,onChange:_,placeholder:d,"aria-label":null!=e?e:s.intl.formatMessage({id:"Z/QhF6",defaultMessage:"Text input"}),value:u}))),t.TextInputGroup.displayName="TextInputGroup"})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/text_input_group.module.css",["require","exports","css!metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/text_input_group.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textInputGroup=void 0,t.textInputGroup="_textInputGroup_10q85_1";t.default={textInputGroup:"_textInputGroup_10q85_1"}}));
//# sourceMappingURL=pkg-account_default_apps.min.js-vflsse2Y-.map